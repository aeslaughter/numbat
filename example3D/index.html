<!DOCTYPE html>

<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" name="viewport"/>
<meta content="defaultdict(&lt;type 'int'&gt;, {})" name="moose-status">
<!-- Website title -->
<title>example3 D</title>
<!-- CSS -->
<link href="../contrib/materialize/materialize.min.css" rel="stylesheet" type="text/css"/>
<link href="../contrib/prisim/prism.min.css" rel="stylesheet" type="text/css"/>
<link href="../contrib/katex/katex.min.css" rel="stylesheet" type="text/css"/>
<link href="../css/moose.css" rel="stylesheet" type="text/css"/>
<!-- JS -->
<script src="../contrib/katex/katex.min.js" type="text/javascript"></script>
</meta></head>
<body>
<div class="page-wrap">
<header>
<!--
Page header including the top and sidebar navigation.
-->
<nav>
<div class="nav-wrapper container">
<a class="page-title" href="../index.html">Numbat</a>
<a class="button-collapse" data-activates="mobile-nav" href="#"><i class="material-icons">menu</i></a>
<ul class="right hide-on-med-and-down">
<li><a class="dropdown-button" data-activates="dropdown-top-Getting-Started" href="#!">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-top-Getting-Started">
<li><a href="../getting_started/index.html">Installation</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-top-Theory" href="#!">Theory<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-top-Theory">
<li><a href="../introduction/index.html">Introduction</a></li>
<li><a href="../governing_equations/index.html">Governing equations</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-top-Details" href="#!">Details<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-top-Details">
<li><a href="../implementation/index.html">Implementation</a></li>
<li><a href="../input_file_syntax/index.html">Input file syntax</a></li>
<li><a href="../systems/index.html">Available objects</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-top-Examples" href="#!">Examples<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-top-Examples">
<li><a href="../example2D/index.html">2D</a></li>
<li><a href="index.html">3D</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-top-Manual" href="#!">Manual<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-top-Manual">
<li><a href="../download/index.html">User manual</a></li>
</ul>
<li>
<form>
<div class="input-field search-wrapper">
<input id="search" required="" type="search">
<label for="search"><i class="material-icons">search</i></label>
<i class="material-icons">close</i>
<div class="search-results"></div>
</input></div>
</form>
</li>
<li>
<a class="github-mark-label" href="https://github.com/cpgr/numbat">
<img class="github-mark" src="../media/github-mark-light.png">GitHub
            
          </img></a>
</li>
</ul>
<ul class="side-nav" id="mobile-nav">
<li><a class="dropdown-button" data-activates="dropdown-side-Getting-Started" href="#!">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-side-Getting-Started">
<li><a href="../getting_started/index.html">Installation</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-side-Theory" href="#!">Theory<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-side-Theory">
<li><a href="../introduction/index.html">Introduction</a></li>
<li><a href="../governing_equations/index.html">Governing equations</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-side-Details" href="#!">Details<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-side-Details">
<li><a href="../implementation/index.html">Implementation</a></li>
<li><a href="../input_file_syntax/index.html">Input file syntax</a></li>
<li><a href="../systems/index.html">Available objects</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-side-Examples" href="#!">Examples<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-side-Examples">
<li><a href="../example2D/index.html">2D</a></li>
<li><a href="index.html">3D</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-side-Manual" href="#!">Manual<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-side-Manual">
<li><a href="../download/index.html">User manual</a></li>
</ul>
</ul>
</div>
</nav>
</header>
<main class="main">
<div class="container">
<!-- Breadcrumbs spanning entire page -->
<div class="row">
<div class="col hide-on-med-and-down l12">
<nav class="breadcrumb-nav">
<div class="nav-wrapper">
<div class="col s12 m9 l10">
<span class="breadcrumb"></span>
<a class="breadcrumb" href="index.html">example3 D</a>
</div>
</div>
</nav>
</div>
</div>
<!-- Row containing the markdown content and the table-of-contents on the right -->
<div class="row">
<!-- Markdown -->
<div class="col s12 m8 l9" id="moose-markdown-content">
<h1 id="3d-examples">3D examples</h1>
<p>Complete input files for 2D models using the dimensional and dimensionless streamfunction formulations are provided, for both isotropic and anisotropic porous media. These examples
are provided in the Numbat <em>examples</em> folder.</p>
<div class="section scrollspy" id="isotropic-models"><h2 id="isotropic-models">Isotropic models</h2>
<p>The first examples are for an isotropic porous medium (<span class="moose-katex-inline" id="moose-katex-equation-33127bcd-2989-456f-82b3-45d907f8eca7"><script>var element = document.getElementById("moose-katex-equation-33127bcd-2989-456f-82b3-45d907f8eca7");try{katex.render("\\gamma = 1", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\gamma = 1");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\gamma = 1";element.appendChild(err);}</script></span>).</p>
<h3 id="input-file">Input file</h3>
<p>The complete input file for this problem is
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text"># 3D density-driven convective mixing. Instability is seeded by small perturbation
# to porosity. Don't try this on a laptop!

[Mesh]
  type = GeneratedMesh
  dim = 3
  zmax = 1.5
  nx = 20
  ny = 20
  nz = 500
[]

[MeshModifiers]
  [./bias]
    type = NumbatBiasedMesh
    refined_edge = front
    num_elems = 500
    refined_resolution = 0.001
  [../]
[]

[Variables]
  [./concentration]
    initial_condition = 0
    scaling = 1e6
  [../]
  [./pressure]
    initial_condition = 1e6
  [../]
[]

[AuxVariables]
  [./noise]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[ICs]
  [./noise]
    type = RandomIC
    variable = noise
    max = 0.003
    min = -0.003
  [../]
[]

[Materials]
  [./porosity]
    type = NumbatPorosity
    porosity = 0.3
    noise = noise
  [../]
  [./permeability]
    type = NumbatPermeability
    permeability = '1e-11 0 0 0 1e-11 0 0 0 1e-11'
  [../]
  [./diffusivity]
    type = NumbatDiffusivity
    diffusivity = 2e-9
  [../]
  [./density]
    type = NumbatDensity
    concentration = concentration
    zero_density = 995
    delta_density = 10.5
    saturated_concentration = 0.049306
  [../]
  [./viscosity]
    type = NumbatViscosity
    viscosity = 6e-4
  [../]
[]

[Kernels]
  [./time]
    type = NumbatTimeDerivative
    variable = concentration
  [../]
  [./diffusion]
    type = NumbatDiffusion
    variable = concentration
  [../]
  [./convection]
    type = NumbatConvection
    variable = concentration
    pressure = pressure
  [../]
  [./darcy]
    type = NumbatDarcy
    variable = pressure
    concentration = concentration
  [../]
[]

[BCs]
  [./conctop]
    type = PresetBC
    variable = concentration
    boundary = front
    value = 0.049306
  [../]
  [./Periodic]
    [./x]
      variable = concentration
      auto_direction = 'x y'
    [../]
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  l_max_its = 200
  end_time = 3e5
  solve_type = NEWTON
  petsc_options = -ksp_snes_ew
  petsc_options_iname = '-pc_type -sub_pc_type -ksp_atol'
  petsc_options_value = 'bjacobi ilu 1e-12'
  nl_abs_tol = 1e-10
  nl_max_its = 25
  dtmax = 2e3
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1
  [../]
[]

[Postprocessors]
  [./boundaryfluxint]
    type = NumbatSideFlux
    variable = concentration
    boundary = top
  [../]
  [./mass]
    type = NumbatTotalMass
    variable = concentration
  [../]
[]

[Outputs]
  [./console]
    type = Console
    perf_log = true
    output_nonlinear = true
  [../]
  [./exodus]
    type = Exodus
    file_base = 3Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./csvoutput]
    type = CSV
    file_base = 3Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/3D/isotropic/3Dddc.i" href="https://github.com/cpgr/numbat/blob/master/examples/3D/isotropic/3Dddc.i">(3Dddc.i)</a></div>
</div>
</p>
<h3 id="running-the-example">Running the example</h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This example should <strong>not</strong> be run on a laptop or workstation
due to the large computational requirements. Do <strong>not</strong> run this using
the <em>Peacock</em> gui provided by MOOSE.</p>
</div>
<p>Examples of the total run times for this problem on a cluster are over
27 hours for a single processor down to only 30 minutes using 100
processors in parallel.</p>
<h3 id="results">Results</h3>
<p>This 3D example should produce a concentration profile similar to that
presented in <a class="moose-float-reference" data-moose-float-id="fig:3D" href="#Figure">Figure 1</a>, where several downwelling plumes of high
concentration can be observed:</p>
<p>
<div class="moose-float-div moose-figure-div" data-moose-float-name="Figure" id="fig:3D" style="width:80%;margin-left:10px;"><img class="materialboxed" data-caption="3D concentration profile" src="../media/3D.png" width="100%"/><p class="moose-float-caption"><span class="moose-float-caption-heading"><span class="moose-float-caption-heading-label">Figure </span><span class="moose-float-caption-heading-number">1</span><span class="moose-float-caption-heading-suffix">: </span></span><span class="moose-float-caption-text">3D concentration profile</span></p>
</div>
</p>
<p>Note that due to the random perturbation applied to the initial
concentration profile, the geometry of the concentration profile
obtained will differ from run to run.</p>
<p>The flux over the top surface is of particular interest in many cases
(especially convective mixing of CO<span class="moose-katex-inline" id="moose-katex-equation-100c3db9-2732-454f-94d0-be8909b44535"><script>var element = document.getElementById("moose-katex-equation-100c3db9-2732-454f-94d0-be8909b44535");try{katex.render("_2", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: _2");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: _2";element.appendChild(err);}</script></span>). This is calculated in
this example file using the <em>boundaryfluxint</em> postprocessor in the input
file, and presented in <a class="moose-float-reference" data-moose-float-id="fig:3Dflux" href="#Figure">Figure 2</a>.</p>
<p>
<div class="moose-float-div moose-figure-div" data-moose-float-name="Figure" id="fig:3Dflux" style="width:80%;margin-left:10px;"><img class="materialboxed" data-caption="3D flux across the top boundary" src="../media/3Dflux.png" width="100%"/><p class="moose-float-caption"><span class="moose-float-caption-heading"><span class="moose-float-caption-heading-label">Figure </span><span class="moose-float-caption-heading-number">2</span><span class="moose-float-caption-heading-suffix">: </span></span><span class="moose-float-caption-text">3D flux across the top boundary</span></p>
</div>
</p>
<p>Initially, the flux is purely diffusive, and scales as
<span class="moose-katex-inline" id="moose-katex-equation-4dd34e8d-6478-4774-b636-de19fce40e3a"><script>var element = document.getElementById("moose-katex-equation-4dd34e8d-6478-4774-b636-de19fce40e3a");try{katex.render("1 / \\sqrt(\\pi t)", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: 1 / \\sqrt(\\pi t)");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: 1 / \\sqrt(\\pi t)";element.appendChild(err);}</script></span>, where <span class="moose-katex-inline" id="moose-katex-equation-a2b1d9ca-e1c3-4e6f-a811-0a61fd26f17d"><script>var element = document.getElementById("moose-katex-equation-a2b1d9ca-e1c3-4e6f-a811-0a61fd26f17d");try{katex.render("t", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: t");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: t";element.appendChild(err);}</script></span> is time (shown as the dashed green line).
After some time, the convective instability becomes sufficiently strong,
at which point the flux across the top boundary rapidly increases (at a
time of approximately 1,700 seconds). Also shown for comparison is the
flux for the 2D example. It is apparent that the 3D model leads in a
slower onset of convection (the time where the flux first increases from
the diffusive rate).</p>
</div>
</div>
<!-- TOC -->
<div class="col hide-on-med-and-down l3">
<!--
Table of Contents

Loops through the current MoosePage object and builds a list
of second level headers.

Additionally, the "Edit on Github" button is added that links
the source markdown file if the 'github_edit' paramater is
set to True (the default).

-->
<div class="toc-wrapper pin-top">
<div class="moose-devel-links-container">
</div>
<div class="section table-of-contents">
<ul>
<li><a href="#isotropic-models">Isotropic models</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</main>
</div>
<footer class="page-footer">
<!--MOOSE Footer-->
<div class="container white-text">
<div class="row">
<div class="col s12">
<p>
<span class="moose-site-generated">
        Site Generated with <a href="https://www.mooseframework.org">MOOSE</a>
</span>
<span class="moose-edit-markdown">
<a class="moose-edit-markdown-link" href="https://github.com/cpgr/numbat/edit/devel/docs/content/example3D.md" style="float:right">Edit Markdown</a>
</span>
</p>
</div>
</div>
<div class="row">
<div class="col s12">
<p class="moose-status-container">
<span id="moose-status">
<span class="new badge pass" data-badge-caption="pass"></span>
</span>
</p>
</div>
</div>
</div>
</footer>
<script src="../contrib/jquery/jquery-3.2.1.min.js" type="text/javascript"></script>
<script src="../contrib/materialize/materialize.min.js" type="text/javascript"></script>
<script src="../contrib/clipboard/clipboard.min.js" type="text/javascript"></script>
<script src="../contrib/prisim/prism.min.js" type="text/javascript"></script>
<script src="../js/init.js" type="text/javascript"></script>
</body>
</html>