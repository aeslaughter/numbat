<!DOCTYPE html>

<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" name="viewport"/>
<!-- Website title -->
<title>Numbat</title>
<!-- CSS  -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/css/materialize.min.css" rel="stylesheet" type="text/css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/themes/prism.min.css" rel="stylesheet" type="text/css"/>
<link href="../css/moose.css" rel="stylesheet" type="text/css"/>
</link></head>
<body>
<div class="page-wrap">
<header>
<!--
Page header including the "sidebar" navigation.
-->
<ul class="dropdown-content" id="dropdown-getting_started">
<li><a href="../getting_started/index.html">Installation</a></li>
</ul>
<ul class="dropdown-content" id="dropdown-theory">
<li><a href="../governing_equations/index.html">Governing equations</a></li>
</ul>
<ul class="dropdown-content" id="dropdown-details">
<li><a href="../input_file_syntax/index.html">Input file syntax</a></li>
<li><a href="../systems/index.html">Available objects</a></li>
</ul>
<ul class="dropdown-content" id="dropdown-examples">
<li><a href="../example2D/index.html">2D</a></li>
<li><a href="index.html">3D</a></li>
</ul>
<ul class="dropdown-content" id="dropdown-manual">
<li><a href="../download/index.html">User manual</a></li>
</ul>
<nav>
<div class="nav-wrapper container">
<a class="page-title" href="../index.html">Numbat</a>
<ul class="right">
<li><a class="dropdown-button" data-activates="dropdown-getting_started" href="#!">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li>
<li><a class="dropdown-button" data-activates="dropdown-theory" href="#!">Theory<i class="material-icons right">arrow_drop_down</i></a></li>
<li><a class="dropdown-button" data-activates="dropdown-details" href="#!">Details<i class="material-icons right">arrow_drop_down</i></a></li>
<li><a class="dropdown-button" data-activates="dropdown-examples" href="#!">Examples<i class="material-icons right">arrow_drop_down</i></a></li>
<li><a class="dropdown-button" data-activates="dropdown-manual" href="#!">Manual<i class="material-icons right">arrow_drop_down</i></a></li>
<li>
<form>
<div class="input-field search-wrapper">
<input id="search" required="" type="search">
<label for="search"><i class="material-icons">search</i></label>
<i class="material-icons">close</i>
<div class="search-results"></div>
</input></div>
</form>
</li>
<li>
<a class="github-mark-label" href="https://github.com/cpgr/numbat">
<img class="github-mark" src="../media/github-mark-light.png">GitHub
          
        </img></a>
</li>
</ul>
</div>
</nav>
</header>
<main class="main">
<div class="container">
<!-- Breadcrumbs spanning entire page -->
<div class="row">
<div class="col s12 m12 l12">
<nav class="breadcrumb-nav">
<div class="nav-wrapper">
<div class="col s12 m9 l10">
<span class="breadcrumb"></span>
<a class="breadcrumb" href="index.html">example3D</a>
</div>
</div>
</nav>
</div>
</div>
<!-- Row containing the markdown content and the table-of-contents on the right -->
<div class="row">
<!-- Markdown -->
<div class="col s12 m8 l9" id="moose-markdown-content">
<h1 id="3d-examples">3D examples</h1>
<p>Complete input files for 2D modules using the dimensional and dimensionless streamfunction formulations are provided, for both isotropic and anisotropic porous media. These examples
are provided in the Numbat <em>examples</em> folder.</p>
<div class="section scrollspy" id="isotropic-models"><h2 id="isotropic-models">Isotropic models</h2>
<p>The first examples are for an isotropic porous medium (<script type="math/tex">\gamma = 1</script>).</p>
<h3 id="input-file">Input file</h3>
<p>The complete input file for this problem is
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><button class="moose-copy-button btn" data-clipboard-target="#moose-code-block-1">copy</button><code class="language-text" id="moose-code-block-1"># 3D density-driven convective mixing. Instability is seeded by small perturbation
# to porosity. Don't try this on a laptop!

[Mesh]
  type = GeneratedMesh
  dim = 3
  zmax = 1.5
  nx = 20
  ny = 20
  nz = 500
[]

[MeshModifiers]
  [./bias]
    type = NumbatBiasedMesh
    refined_edge = front
    num_elems = 500
    refined_resolution = 0.001
  [../]
[]

[Variables]
  [./concentration]
    initial_condition = 0
    scaling = 1e6
  [../]
  [./pressure]
    initial_condition = 1e6
  [../]
[]

[AuxVariables]
  [./noise]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[ICs]
  [./noise]
    type = RandomIC
    variable = noise
    max = 0.003
    min = -0.003
  [../]
[]

[Materials]
  [./porosity]
    type = NumbatPorosity
    porosity = 0.3
    noise = noise
  [../]
  [./permeability]
    type = NumbatPermeability
    permeability = '1e-11 0 0 0 1e-11 0 0 0 1e-11'
  [../]
  [./diffusivity]
    type = NumbatDiffusivity
    diffusivity = 2e-9
  [../]
  [./density]
    type = NumbatDensity
    concentration = concentration
    zero_density = 995
    delta_density = 10.5
    saturated_concentration = 0.049306
  [../]
  [./viscosity]
    type = NumbatViscosity
    viscosity = 6e-4
  [../]
[]

[Kernels]
  [./time]
    type = NumbatTimeDerivative
    variable = concentration
  [../]
  [./diffusion]
    type = NumbatDiffusion
    variable = concentration
  [../]
  [./convection]
    type = NumbatConvection
    variable = concentration
    pressure = pressure
  [../]
  [./darcy]
    type = NumbatDarcy
    variable = pressure
    concentration = concentration
  [../]
[]

[BCs]
  [./conctop]
    type = PresetBC
    variable = concentration
    boundary = front
    value = 0.049306
  [../]
  [./Periodic]
    [./x]
      variable = concentration
      auto_direction = 'x y'
    [../]
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  l_max_its = 200
  end_time = 3e5
  solve_type = NEWTON
  petsc_options = -ksp_snes_ew
  petsc_options_iname = '-pc_type -sub_pc_type -ksp_atol'
  petsc_options_value = 'bjacobi ilu 1e-12'
  nl_abs_tol = 1e-10
  nl_max_its = 25
  dtmax = 2e3
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1
  [../]
[]

[Postprocessors]
  [./boundaryfluxint]
    type = NumbatSideFlux
    variable = concentration
    boundary = top
  [../]
  [./mass]
    type = NumbatTotalMass
    variable = concentration
  [../]
[]

[Outputs]
  [./console]
    type = Console
    perf_log = true
    output_nonlinear = true
  [../]
  [./exodus]
    type = Exodus
    file_base = 3Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./csvoutput]
    type = CSV
    file_base = 3Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/3D/isotropic/3Dddc.i" href="https://github.com/cpgr/numbat/blob/master/examples/3D/isotropic/3Dddc.i">(3Dddc.i)</a></div>
</div>
</p>
<h3 id="running-the-example">Running the example</h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This example should <strong>not</strong> be run on a laptop or workstation
due to the large computational requirements. Do <strong>not</strong> run this using
the <em>Peacock</em> gui provided by MOOSE.</p>
</div>
<p>Examples of the total run times for this problem on a cluster are over
27 hours for a single processor down to only 30 minutes using 100
processors in parallel.</p>
<h3 id="results">Results</h3>
<p>This 3D example should produce a concentration profile similar to that
presented in <a class="moose-float-reference" data-moose-float-id="fig:3D" href="#Figure">Figure 1</a>, where several downwelling plumes of high
concentration can be observed:</p>
<p>
<div class="moose-float-div moose-figure-div" data-moose-float-name="Figure" id="fig:3D" style="width:80%;margin-left:10px;"><img class="materialboxed" data-caption="3D concentration profile" src="../media/3D.png" width="100%"/><p class="moose-float-caption"><span class="moose-float-caption-heading"><span class="moose-float-caption-heading-label">Figure </span><span class="moose-float-caption-heading-number">1</span><span class="moose-float-caption-heading-suffix">: </span></span><span class="moose-float-caption-text">3D concentration profile</span></p>
</div>
</p>
<p>Note that due to the random perturbation applied to the initial
concentration profile, the geometry of the concentration profile
obtained will differ from run to run.</p>
<p>The flux over the top surface is of particular interest in many cases
(especially convective mixing of CO<script type="math/tex">_2</script>). This is calculated in
this example file using the <em>boundaryfluxint</em> postprocessor in the input
file, and presented in <a class="moose-float-reference" data-moose-float-id="fig:3Dflux" href="#Figure">Figure 2</a>.</p>
<p>
<div class="moose-float-div moose-figure-div" data-moose-float-name="Figure" id="fig:3Dflux" style="width:80%;margin-left:10px;"><img class="materialboxed" data-caption="3D flux across the top boundary" src="../media/3Dflux.png" width="100%"/><p class="moose-float-caption"><span class="moose-float-caption-heading"><span class="moose-float-caption-heading-label">Figure </span><span class="moose-float-caption-heading-number">2</span><span class="moose-float-caption-heading-suffix">: </span></span><span class="moose-float-caption-text">3D flux across the top boundary</span></p>
</div>
</p>
<p>Initially, the flux is purely diffusive, and scales as
<script type="math/tex">1 / \sqrt(\pi t)</script>, where <script type="math/tex">t</script> is time (shown as the dashed green line).
After some time, the convective instability becomes sufficiently strong,
at which point the flux across the top boundary rapidly increases (at a
time of approximately 1,700 seconds). Also shown for comparison is the
flux for the 2D example. It is apparent that the 3D model leads in a
slower onset of convection (the time where the flux first increases from
the diffusive rate).</p>
</div>
</div>
<!-- TOC -->
<div class="col hid-on-small-only m4 l3">
<!--
Table of Contents

Loops through the current MoosePage object and builds a list
of second level headers.

Additionally, the "Edit on Github" button is added that links
the source markdown file if the 'github_edit' paramater is
set to True (the default).

-->
<div class="toc-wrapper pin-top">
<div class="moose-devel-links-container">
</div>
<div class="section table-of-contents">
<ul>
<li><a href="#isotropic-models">Isotropic models</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</main>
</div>
<footer class="page-footer">
<div class="container white-text">
<div class="row">
<div class="col s12">
<!--
MOOSE Footer
-->
<p class="moose-site-generated">
  Site Generated with <a href="https://www.mooseframework.org">MOOSE</a>
</p>
<p>
<a class="moose-edit-markdown" href="https://github.com/cpgr/numbat/edit/devel/docs/content/example3D.md" style="float:right">Edit Markdown</a>
</p>
</div>
</div>
</div>
</footer>
<script src="https://code.jquery.com/jquery-2.1.1.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/js/materialize.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/prism.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js" type="text/javascript"></script>
<script src="https://cdn.rawgit.com/zenorocha/clipboard.js/master/dist/clipboard.min.js" type="text/javascript"></script>
<script src="../js/init.js" type="text/javascript"></script>
</body>
</html>