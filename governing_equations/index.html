<!DOCTYPE html>

<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" name="viewport"/>
<!-- Website title -->
<title>Numbat</title>
<!-- CSS  -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/css/materialize.min.css" rel="stylesheet" type="text/css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/themes/prism.min.css" rel="stylesheet" type="text/css"/>
<link href="../css/moose.css" rel="stylesheet" type="text/css"/>
</link></head>
<body>
<div class="page-wrap">
<header>
<!--
Page header including the "sidebar" navigation.
-->
<ul class="dropdown-content" id="dropdown-getting_started">
<li><a href="../getting_started/index.html">Installation</a></li>
</ul>
<ul class="dropdown-content" id="dropdown-theory">
<li><a href="index.html">Governing equations</a></li>
</ul>
<ul class="dropdown-content" id="dropdown-systems">
<li><a href="../systems/index.html">Available objects</a></li>
</ul>
<ul class="dropdown-content" id="dropdown-examples">
<li><a href="../input_file_syntax/index.html">Input file syntax</a></li>
<li><a href="../example2D/index.html">2D</a></li>
<li><a href="../example3D/index.html">3D</a></li>
</ul>
<ul class="dropdown-content" id="dropdown-manual">
<li><a href="../download/index.html">User manual</a></li>
</ul>
<nav>
<div class="nav-wrapper container">
<a class="page-title" href="../index.html">Numbat</a>
<ul class="right">
<li><a class="dropdown-button" data-activates="dropdown-getting_started" href="#!">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li>
<li><a class="dropdown-button" data-activates="dropdown-theory" href="#!">Theory<i class="material-icons right">arrow_drop_down</i></a></li>
<li><a class="dropdown-button" data-activates="dropdown-systems" href="#!">Systems<i class="material-icons right">arrow_drop_down</i></a></li>
<li><a class="dropdown-button" data-activates="dropdown-examples" href="#!">Examples<i class="material-icons right">arrow_drop_down</i></a></li>
<li><a class="dropdown-button" data-activates="dropdown-manual" href="#!">Manual<i class="material-icons right">arrow_drop_down</i></a></li>
<li>
<form>
<div class="input-field search-wrapper">
<input id="search" required="" type="search">
<label for="search"><i class="material-icons">search</i></label>
<i class="material-icons">close</i>
<div class="search-results"></div>
</input></div>
</form>
</li>
<li>
<a class="github-mark-label" href="https://github.com/cpgr/numbat">
<img class="github-mark" src="../media/github-mark-light.png">GitHub
          
        </img></a>
</li>
</ul>
</div>
</nav>
</header>
<main class="main">
<div class="container">
<!-- Breadcrumbs spanning entire page -->
<div class="row">
<div class="col s12 m12 l12">
<nav class="breadcrumb-nav">
<div class="nav-wrapper">
<div class="col s12 m9 l10">
<span class="breadcrumb"></span>
<a class="breadcrumb" href="index.html">governing_equations</a>
</div>
</div>
</nav>
</div>
</div>
<!-- Row containing the markdown content and the table-of-contents on the right -->
<div class="row">
<!-- Markdown -->
<div class="col s12 m8 l9" id="moose-markdown-content">
<h1 id="background-theory">Background theory</h1>
<div class="section scrollspy" id="governing-equations"><h2 id="governing-equations">Governing equations</h2>
<p>Numbat implements the Boussinesq approximation to model density-driven
convective mixing in porous media.</p>
<p>The governing equations for density-driven flow in porous media are
Darcy’s law
<script type="math/tex; mode=display">\begin{equation}
\mathbf{u} = - \frac{\mathbf{K}}{\mu} \left(\nabla P + \rho(c) g \hat{\mathbf{k}} \right),
\label{eq:darcy}
\end{equation}</script>
where <script type="math/tex">\mathbf{u} = (u, v, w)</script> is the velocity vector, <script type="math/tex">\mathbf{K}</script> is
permeability, <script type="math/tex">\mu</script> is the fluid viscosity, <script type="math/tex">P</script> is the fluid pressure,
<script type="math/tex">\rho(c)</script> is the fluid density as a function of solute concentration
<script type="math/tex">c</script>, <script type="math/tex">g</script> is gravity, and <script type="math/tex">\hat{\mathbf{k}}</script> is the unit vector in the
<script type="math/tex">z</script> direction.</p>
<p>The fluid velocity must also satisfy the continuity equation
<script type="math/tex; mode=display">\begin{equation}
\nabla \cdot \mathbf{u} = 0,
\end{equation}</script>
and the solute concentration is governed by the convection - diffusion
equation</p>
<p>
<script type="math/tex; mode=display">\begin{equation}
\phi \frac{\partial c}{\partial t} + \mathbf{u} \cdot \nabla c = \phi D \nabla^2 c,
\label{eq:convdiff}
\end{equation}</script>
where <script type="math/tex">\phi</script> is the porosity, <script type="math/tex">t</script> is time and <script type="math/tex">D</script> is the diffusivity.</p>
<p>Darcy’s law and the convection-diffusion equations are coupled through
the fluid density, which is given by
<script type="math/tex; mode=display">\begin{equation}
\rho(c) = \rho_0 + \frac{c}{c_0} \Delta \rho,
\label{eq:density}
\end{equation}</script>
where <script type="math/tex">c_0</script> is the equilibrium concentration, and <script type="math/tex">\Delta \rho</script> is the
increase in density of the fluid at equilibrium concentration.</p>
<p>The boundary conditions are
<script type="math/tex; mode=display">\begin{align}
w = 0,&  \quad z = 0, -H, \\\\
\frac{\partial c}{\partial z} = 0,& \quad z = -H, \\\\
c = c_0,& \quad z = 0,
\end{align}</script>
which correspond to impermeable boundary conditions at the top and
bottom boundaries, given by <script type="math/tex">z = 0</script> and <script type="math/tex">z=-H</script>, respectively, and a
saturated condition at the top boundary.</p>
<p>Initially, there is no solute in the model
<script type="math/tex; mode=display">\begin{equation}
c = 0, \quad t = 0.
\end{equation}</script>
</p>
<p>Numbat solves Eq’s. <a class="moose-equation-reference" href="#mjx-eqn-eqdarcy">(??)</a> and <a class="moose-equation-reference" href="#mjx-eqn-eqconvdiff">(??)</a> with density coupled to concentration as in Eq. <a class="moose-equation-reference" href="#mjx-eqn-eqdensity">(??)</a>.</p>
</div><div class="section scrollspy" id="dimensionless-formulation"><h2 id="dimensionless-formulation">Dimensionless formulation</h2>
<p>The governing equations can also be solved using a streamfunction formulation in
2D and a vector potential formulation in 3D. As a result, we shall
consider the two cases separately.</p>
<h3 id="2d-solution">2D solution</h3>
<p>If we consider an anisotropic model, with vertical and horizontal
permeabilities given by <script type="math/tex">k_z</script> and <script type="math/tex">k_x</script>, respectively, we can
non-dimensionalise the governing equations in 2D following <span data-moose-cite="\citet{ennis-king2005}"><a href="#ennis-king2005">Ennis-King and Paterson (2005)</a></span>. Defining the anisotropy
ratio <script type="math/tex">\gamma</script> as
<script type="math/tex; mode=display">\begin{equation}
\gamma = \frac{k_z}{k_x},
\label{eq:gamma}
\end{equation}</script>
we scale the variables using
<script type="math/tex; mode=display">\begin{align}
x = \frac{\phi \mu D}{k_z \Delta \rho g \gamma^{1/2}} \hat{x}, \quad z =  \frac{\phi \mu D}{k_z \Delta \rho g} \hat{z}, \quad u = \frac{k_z \Delta \rho g}{\mu \gamma^{1/2}} \hat{u}, \quad w = \frac{k_z \Delta \rho g}{\mu} \hat{w} \nonumber \\\\
t = \left(\frac{\phi \mu}{k_z \Delta \rho g}\right)^2 \hat{t}, \quad c = c_0 \hat{c}, \quad P = \frac{\mu \phi D}{k_z}\hat{P}, \qquad \qquad \qquad
\label{eq:scales}
\end{align}</script>
where <script type="math/tex">\hat{x}</script> refers to a dimensionless variable. The governing
equations in dimensionless form are then
<script type="math/tex; mode=display">\begin{align}
\mathbf{u} = & - \left(\nabla P + c \mathbf{\hat{k}}\right), \label{eq:darcydim} \\\\
\mathbf{u} = & \,0, \label{eq:ctydim} \\\\
\frac{\partial c}{\partial t} + \mathbf{u} \cdot \nabla c = &\,  \gamma \frac{\partial^2 c}{\partial x^2} + \frac{\partial^2 c}{\partial z^2}, \label{eq:condiffdim}
\end{align}</script>
where we have dropped the hat on the dimensionless variables for
brevity.</p>
<p>The dimensionless boundary conditions are
<script type="math/tex; mode=display">\begin{align}
w = 0,&  \quad z = 0, -Ra, \label{eq:dimbc1} \\\\
\frac{\partial c}{\partial z} = 0,& \quad z = -Ra, \label{eq:dimbc2} \\\\
c = 1,& \quad z = 0, \label{eq:dimbc3}
\end{align}</script>
where <script type="math/tex">Ra</script> is the Rayleigh number, defined as
<script type="math/tex; mode=display">\begin{equation}
Ra = \frac{k_z \Delta \rho g H}{\phi \mu D}.
\label{eq:ra}
\end{equation}</script>
In this form, the Rayleigh number only appears in the boundary
conditions as the location of the lower boundary. Therefore, <script type="math/tex">Ra</script> can be
interpreted in this formalism as a dimensionless model height, and can
be varied in simulations by simply changing the height of the mesh.</p>
<p>Finally, the dimensionless initial condition is
<script type="math/tex; mode=display">\begin{equation}
c = 0, \quad t = 0.
\label{eq:ic}
\end{equation}</script>
For isotropic models, where <script type="math/tex">k_x = k_z</script> and hence <script type="math/tex">\gamma = 1</script>, we
recover the dimensionless equations given by <span data-moose-cite="\citet{slim2014}"><a href="#slim2014">Slim (2014)</a></span>.</p>
<p>The coupled governing equations must be solved numerically. To simplify
the numerical analysis, we introduce the streamfunction <script type="math/tex">\psi(x,z,t)</script>
such that
<script type="math/tex; mode=display">\begin{equation}
u = - \frac{\partial \psi}{\partial z}, \quad w = \frac{\partial \psi}{\partial x}.
\label{eq:2Dstreamfunction}
\end{equation}</script>
This definition satisfies the continuity equation, Eq.
<a class="moose-equation-reference" href="#mjx-eqn-eqctydim">(??)</a>, immediately.</p>
<p>The pressure <script type="math/tex">P</script> is removed from Eq. <a class="moose-equation-reference" href="#mjx-eqn-eqdarcydim">(??)</a> by taking the
curl of both sides and noting that <script type="math/tex">\nabla \times \nabla P = 0</script> for any
<script type="math/tex">P</script>, to give
<script type="math/tex; mode=display">\begin{equation}
\nabla^2 \psi = - \frac{\partial c}{\partial x},
\label{eq:darcypsi}
\end{equation}</script>
where we have introduced the streamfunction <script type="math/tex">\psi</script> using Eq.
<a class="moose-equation-reference" href="#mjx-eqn-eq2Dstreamfunction">(??)</a>.</p>
<p>The convection-diffusion equation, Eq. <a class="moose-equation-reference" href="#mjx-eqn-eqcondiffdim">(??)</a> becomes
<script type="math/tex; mode=display">\begin{equation}\frac{\partial c}{\partial t} - \frac{\partial \psi}{\partial z} \frac{\partial c}{\partial x} + \frac{\partial \psi}{\partial x} \frac{\partial c}{\partial z} = \gamma \frac{\partial^2 c}{\partial x^2} + \frac{\partial^2 c}{\partial z}.
\label{eq:condiffpsi}
\end{equation}</script>
The boundary conditions become
<script type="math/tex; mode=display">\begin{align}
\frac{\partial \psi}{\partial x} = 0,&  \quad z = 0, -Ra, \\\\
\frac{\partial c}{\partial z} = 0,& \quad z = -Ra, \\\\
c = 1,& \quad z = 0,
\label{eq:bcpsi}
\end{align}</script>
while the initial condition is still given by Eq. <a class="moose-equation-reference" href="#mjx-eqn-eqic">(??)</a>.</p>
<p>In two dimensions, Numbat solves Eq’s. <a class="moose-equation-reference" href="#mjx-eqn-eqdarcypsi">(??)</a> and
<a class="moose-equation-reference" href="#mjx-eqn-eqcondiffpsi">(??)</a>.</p>
<h3 id="3d-solution">3D solution</h3>
<p>We now consider the case of a three-dimensional model. For simplicity,
we consider the case where all lateral permeabilities are equal
(<script type="math/tex">k_y = k_x</script>). The governing equations for the 3D model are identical to
the 2D model. In dimensionless form, they are given by Eq’s.
<a class="moose-equation-reference" href="#mjx-eqn-eqdarcydim">(??)</a> to <a class="moose-equation-reference" href="#mjx-eqn-eqcondiffdim">(??)</a>, with boundary conditions
given by Eq’s. <a class="moose-equation-reference" href="#mjx-eqn-eqdimbc1">(??)</a> to <a class="moose-equation-reference" href="#mjx-eqn-eqdimbc3">(??)</a>, and initial
condition given by Eq. <a class="moose-equation-reference" href="#mjx-eqn-eqic">(??)</a>.</p>
<p>To solve these governing equations in 3D, a different approach must be
used as the streamfunction <script type="math/tex">\psi</script> is not defined in three dimensions.
Instead, we define a vector potential <script type="math/tex">\Psi = (\psi_x, \psi_y, \psi_z)</script>
such that
<script type="math/tex; mode=display">\begin{equation}
\mathbf{u} = \nabla \times \Psi.
\label{eq:Psi}
\end{equation}</script>
It is important to note that the vector potential is only known up to
the addition of the gradient of a scalar <script type="math/tex">\zeta</script> as
<script type="math/tex; mode=display">\begin{equation}
\nabla \times \left( \Psi + \nabla \zeta \right) = \nabla \times \Psi \quad \forall \zeta,
\end{equation}</script>
as <script type="math/tex">\nabla \times \nabla \zeta = 0</script> for any scalar <script type="math/tex">\zeta</script>. This
uncertainty is referred to as guage freedom, and is common in
electrodynamics. Taking the curl of Eq. <a class="moose-equation-reference" href="#mjx-eqn-eqdarcydim">(??)</a> and
substituting Eq. <a class="moose-equation-reference" href="#mjx-eqn-eqPsi">(??)</a>, we have
<script type="math/tex; mode=display">\begin{equation}
\nabla(\nabla \cdot \Psi) - \nabla^2 \Psi = \left(- \frac{\partial c}{\partial y}, \frac{\partial c}{\partial x}, 0\right),
\end{equation}</script>
where we have again used the fact that <script type="math/tex">\nabla \times \nabla P = 0</script>. If
we choose <script type="math/tex">\nabla \cdot \Psi = 0</script> to specify the guage condition, this
simplifies to
<script type="math/tex; mode=display">\begin{equation}
\nabla^2 \Psi = \left(\frac{\partial c}{\partial y},  -\frac{\partial c}{\partial x}, 0\right).
\label{eq:poisson}
\end{equation}</script>
As shown in <span data-moose-cite="\citet{e1997}"><a href="#e1997">E and Liu (1997)</a></span>,
<script type="math/tex">\nabla \cdot \Psi = 0</script> is satisfied throughout the domain if
<script type="math/tex; mode=display">\begin{align}
\psi_x = \psi_y = 0,& \quad z = 0, -Ra, \nonumber \\
\frac{\partial \psi_z}{\partial z} = 0, & \quad  z = 0, -Ra.
\end{align}</script>
The governing equations are then
<script type="math/tex; mode=display">\begin{align}
\nabla^2 \Psi = \,& \left(\frac{\partial c}{\partial y}, -\frac{\partial c}{\partial x}, 0 \right), \label{eq:darcy3d} \\\\
\frac{\partial c}{\partial t} + \mathbf{u} \cdot \nabla c = \, & \gamma \left( \frac{\partial^2 c}{\partial x^2} + \frac{\partial^2 c}{\partial y^2} \right) + \frac{\partial^2 c}{\partial z^2}, \label{eq:convdiff3d}
\end{align}</script>
where the continuity is satisfied automatically because
<script type="math/tex">\nabla \cdot \left( \nabla \times \Psi \right) = 0</script> for any <script type="math/tex">\Psi</script>.</p>
<p>Finally, it is straightforward to show that <script type="math/tex">\psi_z = 0</script> in order to
satisfy <script type="math/tex">\nabla^2 \psi_z = 0</script> and
<script type="math/tex">\frac{\partial \psi_z}{\partial z} = 0</script>, which means that the vector
potential has only <script type="math/tex">x</script> and <script type="math/tex">y</script> components,
<script type="math/tex; mode=display">\begin{equation}
\Psi = (\psi_x, \psi_y, 0),
\end{equation}</script>
and therefore the fluid velocity <script type="math/tex">\mathbf{u} = (u, v, w)</script> is
<script type="math/tex; mode=display">\begin{equation}
\mathbf{u} = \left( -\frac{\partial \psi_y}{\partial z}, \frac{\partial \psi_x}{\partial z}, \frac{\partial \psi_y}{\partial x} - \frac{\partial \psi_x}{\partial y} \right).
\end{equation}</script>
Note that if there is no <script type="math/tex">y</script> dependence, Eq’s. <a class="moose-equation-reference" href="#mjx-eqn-eqdarcy3d">(??)</a> and
<a class="moose-equation-reference" href="#mjx-eqn-eqconvdiff3d">(??)</a> reduce to
<script type="math/tex; mode=display">\begin{align}
\nabla^2 \Psi = \, & \left(0, -\frac{\partial c}{\partial x}, 0 \right), \\\\
\frac{\partial c}{\partial t} + \mathbf{u} \cdot \nabla c = \, & \gamma \frac{\partial^2 c}{\partial x^2}  + \frac{\partial^2 c}{\partial z^2}.
\end{align}</script>
It is simple to show that <script type="math/tex">\nabla^2 \psi_x = 0</script> and <script type="math/tex">\psi_x = 0</script> at
<script type="math/tex">z = 0, -Ra</script> are only satisfied if <script type="math/tex">\psi_x = 0</script> in the entire domain. In
this case, the governing equations reduce to the two-dimensional
formulation, as expected.</p>
<p>In three dimensions, Numbat solves Eq’s. <a class="moose-equation-reference" href="#mjx-eqn-eqdarcy3d">(??)</a> and
<a class="moose-equation-reference" href="#mjx-eqn-eqconvdiff3d">(??)</a>.</p>
</div><div class="section scrollspy" id="references"><h2 id="references">References</h2>
<ol class="moose-bibliography" data-moose-bibfiles="[u'/Users/gre462/Documents/MOOSE/projects/numbat/docs/bib/numbat.bib']">
<li name="ennis-king2005">J. Ennis-King and L. Paterson.
Role of convective mixing in the long-term storage of carbon dioxide in deep saline aquifers.
<em>SPE J.</em>, 10:349–356, 2005.</li>
<li name="slim2014">A.C. Slim.
Solutal-convection regimes in a two-dimensional porous medium.
<em>J. Fluid Mech.</em>, 741:461–491, 2014.</li>
<li name="e1997">W. E and J. G. Liu.
Finite difference methods for 3d viscous incompressible flows in the vorticity-vector potential formulation on nonstaggered grids.
<em>J. Comp. Phys.</em>, 138:57–82, 1997.</li>
</ol>
</div>
</div>
<!-- TOC -->
<div class="col hid-on-small-only m4 l3">
<!--
Table of Contents

Loops through the current MoosePage object and builds a list
of second level headers.

Additionally, the "Edit on Github" button is added that links
the source markdown file if the 'github_edit' paramater is
set to True (the default).

-->
<div class="toc-wrapper pin-top">
<div class="moose-devel-links-container">
</div>
<div class="section table-of-contents">
<ul>
<li><a href="#governing-equations">Governing equations</a></li>
<li><a href="#dimensionless-formulation">Dimensionless formulation</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</main>
</div>
<footer class="page-footer">
<div class="container white-text">
<div class="row">
<div class="col s12">
<!--
MOOSE Footer
-->
<p class="moose-site-generated">
  Site Generated with <a href="https://www.mooseframework.org">MOOSE</a>
</p>
<p>
<a class="moose-edit-markdown" href="https://github.com/cpgr/numbat/edit/devel/docs/content/governing_equations.md" style="float:right">Edit Markdown</a>
</p>
</div>
</div>
</div>
</footer>
<script src="https://code.jquery.com/jquery-2.1.1.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/js/materialize.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/prism.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js" type="text/javascript"></script>
<script src="https://cdn.rawgit.com/zenorocha/clipboard.js/master/dist/clipboard.min.js" type="text/javascript"></script>
<script src="../js/init.js" type="text/javascript"></script>
</body>
</html>