<!DOCTYPE html>

<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" name="viewport"/>
<meta content="defaultdict(&lt;type 'int'&gt;, {})" name="moose-status">
<!-- Website title -->
<title>governing_equations</title>
<!-- CSS -->
<link href="../contrib/materialize/materialize.min.css" rel="stylesheet" type="text/css"/>
<link href="../contrib/prisim/prism.min.css" rel="stylesheet" type="text/css"/>
<link href="../contrib/katex/katex.min.css" rel="stylesheet" type="text/css"/>
<link href="../css/moose.css" rel="stylesheet" type="text/css"/>
<!-- JS -->
<script src="../contrib/katex/katex.min.js" type="text/javascript"></script>
</meta></head>
<body>
<div class="page-wrap">
<header>
<!--
Page header including the top and sidebar navigation.
-->
<nav>
<div class="nav-wrapper container">
<a class="page-title" href="../index.html">Numbat</a>
<a class="button-collapse" data-activates="mobile-nav" href="#"><i class="material-icons">menu</i></a>
<ul class="right hide-on-med-and-down">
<li><a class="dropdown-button" data-activates="dropdown-top-Getting-Started" href="#!">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-top-Getting-Started">
<li><a href="../getting_started/index.html">Installation</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-top-Theory" href="#!">Theory<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-top-Theory">
<li><a href="../introduction/index.html">Introduction</a></li>
<li><a href="index.html">Governing equations</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-top-Details" href="#!">Details<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-top-Details">
<li><a href="../implementation/index.html">Implementation</a></li>
<li><a href="../input_file_syntax/index.html">Input file syntax</a></li>
<li><a href="../systems/index.html">Available objects</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-top-Examples" href="#!">Examples<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-top-Examples">
<li><a href="../example2D/index.html">2D</a></li>
<li><a href="../example3D/index.html">3D</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-top-Manual" href="#!">Manual<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-top-Manual">
<li><a href="../download/index.html">User manual</a></li>
</ul>
<li>
<form>
<div class="input-field search-wrapper">
<input id="search" required="" type="search">
<label for="search"><i class="material-icons">search</i></label>
<i class="material-icons">close</i>
<div class="search-results"></div>
</input></div>
</form>
</li>
<li>
<a class="github-mark-label" href="https://github.com/cpgr/numbat">
<img class="github-mark" src="../media/github-mark-light.png">GitHub
            
          </img></a>
</li>
</ul>
<ul class="side-nav" id="mobile-nav">
<li><a class="dropdown-button" data-activates="dropdown-side-Getting-Started" href="#!">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-side-Getting-Started">
<li><a href="../getting_started/index.html">Installation</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-side-Theory" href="#!">Theory<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-side-Theory">
<li><a href="../introduction/index.html">Introduction</a></li>
<li><a href="index.html">Governing equations</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-side-Details" href="#!">Details<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-side-Details">
<li><a href="../implementation/index.html">Implementation</a></li>
<li><a href="../input_file_syntax/index.html">Input file syntax</a></li>
<li><a href="../systems/index.html">Available objects</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-side-Examples" href="#!">Examples<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-side-Examples">
<li><a href="../example2D/index.html">2D</a></li>
<li><a href="../example3D/index.html">3D</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-side-Manual" href="#!">Manual<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-side-Manual">
<li><a href="../download/index.html">User manual</a></li>
</ul>
</ul>
</div>
</nav>
</header>
<main class="main">
<div class="container">
<!-- Breadcrumbs spanning entire page -->
<div class="row">
<div class="col hide-on-med-and-down l12">
<nav class="breadcrumb-nav">
<div class="nav-wrapper">
<div class="col s12 m9 l10">
<span class="breadcrumb"></span>
<a class="breadcrumb" href="index.html">governing_equations</a>
</div>
</div>
</nav>
</div>
</div>
<!-- Row containing the markdown content and the table-of-contents on the right -->
<div class="row">
<!-- Markdown -->
<div class="col s12 m8 l9" id="moose-markdown-content">
<h1 id="background-theory">Background theory</h1>
<div class="section scrollspy" id="governing-equations"><h2 id="governing-equations">Governing equations</h2>
<p>Numbat implements the Boussinesq approximation to model density-driven
convective mixing in porous media. To reduce the computational burden, only a single fluid phase is considered. This is a simplification to the actual physical process, where a gas phase may be present. This simplification is often used in practice, see <span data-moose-cite="\citet{emami-meybodi2015}"><a href="#emami-meybodi2015">Emami-Meybodi et al. (2015)</a></span> for a discussion about the use of this simplifying assumption.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The more complicated two-phase model can be implemented using the <code>porous_flow</code> module</p>
</div>
<p>The governing equations for density-driven flow in porous media are
Darcyâ€™s law
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="1" id="moose-katex-equation-eq-darcy"></div>
<div class="moose-katex-block-number">(1)</div>
<script>var element = document.getElementById("moose-katex-equation-eq-darcy");try{katex.render(" \\mathbf{u} = - \\frac{\\mathbf{K}}{\\mu} \\left(\\nabla P - \\rho(c) g \\hat{\\mathbf{k}} \\right),  ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\mathbf{u} = - \\frac{\\mathbf{K}}{\\mu} \\left(\\nabla P - \\rho(c) g \\hat{\\mathbf{k}} \\right),  ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\mathbf{u} = - \\frac{\\mathbf{K}}{\\mu} \\left(\\nabla P - \\rho(c) g \\hat{\\mathbf{k}} \\right),  ";element.appendChild(err);}</script>
</div>
where <span class="moose-katex-inline" id="moose-katex-equation-7f5ac006-1b8a-4fa7-be85-145dc5da7328"><script>var element = document.getElementById("moose-katex-equation-7f5ac006-1b8a-4fa7-be85-145dc5da7328");try{katex.render("\\mathbf{u} = (u, v, w)", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\mathbf{u} = (u, v, w)");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\mathbf{u} = (u, v, w)";element.appendChild(err);}</script></span> is the velocity vector, <span class="moose-katex-inline" id="moose-katex-equation-c697006d-6fb6-44fd-b2f1-31fc322bfad3"><script>var element = document.getElementById("moose-katex-equation-c697006d-6fb6-44fd-b2f1-31fc322bfad3");try{katex.render("\\mathbf{K}", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\mathbf{K}");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\mathbf{K}";element.appendChild(err);}</script></span> is
permeability, <span class="moose-katex-inline" id="moose-katex-equation-2f6130c3-ff61-43a0-9f0e-8539ef490421"><script>var element = document.getElementById("moose-katex-equation-2f6130c3-ff61-43a0-9f0e-8539ef490421");try{katex.render("\\mu", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\mu");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\mu";element.appendChild(err);}</script></span> is the fluid viscosity, <span class="moose-katex-inline" id="moose-katex-equation-9a239e0d-84b4-40dd-ae0d-14cff8542ed8"><script>var element = document.getElementById("moose-katex-equation-9a239e0d-84b4-40dd-ae0d-14cff8542ed8");try{katex.render("P", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: P");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: P";element.appendChild(err);}</script></span> is the fluid pressure,
<span class="moose-katex-inline" id="moose-katex-equation-4a79aecf-4f65-40ae-8ecd-55fbd4243b64"><script>var element = document.getElementById("moose-katex-equation-4a79aecf-4f65-40ae-8ecd-55fbd4243b64");try{katex.render("\\rho(c)", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\rho(c)");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\rho(c)";element.appendChild(err);}</script></span> is the fluid density as a function of solute concentration
<span class="moose-katex-inline" id="moose-katex-equation-1ec0f352-b94d-4b3c-b8a3-a7148130205d"><script>var element = document.getElementById("moose-katex-equation-1ec0f352-b94d-4b3c-b8a3-a7148130205d");try{katex.render("c", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: c");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: c";element.appendChild(err);}</script></span>, <span class="moose-katex-inline" id="moose-katex-equation-8cd5cfbe-ba09-4cfe-b6b6-6957840a31d7"><script>var element = document.getElementById("moose-katex-equation-8cd5cfbe-ba09-4cfe-b6b6-6957840a31d7");try{katex.render("g", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: g");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: g";element.appendChild(err);}</script></span> is gravity, and <span class="moose-katex-inline" id="moose-katex-equation-dc550bd9-4e7f-4ce2-9020-8107abee206f"><script>var element = document.getElementById("moose-katex-equation-dc550bd9-4e7f-4ce2-9020-8107abee206f");try{katex.render("\\hat{\\mathbf{k}}", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\hat{\\mathbf{k}}");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\hat{\\mathbf{k}}";element.appendChild(err);}</script></span> is the unit vector in the
<span class="moose-katex-inline" id="moose-katex-equation-ef0daf7f-1d30-4f67-8be3-ce7c6797e0f8"><script>var element = document.getElementById("moose-katex-equation-ef0daf7f-1d30-4f67-8be3-ce7c6797e0f8");try{katex.render("z", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: z");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: z";element.appendChild(err);}</script></span> direction.</p>
<p>The fluid velocity must also satisfy the continuity equation
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="2" id="moose-katex-equation-2"></div>
<div class="moose-katex-block-number">(2)</div>
<script>var element = document.getElementById("moose-katex-equation-2");try{katex.render(" \\nabla \\cdot \\mathbf{u} = 0, ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\nabla \\cdot \\mathbf{u} = 0, ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\nabla \\cdot \\mathbf{u} = 0, ";element.appendChild(err);}</script>
</div>
and the solute concentration is governed by the convection - diffusion
equation</p>
<p>
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="3" id="moose-katex-equation-eq-convdiff"></div>
<div class="moose-katex-block-number">(3)</div>
<script>var element = document.getElementById("moose-katex-equation-eq-convdiff");try{katex.render(" \\phi \\frac{\\partial c}{\\partial t} + \\mathbf{u} \\cdot \\nabla c = \\phi D \\nabla^2 c,  ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\phi \\frac{\\partial c}{\\partial t} + \\mathbf{u} \\cdot \\nabla c = \\phi D \\nabla^2 c,  ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\phi \\frac{\\partial c}{\\partial t} + \\mathbf{u} \\cdot \\nabla c = \\phi D \\nabla^2 c,  ";element.appendChild(err);}</script>
</div>
where <span class="moose-katex-inline" id="moose-katex-equation-76002624-857d-4b38-80b5-c24406d1ba00"><script>var element = document.getElementById("moose-katex-equation-76002624-857d-4b38-80b5-c24406d1ba00");try{katex.render("\\phi", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\phi");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\phi";element.appendChild(err);}</script></span> is the porosity, <span class="moose-katex-inline" id="moose-katex-equation-40fc29f6-72a3-4e75-bd21-227393165595"><script>var element = document.getElementById("moose-katex-equation-40fc29f6-72a3-4e75-bd21-227393165595");try{katex.render("t", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: t");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: t";element.appendChild(err);}</script></span> is time and <span class="moose-katex-inline" id="moose-katex-equation-3edebfe1-0d15-4e32-bb68-bf84da080398"><script>var element = document.getElementById("moose-katex-equation-3edebfe1-0d15-4e32-bb68-bf84da080398");try{katex.render("D", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: D");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: D";element.appendChild(err);}</script></span> is the diffusivity.</p>
<p>Darcyâ€™s law and the convection-diffusion equations are coupled through
the fluid density, which is given by
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="4" id="moose-katex-equation-eq-density"></div>
<div class="moose-katex-block-number">(4)</div>
<script>var element = document.getElementById("moose-katex-equation-eq-density");try{katex.render(" \\rho(c) = \\rho_0 + \\frac{c}{c_0} \\Delta \\rho,  ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\rho(c) = \\rho_0 + \\frac{c}{c_0} \\Delta \\rho,  ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\rho(c) = \\rho_0 + \\frac{c}{c_0} \\Delta \\rho,  ";element.appendChild(err);}</script>
</div>
where <span class="moose-katex-inline" id="moose-katex-equation-1a2af310-5ae5-4c94-929a-17adacdd0e40"><script>var element = document.getElementById("moose-katex-equation-1a2af310-5ae5-4c94-929a-17adacdd0e40");try{katex.render("c_0", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: c_0");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: c_0";element.appendChild(err);}</script></span> is the equilibrium concentration, and <span class="moose-katex-inline" id="moose-katex-equation-b64baeac-36f3-4a54-b3cf-310781ce58a0"><script>var element = document.getElementById("moose-katex-equation-b64baeac-36f3-4a54-b3cf-310781ce58a0");try{katex.render("\\Delta \\rho", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\Delta \\rho");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\Delta \\rho";element.appendChild(err);}</script></span> is the
increase in density of the fluid at equilibrium concentration.</p>
<p>The boundary conditions are
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="5" id="moose-katex-equation-5"></div>
<div class="moose-katex-block-number">(5)</div>
<script>var element = document.getElementById("moose-katex-equation-5");try{katex.render(" \\begin{aligned} w = 0,&  \\quad z = 0, -H, \\\\ \\frac{\\partial c}{\\partial z} = 0,& \\quad z = -H, \\\\ c = c_0,& \\quad z = 0, \\end{aligned} ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\begin{aligned} w = 0,&  \\quad z = 0, -H, \\\\ \\frac{\\partial c}{\\partial z} = 0,& \\quad z = -H, \\\\ c = c_0,& \\quad z = 0, \\end{aligned} ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\begin{aligned} w = 0,&  \\quad z = 0, -H, \\\\ \\frac{\\partial c}{\\partial z} = 0,& \\quad z = -H, \\\\ c = c_0,& \\quad z = 0, \\end{aligned} ";element.appendChild(err);}</script>
</div>
which correspond to impermeable boundary conditions at the top and
bottom boundaries, given by <span class="moose-katex-inline" id="moose-katex-equation-a24c851a-49de-4c3c-9f8a-7cd0afd46ff3"><script>var element = document.getElementById("moose-katex-equation-a24c851a-49de-4c3c-9f8a-7cd0afd46ff3");try{katex.render("z = 0", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: z = 0");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: z = 0";element.appendChild(err);}</script></span> and <span class="moose-katex-inline" id="moose-katex-equation-a5536aa6-6d7d-4ec1-926c-fde12ddf1fd9"><script>var element = document.getElementById("moose-katex-equation-a5536aa6-6d7d-4ec1-926c-fde12ddf1fd9");try{katex.render("z=-H", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: z=-H");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: z=-H";element.appendChild(err);}</script></span>, respectively, and a
saturated condition at the top boundary.</p>
<p>Initially, there is no solute in the model
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="6" id="moose-katex-equation-6"></div>
<div class="moose-katex-block-number">(6)</div>
<script>var element = document.getElementById("moose-katex-equation-6");try{katex.render(" c = 0, \\quad t = 0. ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  c = 0, \\quad t = 0. ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  c = 0, \\quad t = 0. ";element.appendChild(err);}</script>
</div>
</p>
<p>Numbat solves Eqâ€™s. <a class="moose-equation-reference" href="#moose-katex-equation-eq-darcy">(??)</a> and <a class="moose-equation-reference" href="#moose-katex-equation-eq-convdiff">(??)</a> with density coupled to concentration as in Eq. <a class="moose-equation-reference" href="#moose-katex-equation-eq-density">(??)</a>.</p>
</div><div class="section scrollspy" id="dimensionless-formulation"><h2 id="dimensionless-formulation">Dimensionless formulation</h2>
<p>The governing equations can also be solved using a streamfunction formulation in
2D and a vector potential formulation in 3D. As a result, we shall
consider the two cases separately.</p>
<h3 id="2d-solution">2D solution</h3>
<p>If we consider an anisotropic model, with vertical and horizontal
permeabilities given by <span class="moose-katex-inline" id="moose-katex-equation-b4037d75-aba7-4334-9711-f3a93f819790"><script>var element = document.getElementById("moose-katex-equation-b4037d75-aba7-4334-9711-f3a93f819790");try{katex.render("k_z", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: k_z");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: k_z";element.appendChild(err);}</script></span> and <span class="moose-katex-inline" id="moose-katex-equation-d5ddadea-2672-45c2-a20a-9e4baf9d6f4a"><script>var element = document.getElementById("moose-katex-equation-d5ddadea-2672-45c2-a20a-9e4baf9d6f4a");try{katex.render("k_x", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: k_x");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: k_x";element.appendChild(err);}</script></span>, respectively, we can
non-dimensionalise the governing equations in 2D following <span data-moose-cite="\citet{ennis-king2005}"><a href="#ennis-king2005">Ennis-King and Paterson (2005)</a></span>. Defining the anisotropy
ratio <span class="moose-katex-inline" id="moose-katex-equation-e3c27916-e53f-4536-979d-8c44b4923b49"><script>var element = document.getElementById("moose-katex-equation-e3c27916-e53f-4536-979d-8c44b4923b49");try{katex.render("\\gamma", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\gamma");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\gamma";element.appendChild(err);}</script></span> as
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="7" id="moose-katex-equation-eq-gamma"></div>
<div class="moose-katex-block-number">(7)</div>
<script>var element = document.getElementById("moose-katex-equation-eq-gamma");try{katex.render(" \\gamma = \\frac{k_z}{k_x},  ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\gamma = \\frac{k_z}{k_x},  ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\gamma = \\frac{k_z}{k_x},  ";element.appendChild(err);}</script>
</div>
we scale the variables using
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="8" id="moose-katex-equation-eq-scales"></div>
<div class="moose-katex-block-number">(8)</div>
<script>var element = document.getElementById("moose-katex-equation-eq-scales");try{katex.render(" \\begin{aligned} x = \\frac{\\phi \\mu D}{k_z \\Delta \\rho g \\gamma^{1/2}} \\hat{x}, \\quad z =  \\frac{\\phi \\mu D}{k_z \\Delta \\rho g} \\hat{z}, \\quad u = \\frac{k_z \\Delta \\rho g}{\\mu \\gamma^{1/2}} \\hat{u}, \\quad w = \\frac{k_z \\Delta \\rho g}{\\mu} \\hat{w} \\\\ t = \\left(\\frac{\\phi \\mu}{k_z \\Delta \\rho g}\\right)^2 \\hat{t}, \\quad c = c_0 \\hat{c}, \\quad P = \\frac{\\mu \\phi D}{k_z}\\hat{P},  \\end{aligned} ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\begin{aligned} x = \\frac{\\phi \\mu D}{k_z \\Delta \\rho g \\gamma^{1/2}} \\hat{x}, \\quad z =  \\frac{\\phi \\mu D}{k_z \\Delta \\rho g} \\hat{z}, \\quad u = \\frac{k_z \\Delta \\rho g}{\\mu \\gamma^{1/2}} \\hat{u}, \\quad w = \\frac{k_z \\Delta \\rho g}{\\mu} \\hat{w} \\\\ t = \\left(\\frac{\\phi \\mu}{k_z \\Delta \\rho g}\\right)^2 \\hat{t}, \\quad c = c_0 \\hat{c}, \\quad P = \\frac{\\mu \\phi D}{k_z}\\hat{P},  \\end{aligned} ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\begin{aligned} x = \\frac{\\phi \\mu D}{k_z \\Delta \\rho g \\gamma^{1/2}} \\hat{x}, \\quad z =  \\frac{\\phi \\mu D}{k_z \\Delta \\rho g} \\hat{z}, \\quad u = \\frac{k_z \\Delta \\rho g}{\\mu \\gamma^{1/2}} \\hat{u}, \\quad w = \\frac{k_z \\Delta \\rho g}{\\mu} \\hat{w} \\\\ t = \\left(\\frac{\\phi \\mu}{k_z \\Delta \\rho g}\\right)^2 \\hat{t}, \\quad c = c_0 \\hat{c}, \\quad P = \\frac{\\mu \\phi D}{k_z}\\hat{P},  \\end{aligned} ";element.appendChild(err);}</script>
</div>
where <span class="moose-katex-inline" id="moose-katex-equation-d46c3b32-f048-4118-b517-ebe22eaf1ba0"><script>var element = document.getElementById("moose-katex-equation-d46c3b32-f048-4118-b517-ebe22eaf1ba0");try{katex.render("\\hat{x}", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\hat{x}");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\hat{x}";element.appendChild(err);}</script></span> refers to a dimensionless variable. The governing
equations in dimensionless form are then
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="9" id="moose-katex-equation-eq-darcydim"></div>
<div class="moose-katex-block-number">(9)</div>
<script>var element = document.getElementById("moose-katex-equation-eq-darcydim");try{katex.render(" \\mathbf{u} = - \\left(\\nabla P + c \\mathbf{\\hat{k}}\\right),  ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\mathbf{u} = - \\left(\\nabla P + c \\mathbf{\\hat{k}}\\right),  ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\mathbf{u} = - \\left(\\nabla P + c \\mathbf{\\hat{k}}\\right),  ";element.appendChild(err);}</script>
</div>
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="10" id="moose-katex-equation-eq-ctydim"></div>
<div class="moose-katex-block-number">(10)</div>
<script>var element = document.getElementById("moose-katex-equation-eq-ctydim");try{katex.render(" \\mathbf{u} = 0,  ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\mathbf{u} = 0,  ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\mathbf{u} = 0,  ";element.appendChild(err);}</script>
</div>
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="11" id="moose-katex-equation-eq-condiffdim"></div>
<div class="moose-katex-block-number">(11)</div>
<script>var element = document.getElementById("moose-katex-equation-eq-condiffdim");try{katex.render(" \\frac{\\partial c}{\\partial t} + \\mathbf{u} \\cdot \\nabla c = \\gamma \\frac{\\partial^2 c}{\\partial x^2} + \\frac{\\partial^2 c}{\\partial z^2},  ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\frac{\\partial c}{\\partial t} + \\mathbf{u} \\cdot \\nabla c = \\gamma \\frac{\\partial^2 c}{\\partial x^2} + \\frac{\\partial^2 c}{\\partial z^2},  ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\frac{\\partial c}{\\partial t} + \\mathbf{u} \\cdot \\nabla c = \\gamma \\frac{\\partial^2 c}{\\partial x^2} + \\frac{\\partial^2 c}{\\partial z^2},  ";element.appendChild(err);}</script>
</div>
where we have dropped the hat on the dimensionless variables for
brevity.</p>
<p>The dimensionless boundary conditions are
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="12" id="moose-katex-equation-eq-dimbc"></div>
<div class="moose-katex-block-number">(12)</div>
<script>var element = document.getElementById("moose-katex-equation-eq-dimbc");try{katex.render(" \\begin{aligned} w = 0,&  \\quad z = 0, -Ra, \\\\ \\frac{\\partial c}{\\partial z} = 0,& \\quad z = -Ra, \\\\ c = 1,& \\quad z = 0, \\end{aligned}  ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\begin{aligned} w = 0,&  \\quad z = 0, -Ra, \\\\ \\frac{\\partial c}{\\partial z} = 0,& \\quad z = -Ra, \\\\ c = 1,& \\quad z = 0, \\end{aligned}  ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\begin{aligned} w = 0,&  \\quad z = 0, -Ra, \\\\ \\frac{\\partial c}{\\partial z} = 0,& \\quad z = -Ra, \\\\ c = 1,& \\quad z = 0, \\end{aligned}  ";element.appendChild(err);}</script>
</div>
where <span class="moose-katex-inline" id="moose-katex-equation-def09237-7de7-40d8-a1b1-f96ed31e98e5"><script>var element = document.getElementById("moose-katex-equation-def09237-7de7-40d8-a1b1-f96ed31e98e5");try{katex.render("Ra", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: Ra");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: Ra";element.appendChild(err);}</script></span> is the Rayleigh number, defined as
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="13" id="moose-katex-equation-eq-ra"></div>
<div class="moose-katex-block-number">(13)</div>
<script>var element = document.getElementById("moose-katex-equation-eq-ra");try{katex.render(" Ra = \\frac{k_z \\Delta \\rho g H}{\\phi \\mu D}.  ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  Ra = \\frac{k_z \\Delta \\rho g H}{\\phi \\mu D}.  ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  Ra = \\frac{k_z \\Delta \\rho g H}{\\phi \\mu D}.  ";element.appendChild(err);}</script>
</div>
In this form, the Rayleigh number only appears in the boundary
conditions as the location of the lower boundary. Therefore, <span class="moose-katex-inline" id="moose-katex-equation-1b4723b8-9947-4bbe-9c66-d0ca82efe915"><script>var element = document.getElementById("moose-katex-equation-1b4723b8-9947-4bbe-9c66-d0ca82efe915");try{katex.render("Ra", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: Ra");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: Ra";element.appendChild(err);}</script></span> can be
interpreted in this formalism as a dimensionless model height, and can
be varied in simulations by simply changing the height of the mesh.</p>
<p>Finally, the dimensionless initial condition is
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="14" id="moose-katex-equation-eq-ic"></div>
<div class="moose-katex-block-number">(14)</div>
<script>var element = document.getElementById("moose-katex-equation-eq-ic");try{katex.render(" c = 0, \\quad t = 0.  ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  c = 0, \\quad t = 0.  ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  c = 0, \\quad t = 0.  ";element.appendChild(err);}</script>
</div>
For isotropic models, where <span class="moose-katex-inline" id="moose-katex-equation-632c5aae-84d2-4425-bcff-c1bddb0a8386"><script>var element = document.getElementById("moose-katex-equation-632c5aae-84d2-4425-bcff-c1bddb0a8386");try{katex.render("k_x = k_z", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: k_x = k_z");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: k_x = k_z";element.appendChild(err);}</script></span> and hence <span class="moose-katex-inline" id="moose-katex-equation-a8fe30c3-56b2-419b-8537-69da3374f890"><script>var element = document.getElementById("moose-katex-equation-a8fe30c3-56b2-419b-8537-69da3374f890");try{katex.render("\\gamma = 1", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\gamma = 1");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\gamma = 1";element.appendChild(err);}</script></span>, we
recover the dimensionless equations given by <span data-moose-cite="\citet{slim2014}"><a href="#slim2014">Slim (2014)</a></span>.</p>
<p>The coupled governing equations must be solved numerically. To simplify
the numerical analysis, we introduce the streamfunction <span class="moose-katex-inline" id="moose-katex-equation-e3edf3ad-602b-49ab-b79e-986a399f4da1"><script>var element = document.getElementById("moose-katex-equation-e3edf3ad-602b-49ab-b79e-986a399f4da1");try{katex.render("\\psi(x,z,t)", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\psi(x,z,t)");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\psi(x,z,t)";element.appendChild(err);}</script></span>
such that
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="15" id="moose-katex-equation-eq-2Dstreamfunction"></div>
<div class="moose-katex-block-number">(15)</div>
<script>var element = document.getElementById("moose-katex-equation-eq-2Dstreamfunction");try{katex.render(" u = - \\frac{\\partial \\psi}{\\partial z}, \\quad w = \\frac{\\partial \\psi}{\\partial x}.  ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  u = - \\frac{\\partial \\psi}{\\partial z}, \\quad w = \\frac{\\partial \\psi}{\\partial x}.  ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  u = - \\frac{\\partial \\psi}{\\partial z}, \\quad w = \\frac{\\partial \\psi}{\\partial x}.  ";element.appendChild(err);}</script>
</div>
This definition satisfies the continuity equation, Eq.
<a class="moose-equation-reference" href="#moose-katex-equation-eq-ctydim">(??)</a>, immediately.</p>
<p>The pressure <span class="moose-katex-inline" id="moose-katex-equation-649508ee-69f1-4b14-9a56-4fdf6a47514d"><script>var element = document.getElementById("moose-katex-equation-649508ee-69f1-4b14-9a56-4fdf6a47514d");try{katex.render("P", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: P");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: P";element.appendChild(err);}</script></span> is removed from Eq. <a class="moose-equation-reference" href="#moose-katex-equation-eq-darcydim">(??)</a> by taking the
curl of both sides and noting that <span class="moose-katex-inline" id="moose-katex-equation-cc49fb3a-cb56-40e7-8bec-725c1cc77223"><script>var element = document.getElementById("moose-katex-equation-cc49fb3a-cb56-40e7-8bec-725c1cc77223");try{katex.render("\\nabla \\times \\nabla P = 0", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\nabla \\times \\nabla P = 0");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\nabla \\times \\nabla P = 0";element.appendChild(err);}</script></span> for any
<span class="moose-katex-inline" id="moose-katex-equation-cbee1998-dcf3-40ec-b281-4210f8e13a76"><script>var element = document.getElementById("moose-katex-equation-cbee1998-dcf3-40ec-b281-4210f8e13a76");try{katex.render("P", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: P");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: P";element.appendChild(err);}</script></span>, to give
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="16" id="moose-katex-equation-eq-darcypsi"></div>
<div class="moose-katex-block-number">(16)</div>
<script>var element = document.getElementById("moose-katex-equation-eq-darcypsi");try{katex.render(" \\nabla^2 \\psi = - \\frac{\\partial c}{\\partial x},  ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\nabla^2 \\psi = - \\frac{\\partial c}{\\partial x},  ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\nabla^2 \\psi = - \\frac{\\partial c}{\\partial x},  ";element.appendChild(err);}</script>
</div>
where we have introduced the streamfunction <span class="moose-katex-inline" id="moose-katex-equation-23bc783e-c5ce-4b53-8f2f-23079afe7d24"><script>var element = document.getElementById("moose-katex-equation-23bc783e-c5ce-4b53-8f2f-23079afe7d24");try{katex.render("\\psi", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\psi");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\psi";element.appendChild(err);}</script></span> using Eq.
<a class="moose-equation-reference" href="#moose-katex-equation-eq-2Dstreamfunction">(??)</a>.</p>
<p>The convection-diffusion equation, Eq. <a class="moose-equation-reference" href="#moose-katex-equation-eq-condiffdim">(??)</a> becomes
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="17" id="moose-katex-equation-eq-condiffpsi"></div>
<div class="moose-katex-block-number">(17)</div>
<script>var element = document.getElementById("moose-katex-equation-eq-condiffpsi");try{katex.render(" \\frac{\\partial c}{\\partial t} - \\frac{\\partial \\psi}{\\partial z} \\frac{\\partial c}{\\partial x} + \\frac{\\partial \\psi}{\\partial x} \\frac{\\partial c}{\\partial z} = \\gamma \\frac{\\partial^2 c}{\\partial x^2} + \\frac{\\partial^2 c}{\\partial z}.  ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\frac{\\partial c}{\\partial t} - \\frac{\\partial \\psi}{\\partial z} \\frac{\\partial c}{\\partial x} + \\frac{\\partial \\psi}{\\partial x} \\frac{\\partial c}{\\partial z} = \\gamma \\frac{\\partial^2 c}{\\partial x^2} + \\frac{\\partial^2 c}{\\partial z}.  ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\frac{\\partial c}{\\partial t} - \\frac{\\partial \\psi}{\\partial z} \\frac{\\partial c}{\\partial x} + \\frac{\\partial \\psi}{\\partial x} \\frac{\\partial c}{\\partial z} = \\gamma \\frac{\\partial^2 c}{\\partial x^2} + \\frac{\\partial^2 c}{\\partial z}.  ";element.appendChild(err);}</script>
</div>
The boundary conditions become
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="18" id="moose-katex-equation-eq-bcpsi"></div>
<div class="moose-katex-block-number">(18)</div>
<script>var element = document.getElementById("moose-katex-equation-eq-bcpsi");try{katex.render(" \\begin{aligned} \\frac{\\partial \\psi}{\\partial x} = 0,&  \\quad z = 0, -Ra, \\\\ \\frac{\\partial c}{\\partial z} = 0,& \\quad z = -Ra, \\\\ c = 1,& \\quad z = 0,  \\end{aligned} ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\begin{aligned} \\frac{\\partial \\psi}{\\partial x} = 0,&  \\quad z = 0, -Ra, \\\\ \\frac{\\partial c}{\\partial z} = 0,& \\quad z = -Ra, \\\\ c = 1,& \\quad z = 0,  \\end{aligned} ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\begin{aligned} \\frac{\\partial \\psi}{\\partial x} = 0,&  \\quad z = 0, -Ra, \\\\ \\frac{\\partial c}{\\partial z} = 0,& \\quad z = -Ra, \\\\ c = 1,& \\quad z = 0,  \\end{aligned} ";element.appendChild(err);}</script>
</div>
while the initial condition is still given by Eq. <a class="moose-equation-reference" href="#moose-katex-equation-eq-ic">(??)</a>.</p>
<p>In two dimensions, Numbat solves Eqâ€™s. <a class="moose-equation-reference" href="#moose-katex-equation-eq-darcypsi">(??)</a> and
<a class="moose-equation-reference" href="#moose-katex-equation-eq-condiffpsi">(??)</a>.</p>
<h3 id="3d-solution">3D solution</h3>
<p>We now consider the case of a three-dimensional model. For simplicity,
we consider the case where all lateral permeabilities are equal
(<span class="moose-katex-inline" id="moose-katex-equation-1879f780-0861-44dd-a833-a7d3093c6b70"><script>var element = document.getElementById("moose-katex-equation-1879f780-0861-44dd-a833-a7d3093c6b70");try{katex.render("k_y = k_x", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: k_y = k_x");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: k_y = k_x";element.appendChild(err);}</script></span>). The governing equations for the 3D model are identical to
the 2D model. In dimensionless form, they are given by Eqâ€™s.
<a class="moose-equation-reference" href="#moose-katex-equation-eq-darcydim">(??)</a> to <a class="moose-equation-reference" href="#moose-katex-equation-eq-condiffdim">(??)</a>, with boundary conditions
given by Eq. <a class="moose-equation-reference" href="#moose-katex-equation-eq-dimbc">(??)</a>, and initial condition given by Eq. <a class="moose-equation-reference" href="#moose-katex-equation-eq-ic">(??)</a>.</p>
<p>To solve these governing equations in 3D, a different approach must be
used as the streamfunction <span class="moose-katex-inline" id="moose-katex-equation-d60c0e29-3c3d-4ad6-bf02-398745c0f573"><script>var element = document.getElementById("moose-katex-equation-d60c0e29-3c3d-4ad6-bf02-398745c0f573");try{katex.render("\\psi", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\psi");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\psi";element.appendChild(err);}</script></span> is not defined in three dimensions.
Instead, we define a vector potential <span class="moose-katex-inline" id="moose-katex-equation-da4f4ebf-b8ca-4963-a161-4c997047486b"><script>var element = document.getElementById("moose-katex-equation-da4f4ebf-b8ca-4963-a161-4c997047486b");try{katex.render("\\Psi = (\\psi_x, \\psi_y, \\psi_z)", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\Psi = (\\psi_x, \\psi_y, \\psi_z)");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\Psi = (\\psi_x, \\psi_y, \\psi_z)";element.appendChild(err);}</script></span>
such that
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="19" id="moose-katex-equation-eq-Psi"></div>
<div class="moose-katex-block-number">(19)</div>
<script>var element = document.getElementById("moose-katex-equation-eq-Psi");try{katex.render(" \\mathbf{u} = \\nabla \\times \\Psi.  ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\mathbf{u} = \\nabla \\times \\Psi.  ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\mathbf{u} = \\nabla \\times \\Psi.  ";element.appendChild(err);}</script>
</div>
It is important to note that the vector potential is only known up to
the addition of the gradient of a scalar <span class="moose-katex-inline" id="moose-katex-equation-51711c34-caca-4e6c-99de-e865ada27c68"><script>var element = document.getElementById("moose-katex-equation-51711c34-caca-4e6c-99de-e865ada27c68");try{katex.render("\\zeta", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\zeta");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\zeta";element.appendChild(err);}</script></span> as
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="20" id="moose-katex-equation-20"></div>
<div class="moose-katex-block-number">(20)</div>
<script>var element = document.getElementById("moose-katex-equation-20");try{katex.render(" \\nabla \\times \\left( \\Psi + \\nabla \\zeta \\right) = \\nabla \\times \\Psi \\quad \\forall \\zeta, ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\nabla \\times \\left( \\Psi + \\nabla \\zeta \\right) = \\nabla \\times \\Psi \\quad \\forall \\zeta, ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\nabla \\times \\left( \\Psi + \\nabla \\zeta \\right) = \\nabla \\times \\Psi \\quad \\forall \\zeta, ";element.appendChild(err);}</script>
</div>
as <span class="moose-katex-inline" id="moose-katex-equation-e78d4441-ca51-4b33-8407-79cdaed8af0c"><script>var element = document.getElementById("moose-katex-equation-e78d4441-ca51-4b33-8407-79cdaed8af0c");try{katex.render("\\nabla \\times \\nabla \\zeta = 0", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\nabla \\times \\nabla \\zeta = 0");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\nabla \\times \\nabla \\zeta = 0";element.appendChild(err);}</script></span> for any scalar <span class="moose-katex-inline" id="moose-katex-equation-edadc67f-cda4-4864-b2fb-61ccf1f7da9c"><script>var element = document.getElementById("moose-katex-equation-edadc67f-cda4-4864-b2fb-61ccf1f7da9c");try{katex.render("\\zeta", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\zeta");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\zeta";element.appendChild(err);}</script></span>. This
uncertainty is referred to as guage freedom, and is common in
electrodynamics. Taking the curl of Eq. <a class="moose-equation-reference" href="#moose-katex-equation-eq-darcydim">(??)</a> and
substituting Eq. <a class="moose-equation-reference" href="#moose-katex-equation-eq-Psi">(??)</a>, we have
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="21" id="moose-katex-equation-21"></div>
<div class="moose-katex-block-number">(21)</div>
<script>var element = document.getElementById("moose-katex-equation-21");try{katex.render(" \\nabla(\\nabla \\cdot \\Psi) - \\nabla^2 \\Psi = \\left(- \\frac{\\partial c}{\\partial y}, \\frac{\\partial c}{\\partial x}, 0\\right), ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\nabla(\\nabla \\cdot \\Psi) - \\nabla^2 \\Psi = \\left(- \\frac{\\partial c}{\\partial y}, \\frac{\\partial c}{\\partial x}, 0\\right), ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\nabla(\\nabla \\cdot \\Psi) - \\nabla^2 \\Psi = \\left(- \\frac{\\partial c}{\\partial y}, \\frac{\\partial c}{\\partial x}, 0\\right), ";element.appendChild(err);}</script>
</div>
where we have again used the fact that <span class="moose-katex-inline" id="moose-katex-equation-50f8f396-5d85-4c5c-bf04-aa96a58039c5"><script>var element = document.getElementById("moose-katex-equation-50f8f396-5d85-4c5c-bf04-aa96a58039c5");try{katex.render("\\nabla \\times \\nabla P = 0", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\nabla \\times \\nabla P = 0");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\nabla \\times \\nabla P = 0";element.appendChild(err);}</script></span>. If
we choose <span class="moose-katex-inline" id="moose-katex-equation-c5b33f48-9a54-42a8-85b8-6b28934ac891"><script>var element = document.getElementById("moose-katex-equation-c5b33f48-9a54-42a8-85b8-6b28934ac891");try{katex.render("\\nabla \\cdot \\Psi = 0", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\nabla \\cdot \\Psi = 0");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\nabla \\cdot \\Psi = 0";element.appendChild(err);}</script></span> to specify the guage condition, this
simplifies to
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="22" id="moose-katex-equation-eq-poisson"></div>
<div class="moose-katex-block-number">(22)</div>
<script>var element = document.getElementById("moose-katex-equation-eq-poisson");try{katex.render(" \\nabla^2 \\Psi = \\left(\\frac{\\partial c}{\\partial y},  -\\frac{\\partial c}{\\partial x}, 0\\right).  ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\nabla^2 \\Psi = \\left(\\frac{\\partial c}{\\partial y},  -\\frac{\\partial c}{\\partial x}, 0\\right).  ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\nabla^2 \\Psi = \\left(\\frac{\\partial c}{\\partial y},  -\\frac{\\partial c}{\\partial x}, 0\\right).  ";element.appendChild(err);}</script>
</div>
As shown in <span data-moose-cite="\citet{e1997}"><a href="#e1997">E and Liu (1997)</a></span>,
<span class="moose-katex-inline" id="moose-katex-equation-48fb685f-a5a1-4080-8c39-d42086498c27"><script>var element = document.getElementById("moose-katex-equation-48fb685f-a5a1-4080-8c39-d42086498c27");try{katex.render("\\nabla \\cdot \\Psi = 0", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\nabla \\cdot \\Psi = 0");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\nabla \\cdot \\Psi = 0";element.appendChild(err);}</script></span> is satisfied throughout the domain if
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="23" id="moose-katex-equation-23"></div>
<div class="moose-katex-block-number">(23)</div>
<script>var element = document.getElementById("moose-katex-equation-23");try{katex.render(" \\begin{aligned} \\psi_x = \\psi_y = 0,& \\quad z = 0, -Ra,  \\\\ \\frac{\\partial \\psi_z}{\\partial z} = 0, & \\quad  z = 0, -Ra. \\end{aligned} ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\begin{aligned} \\psi_x = \\psi_y = 0,& \\quad z = 0, -Ra,  \\\\ \\frac{\\partial \\psi_z}{\\partial z} = 0, & \\quad  z = 0, -Ra. \\end{aligned} ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\begin{aligned} \\psi_x = \\psi_y = 0,& \\quad z = 0, -Ra,  \\\\ \\frac{\\partial \\psi_z}{\\partial z} = 0, & \\quad  z = 0, -Ra. \\end{aligned} ";element.appendChild(err);}</script>
</div>
The governing equations are then
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="24" id="moose-katex-equation-eq-darcy3d"></div>
<div class="moose-katex-block-number">(24)</div>
<script>var element = document.getElementById("moose-katex-equation-eq-darcy3d");try{katex.render(" \\nabla^2 \\Psi = \\left(\\frac{\\partial c}{\\partial y}, -\\frac{\\partial c}{\\partial x}, 0 \\right),  ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\nabla^2 \\Psi = \\left(\\frac{\\partial c}{\\partial y}, -\\frac{\\partial c}{\\partial x}, 0 \\right),  ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\nabla^2 \\Psi = \\left(\\frac{\\partial c}{\\partial y}, -\\frac{\\partial c}{\\partial x}, 0 \\right),  ";element.appendChild(err);}</script>
</div>
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="25" id="moose-katex-equation-eq-convdiff3d"></div>
<div class="moose-katex-block-number">(25)</div>
<script>var element = document.getElementById("moose-katex-equation-eq-convdiff3d");try{katex.render(" \\frac{\\partial c}{\\partial t} + \\mathbf{u} \\cdot \\nabla c = \\gamma \\left( \\frac{\\partial^2 c}{\\partial x^2} + \\frac{\\partial^2 c}{\\partial y^2} \\right) + \\frac{\\partial^2 c}{\\partial z^2},  ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\frac{\\partial c}{\\partial t} + \\mathbf{u} \\cdot \\nabla c = \\gamma \\left( \\frac{\\partial^2 c}{\\partial x^2} + \\frac{\\partial^2 c}{\\partial y^2} \\right) + \\frac{\\partial^2 c}{\\partial z^2},  ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\frac{\\partial c}{\\partial t} + \\mathbf{u} \\cdot \\nabla c = \\gamma \\left( \\frac{\\partial^2 c}{\\partial x^2} + \\frac{\\partial^2 c}{\\partial y^2} \\right) + \\frac{\\partial^2 c}{\\partial z^2},  ";element.appendChild(err);}</script>
</div>
where the continuity is satisfied automatically because
<span class="moose-katex-inline" id="moose-katex-equation-6fef962e-9c15-48a4-97cb-a8c1991cbc01"><script>var element = document.getElementById("moose-katex-equation-6fef962e-9c15-48a4-97cb-a8c1991cbc01");try{katex.render("\\nabla \\cdot \\left( \\nabla \\times \\Psi \\right) = 0", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\nabla \\cdot \\left( \\nabla \\times \\Psi \\right) = 0");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\nabla \\cdot \\left( \\nabla \\times \\Psi \\right) = 0";element.appendChild(err);}</script></span> for any <span class="moose-katex-inline" id="moose-katex-equation-64cfc712-7ad4-457b-a153-468e130f1407"><script>var element = document.getElementById("moose-katex-equation-64cfc712-7ad4-457b-a153-468e130f1407");try{katex.render("\\Psi", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\Psi");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\Psi";element.appendChild(err);}</script></span>.</p>
<p>Finally, it is straightforward to show that <span class="moose-katex-inline" id="moose-katex-equation-b90fa851-5829-4630-9ab9-39a92267046d"><script>var element = document.getElementById("moose-katex-equation-b90fa851-5829-4630-9ab9-39a92267046d");try{katex.render("\\psi_z = 0", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\psi_z = 0");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\psi_z = 0";element.appendChild(err);}</script></span> in order to
satisfy <span class="moose-katex-inline" id="moose-katex-equation-7225786e-00cb-4141-b2f2-e0fff5e6099e"><script>var element = document.getElementById("moose-katex-equation-7225786e-00cb-4141-b2f2-e0fff5e6099e");try{katex.render("\\nabla^2 \\psi_z = 0", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\nabla^2 \\psi_z = 0");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\nabla^2 \\psi_z = 0";element.appendChild(err);}</script></span> and
<span class="moose-katex-inline" id="moose-katex-equation-f934f8d2-77a8-497e-a2fa-0bd9c8d40481"><script>var element = document.getElementById("moose-katex-equation-f934f8d2-77a8-497e-a2fa-0bd9c8d40481");try{katex.render("\\frac{\\partial \\psi_z}{\\partial z} = 0", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\frac{\\partial \\psi_z}{\\partial z} = 0");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\frac{\\partial \\psi_z}{\\partial z} = 0";element.appendChild(err);}</script></span>, which means that the vector
potential has only <span class="moose-katex-inline" id="moose-katex-equation-57412040-73c8-4bda-baa4-a84500578a56"><script>var element = document.getElementById("moose-katex-equation-57412040-73c8-4bda-baa4-a84500578a56");try{katex.render("x", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: x");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: x";element.appendChild(err);}</script></span> and <span class="moose-katex-inline" id="moose-katex-equation-b7a37802-efb6-4c86-8d9e-c489059c95c1"><script>var element = document.getElementById("moose-katex-equation-b7a37802-efb6-4c86-8d9e-c489059c95c1");try{katex.render("y", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: y");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: y";element.appendChild(err);}</script></span> components,
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="26" id="moose-katex-equation-26"></div>
<div class="moose-katex-block-number">(26)</div>
<script>var element = document.getElementById("moose-katex-equation-26");try{katex.render(" \\Psi = (\\psi_x, \\psi_y, 0), ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\Psi = (\\psi_x, \\psi_y, 0), ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\Psi = (\\psi_x, \\psi_y, 0), ";element.appendChild(err);}</script>
</div>
and therefore the fluid velocity <span class="moose-katex-inline" id="moose-katex-equation-9770f301-f62b-4939-a62a-78ee72efac98"><script>var element = document.getElementById("moose-katex-equation-9770f301-f62b-4939-a62a-78ee72efac98");try{katex.render("\\mathbf{u} = (u, v, w)", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\mathbf{u} = (u, v, w)");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\mathbf{u} = (u, v, w)";element.appendChild(err);}</script></span> is
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="27" id="moose-katex-equation-27"></div>
<div class="moose-katex-block-number">(27)</div>
<script>var element = document.getElementById("moose-katex-equation-27");try{katex.render(" \\mathbf{u} = \\left( -\\frac{\\partial \\psi_y}{\\partial z}, \\frac{\\partial \\psi_x}{\\partial z}, \\frac{\\partial \\psi_y}{\\partial x} - \\frac{\\partial \\psi_x}{\\partial y} \\right). ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\mathbf{u} = \\left( -\\frac{\\partial \\psi_y}{\\partial z}, \\frac{\\partial \\psi_x}{\\partial z}, \\frac{\\partial \\psi_y}{\\partial x} - \\frac{\\partial \\psi_x}{\\partial y} \\right). ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\mathbf{u} = \\left( -\\frac{\\partial \\psi_y}{\\partial z}, \\frac{\\partial \\psi_x}{\\partial z}, \\frac{\\partial \\psi_y}{\\partial x} - \\frac{\\partial \\psi_x}{\\partial y} \\right). ";element.appendChild(err);}</script>
</div>
Note that if there is no <span class="moose-katex-inline" id="moose-katex-equation-e5065400-090c-4c76-a482-4aa160006dab"><script>var element = document.getElementById("moose-katex-equation-e5065400-090c-4c76-a482-4aa160006dab");try{katex.render("y", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: y");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: y";element.appendChild(err);}</script></span> dependence, Eqâ€™s. <a class="moose-equation-reference" href="#moose-katex-equation-eq-darcy3d">(??)</a> and
<a class="moose-equation-reference" href="#moose-katex-equation-eq-convdiff3d">(??)</a> reduce to
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="28" id="moose-katex-equation-28"></div>
<div class="moose-katex-block-number">(28)</div>
<script>var element = document.getElementById("moose-katex-equation-28");try{katex.render(" \\begin{aligned} \\nabla^2 \\Psi = \\, & \\left(0, -\\frac{\\partial c}{\\partial x}, 0 \\right), \\\\\\\\ \\frac{\\partial c}{\\partial t} + \\mathbf{u} \\cdot \\nabla c = \\, & \\gamma \\frac{\\partial^2 c}{\\partial x^2}  + \\frac{\\partial^2 c}{\\partial z^2}. \\end{aligned} ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  \\begin{aligned} \\nabla^2 \\Psi = \\, & \\left(0, -\\frac{\\partial c}{\\partial x}, 0 \\right), \\\\\\\\ \\frac{\\partial c}{\\partial t} + \\mathbf{u} \\cdot \\nabla c = \\, & \\gamma \\frac{\\partial^2 c}{\\partial x^2}  + \\frac{\\partial^2 c}{\\partial z^2}. \\end{aligned} ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  \\begin{aligned} \\nabla^2 \\Psi = \\, & \\left(0, -\\frac{\\partial c}{\\partial x}, 0 \\right), \\\\\\\\ \\frac{\\partial c}{\\partial t} + \\mathbf{u} \\cdot \\nabla c = \\, & \\gamma \\frac{\\partial^2 c}{\\partial x^2}  + \\frac{\\partial^2 c}{\\partial z^2}. \\end{aligned} ";element.appendChild(err);}</script>
</div>
It is simple to show that <span class="moose-katex-inline" id="moose-katex-equation-600fe39b-26bb-4d7c-be00-0385b2df1fd8"><script>var element = document.getElementById("moose-katex-equation-600fe39b-26bb-4d7c-be00-0385b2df1fd8");try{katex.render("\\nabla^2 \\psi_x = 0", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\nabla^2 \\psi_x = 0");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\nabla^2 \\psi_x = 0";element.appendChild(err);}</script></span> and <span class="moose-katex-inline" id="moose-katex-equation-5691b9bc-a890-45c6-9c1c-40ced48f7a42"><script>var element = document.getElementById("moose-katex-equation-5691b9bc-a890-45c6-9c1c-40ced48f7a42");try{katex.render("\\psi_x = 0", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\psi_x = 0");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\psi_x = 0";element.appendChild(err);}</script></span> at
<span class="moose-katex-inline" id="moose-katex-equation-38219023-dfb7-42d3-a933-0ed6f7fa30e3"><script>var element = document.getElementById("moose-katex-equation-38219023-dfb7-42d3-a933-0ed6f7fa30e3");try{katex.render("z = 0, -Ra", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: z = 0, -Ra");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: z = 0, -Ra";element.appendChild(err);}</script></span> are only satisfied if <span class="moose-katex-inline" id="moose-katex-equation-a791e24e-68d9-4e3a-8c83-a91f9f753c45"><script>var element = document.getElementById("moose-katex-equation-a791e24e-68d9-4e3a-8c83-a91f9f753c45");try{katex.render("\\psi_x = 0", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\psi_x = 0");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\psi_x = 0";element.appendChild(err);}</script></span> in the entire domain. In
this case, the governing equations reduce to the two-dimensional
formulation, as expected.</p>
<p>In three dimensions, Numbat solves Eqâ€™s. <a class="moose-equation-reference" href="#moose-katex-equation-eq-darcy3d">(??)</a> and
<a class="moose-equation-reference" href="#moose-katex-equation-eq-convdiff3d">(??)</a>.</p>
</div><div class="section scrollspy" id="references"><h2 id="references">References</h2>
<ol class="moose-bibliography" data-moose-bibfiles="[u'/Users/gre462/Documents/MOOSE/projects/numbat/docs/bib/numbat.bib']">
<li name="emami-meybodi2015">Hamid Emami-Meybodi, Hassan Hassanzadeh, ChristopherÂ P. Green, and Jonathan Ennis-King.
<span class="bibtex-protected">Convective dissolution of CO$_2$ in saline aquifers: Progress in modeling and experiments</span>.
<em>International Journal of Greenhouse Gas Control</em>, 40:238â€“266, 2015.</li>
<li name="ennis-king2005">J.Â Ennis-King and L.Â Paterson.
Role of convective mixing in the long-term storage of carbon dioxide in deep saline aquifers.
<em>SPE J.</em>, 10:349â€“356, 2005.</li>
<li name="slim2014">A.C. Slim.
Solutal-convection regimes in a two-dimensional porous medium.
<em>J. Fluid Mech.</em>, 741:461â€“491, 2014.</li>
<li name="e1997">W.Â E and J.Â G. Liu.
Finite difference methods for 3d viscous incompressible flows in the vorticity-vector potential formulation on nonstaggered grids.
<em>J. Comp. Phys.</em>, 138:57â€“82, 1997.</li>
</ol>
</div>
</div>
<!-- TOC -->
<div class="col hide-on-med-and-down l3">
<!--
Table of Contents

Loops through the current MoosePage object and builds a list
of second level headers.

Additionally, the "Edit on Github" button is added that links
the source markdown file if the 'github_edit' paramater is
set to True (the default).

-->
<div class="toc-wrapper pin-top">
<div class="moose-devel-links-container">
</div>
<div class="section table-of-contents">
<ul>
<li><a href="#governing-equations">Governing equations</a></li>
<li><a href="#dimensionless-formulation">Dimensionless formulation</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</main>
</div>
<footer class="page-footer">
<!--MOOSE Footer-->
<div class="container white-text">
<div class="row">
<div class="col s12">
<p>
<span class="moose-site-generated">
        Site Generated with <a href="https://www.mooseframework.org">MOOSE</a>
</span>
<span class="moose-edit-markdown">
<a class="moose-edit-markdown-link" href="https://github.com/cpgr/numbat/edit/devel/docs/content/governing_equations.md" style="float:right">Edit Markdown</a>
</span>
</p>
</div>
</div>
<div class="row">
<div class="col s12">
<p class="moose-status-container">
<span id="moose-status">
<span class="new badge pass" data-badge-caption="pass"></span>
</span>
</p>
</div>
</div>
</div>
</footer>
<script src="../contrib/jquery/jquery-3.2.1.min.js" type="text/javascript"></script>
<script src="../contrib/materialize/materialize.min.js" type="text/javascript"></script>
<script src="../contrib/clipboard/clipboard.min.js" type="text/javascript"></script>
<script src="../contrib/prisim/prism.min.js" type="text/javascript"></script>
<script src="../js/init.js" type="text/javascript"></script>
</body>
</html>