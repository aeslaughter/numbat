<!DOCTYPE html><html><head><meta charset="UTF-8"><link media="screen,projection" href="contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet"></link><link href="contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="css/moose.css" type="text/css" rel="stylesheet"></link><script src="contrib/jquery/jquery.min.js" type="text/javascript"></script><script src="contrib/materialize/materialize.min.js" type="text/javascript"></script><script src="contrib/clipboard/clipboard.min.js" type="text/javascript"></script><script src="contrib/prism/prism.min.js" type="text/javascript"></script><script src="contrib/katex/katex.min.js" type="text/javascript"></script><script src="contrib/fuse/fuse.min.js" type="text/javascript"></script><script src="js/search_index.js" type="text/javascript"></script><script src="js/init.js" type="text/javascript"></script><title>Running   the   Numbat   application|Numbat</title></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://github.com/cpgr/numbat" class="right"><img src="media/github-logo.png" class="github-mark"></img><img src="media/github-mark.png" class="github-logo"></img></a><a href="http://cpgr.github.io/numbat/" class="left moose-logo">Numbat</a><ul class="right hide-on-med-and-down" id="nav-mobile"><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="4e92e9fb-d017-4a93-9433-43d7e8fc6c6a">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="1712c2ef-1bdf-40cb-9a3d-c77ab730b87c">Theory<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="ccfe1cc8-3b81-43a5-aaaa-3d3c8103b769">Details<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="2f810903-7428-470f-b53c-6dd7848c1097">Examples<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="ac786aef-4d9a-4f87-9b19-886b3bc8fd97">Manual<i class="material-icons right">arrow_drop_down</i></a></li></ul><ul class="dropdown-content" id="4e92e9fb-d017-4a93-9433-43d7e8fc6c6a"><li><a href="getting_started.html">Installation</a></li></ul><ul class="dropdown-content" id="1712c2ef-1bdf-40cb-9a3d-c77ab730b87c"><li><a href="introduction.html">Introduction</a></li><li><a href="governing_equations.html">Governing equations</a></li></ul><ul class="dropdown-content" id="ccfe1cc8-3b81-43a5-aaaa-3d3c8103b769"><li><a href="implementation.html">Implementation</a></li><li><a href="input_file_syntax.html">Input file syntax</a></li><li><a href="running_numbat.html">Running Numbat</a></li><li><a href="systems.html">Available objects</a></li></ul><ul class="dropdown-content" id="2f810903-7428-470f-b53c-6dd7848c1097"><li><a href="example2D.html">2D</a></li><li><a href="example3D.html">3D</a></li></ul><ul class="dropdown-content" id="ac786aef-4d9a-4f87-9b19-886b3bc8fd97"><li><a href="download.html">User manual</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input autocomplete="off" onkeyup="mooseSearch()" type="text" id="moose-search-box"><label for="search">http://cpgr.github.io/numbat/</label></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-action modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href="running_numbat.html" class="breadcrumb">running_numbat</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section data-section-text="Running   the   Numbat   application" data-section-level="1" id="18f6c46a-0d1c-4ab4-be33-f81076697799"><h1>Running the Numbat application</h1><section class="section scrollspy" data-section-text="Commandline" data-section-level="2" id="5a98be1b-764e-4c5a-958f-c1189fbba4db"><h2>Commandline</h2><p>Most often, Numbat will be run from the commandline using</p><pre><code class="language-bash">
./numbat-opt -i input.i
</code></pre><p>Numbat (and all MOOSE applications) have a large number of commandline options available to the user. The complete list can be viewed using the <code>--help</code> option</p><pre><code class="language-text">
./numbat-opt --help

Usage: ./numbat-opt [&lt;options&gt;]

Options:
  --allow-test-objects                              Register test objects and syntax.
  --type                                            Return the name of the application object.
  --check-input                                     Check the input file (i.e. requires -i &lt;filename&gt;) and quit.
  --color [auto,on,off]                             Whether to use color in console output (default 'on').
  --definition                                      Shows a SON style input definition dump for input validation
  -v --version                                      Print application version
  --distributed-mesh                                The libMesh Mesh underlying MooseMesh should always be a DistributedMesh
  --dump [search_string]                            Shows a dump of available input file syntax.
  --error                                           Turn all warnings into errors
  --error-deprecated                                Turn deprecated code messages into Errors
  -o --error-override                               Error when encountering overridden or parameters supplied multiple times
  -e --error-unused                                 Error when encountering unused input file options
  --half-transient                                  When true the simulation will only run half of its specified transient (ie half the timesteps).  This is useful for testing recovery and restart
  -h --help                                         Displays CLI usage statement.
  -i &lt;input_file&gt;                                   Specify an input file
  --json                                            Dumps input file syntax in JSON format.
  --keep-cout                                       Keep standard output from all processors when running in parallel
  --list-constructed-objects                        List all moose object type names constructed by the master app factory.
  --mesh-only [mesh_file_name]                      Setup and Output the input mesh only (Default: &quot;&lt;input_file_name&gt;_in.e&quot;)
  --minimal                                         Ignore input file and build a minimal application with Transient executioner.
  --n-threads=&lt;n&gt;                                   Runs the specified number of threads per process
  --no-color                                        Disable coloring of all Console outputs.
  --no-timing                                       Disabled performance logging. Overrides -t or --timing if passed in conjunction with this flag
  --no-trap-fpe                                     Disable Floating Point Exception handling in critical sections of code when using DEBUG mode.
  --recover [file_base]                             Continue the calculation.  If file_base is omitted then the most recent recovery file will be utilized
  --recoversuffix [suffix]                          Use a different file extension, other than cpr, for a recovery file
  --redirect-stdout                                 Keep standard output from all processors when running in parallel
  -r &lt;n&gt;                                            Specify additional initial uniform refinements for automatic scaling
  --registry                                        Lists all known objects and actions.
  --registry-hit                                    Lists all known objects and actions in hit format.
  --show-controls                                   Shows the Control logic available and executed.
  --show-input                                      Shows the parsed input file before running the simulation.
  --show-outputs                                    Shows the output execution time information.
  --split-file [filename]                           optional name of split mesh file(s) to write/read
  --split-mesh [splits]                             comma-separated list of numbers of chunks to split the mesh into
  --start-in-debugger &lt;debugger&gt;                    Start the application and attach a debugger.  This will launch xterm windows using the command you specify for 'debugger'
  --stop-for-debugger [seconds]                     Pauses the application during startup for the specified time to allow for connection of debuggers.
  --syntax                                          Dumps the associated Action syntax paths ONLY
  -t --timing                                       Enable all performance logging for timing purposes. This will disable all screen output of performance logs for all Console objects.
  --trap-fpe                                        Enable Floating Point Exception handling in critical sections of code.  This is enabled automatically in DEBUG mode
  --use-split                                       use split distributed mesh files
  -w --warn-unused                                  Warn about unused input file options
  --yaml                                            Dumps input file syntax in YAML format.

Solver Options:
  See solver manual for details (Petsc or Trilinos)
</code></pre><section data-section-text="Recovering" data-section-level="3" id="52b0ae0e-9b70-41f7-ba78-309886058e98"><h3>Recovering</h3><p>If you output checkpoint files (using <code>checkpoint = true</code> in your Outputs block) then the <code>--recover</code> option will allow you to continue a solve that died in the middle of the solve. This can allow you to recover a job that was killed because the power went out or your job ran out of time on the cluster you were using.</p><p>We recommend that all input files for large Numbat simulations enable checkpointing. This can be enabled using</p><div class="card"><div class="card-content"><pre style="max-height:350px;"><code class="language-text">
[Outputs]
  [./console]
    type = Console
    perf_log = true
    output_nonlinear = true
  [../]
  [./csvoutput]
    type = CSV
    file_base = 2DSF
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./checkpoint]
    type = Checkpoint
    num_files = 2
  [../]
[]</code></pre><a data-position="top" href="#651d8dd0-4375-4577-b9c1-7e942a764564" class="tooltipped modal-trigger" data-tooltip="/Users/gre462/Documents/MOOSE/projects/numbat/tests/2D/2DSF_recover.i">(tests/2D/2DSF_recover.i)</a></div></div><p>For all of the options available for checkpointing, see the <a class="tooltipped" href="http://www.mooseframework.org" data-tooltip="http://www.mooseframework.org" data-position="top">MOOSE</a> documentation.</p><p>If a long-running simulation does fail to complete, it can be recovered by</p><pre><code class="language-bash">
./numbat-opt --recover checkpoint_dir/XXXX -i input.i
</code></pre><p>where <code>checkpoint_dir</code> is the subdirectory where the checkpoint files are saved, and <code>XXXX</code> is the number of one of the available checkpoint files.</p></section><section data-section-text="Overriding   parameters" data-section-level="3" id="989b1d7b-824d-4885-8e45-017eb5a42c36"><h3>Overriding parameters</h3><p>MOOSE provides a handy feature where any parameter in the input file can be overridden from the commandline, making it possible to script studies where only parameters are changed from simulation to simulation.</p><p>For example, assume that the anisotropy <code>gamma</code> of the porous medium is set as <code>1</code> in the input file</p><pre><code class="language-bash">
[Kernels]
  [./Darcy]
    type = NumbatDarcySF
    variable = streamfunction
    concentration = concentration
    gamma = 1
  [../]
[]
</code></pre><p>This value can be changed to <code>0.5</code> by running Numbat with the following commandline option</p><pre><code class="language-bash">
./numbat-opt -i input.i Kernels/Darcy/gamma=0.5
</code></pre></section></section><section class="section scrollspy" data-section-text="Graphical   user   interface   ( Peacock )" data-section-level="2" id="9f2fd4a2-b167-42ee-8b63-37284f280887"><h2>Graphical user interface (Peacock)</h2><p>MOOSE provides a graphical user interface, Peacock, which can be used to both run simulations and create input files. Starting Peacock from within the base Numbat directory allows Peacock to extract the Numbat syntax, so that all Numbat objects are available in the menus.</p><div class="card moose-alert moose-alert-note"><div class="card-content"><div class="moose-alert-title card-title"><span class="moose-alert-title-brand">note</span></div><div class="moose-alert-content"><p>It is not recommended to use Peacock to run very large models (e.g. three dimensional simulations)</p></div></div></div></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a data-delay="1000" data-position="left" href="#5a98be1b-764e-4c5a-958f-c1189fbba4db" class="tooltipped" data-tooltip="Commandline">Commandline</a></li><li><a data-delay="1000" data-position="left" href="#9f2fd4a2-b167-42ee-8b63-37284f280887" class="tooltipped" data-tooltip="Graphical   user   interface   ( Peacock )">Graphical   user   interface   ( Peacock )</a></li></ul></div></div></div></div></main></div><div id="651d8dd0-4375-4577-b9c1-7e942a764564" class="modal bottom-sheet"><div class="modal-content"><h4>/Users/gre462/Documents/MOOSE/projects/numbat/tests/2D/2DSF_recover.i</h4><pre><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  ymin = -100
  ymax = 0
  ny = 20
  nz = 0
  bias_y = 0.75
[]

[Variables]
  [./concentration]
    order = FIRST
    family = LAGRANGE
    initial_condition = 0.0
  [../]
  [./streamfunction]
    order = FIRST
    family = LAGRANGE
    initial_condition = 0.0
  [../]
[]

[Kernels]
  [./Darcy]
    type = NumbatDarcySF
    variable = streamfunction
    concentration = concentration
  [../]
  [./Convection]
    type = NumbatConvectionSF
    variable = concentration
    streamfunction = streamfunction
  [../]
  [./Diffusion]
    type = NumbatDiffusionSF
    variable = concentration
  [../]
  [./TimeDerivative]
    type = TimeDerivative
    variable = concentration
  [../]
[]

[AuxVariables]
  [./u]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./w]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./uAux]
    type = NumbatDarcyVelocitySF
    variable = u
    component = x
    streamfunction = streamfunction
  [../]
  [./wAux]
    type = NumbatDarcyVelocitySF
    variable = w
    component = y
    streamfunction = streamfunction
  [../]
[]

[BCs]
  [./conctop]
    type = DirichletBC
    variable = concentration
    boundary = top
    value = 1.0
  [../]
  [./streamfuntop]
    type = DirichletBC
    variable = streamfunction
    boundary = top
    value = 0.0
  [../]
  [./streamfunbottom]
    type = DirichletBC
    variable = streamfunction
    boundary = bottom
    value = 0.0
  [../]
  [./Periodic]
    [./x]
      variable = 'concentration streamfunction'
      auto_direction = x
    [../]
  [../]
[]

[Executioner]
  type = Transient
  end_time = 100
  solve_type = PJFNK
  petsc_options_iname = '-ksp_type -pc_type -pc_sub_type'
  petsc_options_value = 'gmres asm lu'
[]

[Postprocessors]
  [./boundary_flux]
    type = NumbatSideFluxSF
    variable = concentration
    boundary = top
  [../]
  [./total_mass]
    type = NumbatTotalMassSF
    variable = concentration
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Outputs]
  [./console]
    type = Console
    perf_log = true
    output_nonlinear = true
  [../]
  [./csvoutput]
    type = CSV
    file_base = 2DSF
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./checkpoint]
    type = Checkpoint
    num_files = 2
  [../]
[]
</code></pre></div></div></body></html>