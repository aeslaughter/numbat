<!DOCTYPE html>

<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" name="viewport"/>
<meta content="defaultdict(&lt;type 'int'&gt;, {})" name="moose-status">
<!-- Website title -->
<title>Numbat</title>
<!-- CSS  -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/css/materialize.min.css" rel="stylesheet" type="text/css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/themes/prism.min.css" rel="stylesheet" type="text/css"/>
<link href="../css/moose.css" rel="stylesheet" type="text/css"/>
<!-- Google Charts -->
<script src="https://www.gstatic.com/charts/loader.js" type="text/javascript"></script>
</link></meta></head>
<body>
<div class="page-wrap">
<header>
<!--
Page header including the "sidebar" navigation.
-->
<ul class="dropdown-content" id="dropdown-getting_started">
<li><a href="../getting_started/index.html">Installation</a></li>
</ul>
<ul class="dropdown-content" id="dropdown-theory">
<li><a href="../introduction/index.html">Introduction</a></li>
<li><a href="../governing_equations/index.html">Governing equations</a></li>
</ul>
<ul class="dropdown-content" id="dropdown-details">
<li><a href="../implementation/index.html">Implementation</a></li>
<li><a href="../input_file_syntax/index.html">Input file syntax</a></li>
<li><a href="../systems/index.html">Available objects</a></li>
</ul>
<ul class="dropdown-content" id="dropdown-examples">
<li><a href="index.html">2D</a></li>
<li><a href="../example3D/index.html">3D</a></li>
</ul>
<ul class="dropdown-content" id="dropdown-manual">
<li><a href="../download/index.html">User manual</a></li>
</ul>
<nav>
<div class="nav-wrapper container">
<a class="page-title" href="../index.html">Numbat</a>
<ul class="right">
<li><a class="dropdown-button" data-activates="dropdown-getting_started" href="#!">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li>
<li><a class="dropdown-button" data-activates="dropdown-theory" href="#!">Theory<i class="material-icons right">arrow_drop_down</i></a></li>
<li><a class="dropdown-button" data-activates="dropdown-details" href="#!">Details<i class="material-icons right">arrow_drop_down</i></a></li>
<li><a class="dropdown-button" data-activates="dropdown-examples" href="#!">Examples<i class="material-icons right">arrow_drop_down</i></a></li>
<li><a class="dropdown-button" data-activates="dropdown-manual" href="#!">Manual<i class="material-icons right">arrow_drop_down</i></a></li>
<li>
<form>
<div class="input-field search-wrapper">
<input id="search" required="" type="search">
<label for="search"><i class="material-icons">search</i></label>
<i class="material-icons">close</i>
<div class="search-results"></div>
</input></div>
</form>
</li>
<li>
<a class="github-mark-label" href="https://github.com/cpgr/numbat">
<img class="github-mark" src="../media/github-mark-light.png">GitHub
          
        </img></a>
</li>
</ul>
</div>
</nav>
</header>
<main class="main">
<div class="container">
<!-- Breadcrumbs spanning entire page -->
<div class="row">
<div class="col s12 m12 l12">
<nav class="breadcrumb-nav">
<div class="nav-wrapper">
<div class="col s12 m9 l10">
<span class="breadcrumb"></span>
<a class="breadcrumb" href="index.html">example2D</a>
</div>
</div>
</nav>
</div>
</div>
<!-- Row containing the markdown content and the table-of-contents on the right -->
<div class="row">
<!-- Markdown -->
<div class="col s12 m8 l9" id="moose-markdown-content">
<h1 id="2d-examples">2D examples</h1>
<p>Complete input files for 2D models using the dimensional and dimensionless streamfunction formulations are provided, for both isotropic and anisotropic porous media. These examples
are provided in the Numbat <em>examples</em> folder.</p>
<div class="section scrollspy" id="isotropic-models"><h2 id="isotropic-models">Isotropic models</h2>
<p>The first 2D examples are for an isotropic porous medium (<script type="math/tex">\gamma = 1</script>).</p>
<h3 id="input-file">Input file</h3>
<p>The complete input file for this problem is
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><button class="moose-copy-button btn" data-clipboard-target="#moose-code-block-1">copy</button><code class="language-text" id="moose-code-block-1"># 2D density-driven convective mixing. Instability is seeded by small perturbation
# to porosity. Takes about 5 minutes to run using a single processor.

[Mesh]
  type = GeneratedMesh
  dim = 2
  ymax = 1.5
  nx = 100
  ny = 50
[]

[MeshModifiers]
  [./bias]
    type = NumbatBiasedMesh
    refined_edge = top
    refined_resolution = 0.001
    num_elems = 50
  [../]
[]

[Variables]
  [./concentration]
    initial_condition = 0
    scaling = 1e6
  [../]
  [./pressure]
    initial_condition = 1e6
  [../]
[]

[AuxVariables]
  [./noise]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[ICs]
  [./noise]
    type = RandomIC
    variable = noise
    max = 0.003
    min = -0.003
  [../]
[]

[Materials]
  [./porosity]
    type = NumbatPorosity
    porosity = 0.3
    noise = noise
  [../]
  [./permeability]
    type = NumbatPermeability
    permeability = '1e-11 0 0 0 1e-11 0 0 0 1e-11'
  [../]
  [./diffusivity]
    type = NumbatDiffusivity
    diffusivity = 2e-9
  [../]
  [./density]
    type = NumbatDensity
    concentration = concentration
    zero_density = 995
    delta_density = 10.5
    saturated_concentration = 0.049306
  [../]
  [./viscosity]
    type = NumbatViscosity
    viscosity = 6e-4
  [../]
[]

[Kernels]
  [./time]
    type = NumbatTimeDerivative
    variable = concentration
  [../]
  [./diffusion]
    type = NumbatDiffusion
    variable = concentration
  [../]
  [./convection]
    type = NumbatConvection
    variable = concentration
    pressure = pressure
  [../]
  [./darcy]
    type = NumbatDarcy
    variable = pressure
    concentration = concentration
  [../]
[]

[BCs]
  [./conctop]
    type = PresetBC
    variable = concentration
    boundary = top
    value = 0.049306
  [../]
  [./Periodic]
    [./x]
      variable = concentration
      auto_direction = x
    [../]
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  l_max_its = 200
  end_time = 3e5
  solve_type = NEWTON
  petsc_options = -ksp_snes_ew
  petsc_options_iname = '-pc_type -sub_pc_type -ksp_atol'
  petsc_options_value = 'bjacobi ilu 1e-12'
  nl_abs_tol = 1e-10
  nl_max_its = 25
  dtmax = 2e3
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1
  [../]
[]

[Postprocessors]
  [./boundaryfluxint]
    type = NumbatSideFlux
    variable = concentration
    boundary = top
  [../]
  [./mass]
    type = NumbatTotalMass
    variable = concentration
  [../]
[]

[Outputs]
  [./console]
    type = Console
    perf_log = true
    output_nonlinear = true
  [../]
  [./exodus]
    type = Exodus
    file_base = 2Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./csvoutput]
    type = CSV
    file_base = 2Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/2D/isotropic/2Dddc.i" href="https://github.com/cpgr/numbat/blob/master/examples/2D/isotropic/2Dddc.i">(2Dddc.i)</a></div>
</div>
</p>
<h3 id="running-the-example">Running the example</h3>
<p>This example can be run on the commandline using</p>
<pre><code class="language-text">    numbat-opt -i 2Dddc.i
</code></pre>
<p>Alternatively, this file can be run using the <em>Peacock</em> gui provided by
MOOSE using</p>
<pre><code class="language-text">    peacock -i 2Dddc.i
</code></pre>
<p>in the directory where the input file <em>2Dddc.i</em> resides.</p>
<h3 id="results">Results</h3>
<p>This 2D example should take only a few minutes to run to completion,
producing a concentration profile similar to that presented in <a class="moose-float-reference" data-moose-float-id="fig:2D" href="#Figure">Figure 1</a>,
where several downwelling plumes of high concentration can be observed after 3528 s:</p>
<p>
<div class="moose-float-div moose-figure-div" data-moose-float-name="Figure" id="fig:2D" style="width:80%;margin-left:10px;"><img class="materialboxed" data-caption="2D concentration profile (t = 3528 s)" src="../media/2D.png" width="100%"/><p class="moose-float-caption"><span class="moose-float-caption-heading"><span class="moose-float-caption-heading-label">Figure </span><span class="moose-float-caption-heading-number">1</span><span class="moose-float-caption-heading-suffix">: </span></span><span class="moose-float-caption-text">2D concentration profile (t = 3528 s)</span></p>
</div>
</p>
<p>The flux per unit width over the top boundary is of particular interest in many cases
(especially convective mixing of <script type="math/tex">\textrm{CO}_2</script>). This is calculated using the <em>boundaryfluxint</em> postprocessor in the input file, and presented in <a class="moose-float-reference" data-moose-float-id="fig:2Dflux" href="#Figure">Figure 2</a>.</p>
<p>
<div class="moose-float-div moose-figure-div" data-moose-float-name="Figure" id="fig:2Dflux" style="width:80%;margin-left:10px;"><img class="materialboxed" data-caption="2D flux across the top boundary" src="../media/2Dflux.png" width="100%"/><p class="moose-float-caption"><span class="moose-float-caption-heading"><span class="moose-float-caption-heading-label">Figure </span><span class="moose-float-caption-heading-number">2</span><span class="moose-float-caption-heading-suffix">: </span></span><span class="moose-float-caption-text">2D flux across the top boundary</span></p>
</div>
</p>
<p>Initially, the flux is purely diffusive, and scales as
<script type="math/tex">1 / \sqrt(\pi t)</script>, where <script type="math/tex">t</script> is time (shown as the dashed red line).
After some time, the convective instability becomes sufficiently strong,
at which point the flux across the top boundary rapidly increases (at a
time of approximately 2000 seconds).</p>
</div><div class="section scrollspy" id="anisotropic-models"><h2 id="anisotropic-models">Anisotropic models</h2>
<p>The second 2D example is for an anisotropic porous medium with
<script type="math/tex">\gamma = 0.75</script> (ie., the vertical permeability is three quarters of the horizontal
permeability).</p>
<h3 id="input-file_1">Input file</h3>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><button class="moose-copy-button btn" data-clipboard-target="#moose-code-block-2">copy</button><code class="language-text" id="moose-code-block-2"># 2D density-driven convective mixing. Instability is seeded by small perturbation
# to porosity. Permeability anisotropy is introduced with ky/kx = 0.5.
# Takes about 5 minutes to run using a single processor.

[Mesh]
  type = GeneratedMesh
  dim = 2
  ymax = 1.5
  nx = 100
  ny = 50
[]

[MeshModifiers]
  [./bias]
    type = NumbatBiasedMesh
    refined_edge = top
    refined_resolution = 0.001
    num_elems = 50
  [../]
[]

[Variables]
  [./concentration]
    initial_condition = 0
    scaling = 1e6
  [../]
  [./pressure]
    initial_condition = 1e6
  [../]
[]

[AuxVariables]
  [./noise]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[ICs]
  [./noise]
    type = RandomIC
    variable = noise
    max = 0.003
    min = -0.003
  [../]
[]

[Materials]
  [./porosity]
    type = NumbatPorosity
    porosity = 0.3
    noise = noise
  [../]
  [./permeability]
    type = NumbatPermeability
    permeability = '1e-11 0 0 0 5e-12 0 0 0 1e-11'
  [../]
  [./diffusivity]
    type = NumbatDiffusivity
    diffusivity = 2e-9
  [../]
  [./density]
    type = NumbatDensity
    concentration = concentration
    zero_density = 995
    delta_density = 10.5
  [../]
  [./viscosity]
    type = NumbatViscosity
    viscosity = 6e-4
  [../]
[]

[Kernels]
  [./time]
    type = NumbatTimeDerivative
    variable = concentration
  [../]
  [./diffusion]
    type = NumbatDiffusion
    variable = concentration
  [../]
  [./convection]
    type = NumbatConvection
    variable = concentration
    pressure = pressure
  [../]
  [./darcy]
    type = NumbatDarcy
    variable = pressure
    concentration = concentration
  [../]
[]

[BCs]
  [./conctop]
    type = NumbatPerturbationBC
    variable = concentration
    boundary = top
    value = 1.0
  [../]
  [./Periodic]
    [./x]
      variable = concentration
      auto_direction = x
    [../]
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  l_max_its = 200
  end_time = 5e5
  solve_type = NEWTON
  petsc_options = -ksp_snes_ew
  petsc_options_iname = '-ksp_atol'
  petsc_options_value = '1e-10'
  nl_abs_tol = 1e-9
  dtmax = 1e3
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1
  [../]
[]

[Postprocessors]
  [./boundaryfluxint]
    type = NumbatSideFlux
    variable = concentration
    boundary = top
  [../]
  [./mass]
    type = NumbatTotalMass
    variable = concentration
  [../]
[]

[Outputs]
  [./console]
    type = Console
    perf_log = true
    output_nonlinear = true
  [../]
  [./exodus]
    type = Exodus
    file_base = 2Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./csvoutput]
    type = CSV
    file_base = 2Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/2D/anisotropic/2Dddc.i" href="https://github.com/cpgr/numbat/blob/master/examples/2D/anisotropic/2Dddc.i">(2Dddc.i)</a></div>
</div>
</p>
<p>Note that the permeability anisotropy is introduced in the kernels using the <em>gamma</em> and <em>anisotropic_tensor</em> input parameters.</p>
<h3 id="running-the-example_1">Running the example</h3>
<p>This example can be run on the commandline using</p>
<pre><code class="language-text">    numbat-opt -i 2Dddc_anisotropic.i
</code></pre>
<p>Alternatively, this file can be run using the <em>Peacock</em> gui provided by
MOOSE using</p>
<pre><code class="language-text">    peacock -i 2Dddc_anisotropic.i
</code></pre>
<p>in the directory where the input file <em>2Dddc_anisotropic.i</em> resides.</p>
<h3 id="results_1">Results</h3>
<p>This 2D example should take only a few minutes to run to completion,
producing a concentration profile similar to that presented in <a class="moose-float-reference" data-moose-float-id="fig:2Da" href="#Figure">Figure 3</a>,
where several downwelling plumes of high concentration can be observed after 5000 s:</p>
<p>
<div class="moose-float-div moose-figure-div" data-moose-float-name="Figure" id="fig:2Da" style="width:80%;margin-left:10px;"><img class="materialboxed" data-caption="2D concentration profile for $\gamma = 0.75$ (t = 5000 s)" src="../media/2Danisotropic.png" width="100%"/><p class="moose-float-caption"><span class="moose-float-caption-heading"><span class="moose-float-caption-heading-label">Figure </span><span class="moose-float-caption-heading-number">3</span><span class="moose-float-caption-heading-suffix">: </span></span><span class="moose-float-caption-text">2D concentration profile for <script type="math/tex">\gamma = 0.75</script> (t = 5000 s)</span></p>
</div>
</p>
<p>In comparison to the isotropic example (with <script type="math/tex">\gamma = 1</script>) presented in <a class="moose-float-reference" data-moose-float-id="fig:2D" href="#Figure">Figure 1</a>, we note that the concentration profile in the anisotropic example
has only reached a similar depth after 5000 s (compared to 3528 s). The effect of the reduced vertical permeability in the anisotropic example slows the convective transport.</p>
<p>This observation can be quantified by comparing the flux per unit width over the top boundary of both examples, see <a class="moose-float-reference" data-moose-float-id="fig:2Dfluxcomp" href="#Figure">Figure 4</a>.</p>
<p>
<div class="moose-float-div moose-figure-div" data-moose-float-name="Figure" id="fig:2Dfluxcomp" style="width:80%;margin-left:10px;"><img class="materialboxed" data-caption="Comparison of the 2D flux across the top boundary" src="../media/2Dfluxcomp.png" width="100%"/><p class="moose-float-caption"><span class="moose-float-caption-heading"><span class="moose-float-caption-heading-label">Figure </span><span class="moose-float-caption-heading-number">4</span><span class="moose-float-caption-heading-suffix">: </span></span><span class="moose-float-caption-text">Comparison of the 2D flux across the top boundary</span></p>
</div>
</p>
<p>The inclusion of permeability anisotropy delays the onset of convection in comparison to the isotropic example, from a time of approximately 2000 seconds in the isotropic example
to approximately 3500 seconds in the anisotropic example.</p>
</div>
</div>
<!-- TOC -->
<div class="col hid-on-small-only m4 l3">
<!--
Table of Contents

Loops through the current MoosePage object and builds a list
of second level headers.

Additionally, the "Edit on Github" button is added that links
the source markdown file if the 'github_edit' paramater is
set to True (the default).

-->
<div class="toc-wrapper pin-top">
<div class="moose-devel-links-container">
</div>
<div class="section table-of-contents">
<ul>
<li><a href="#isotropic-models">Isotropic models</a></li>
<li><a href="#anisotropic-models">Anisotropic models</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</main>
</div>
<footer class="page-footer">
<!--MOOSE Footer-->
<div class="container white-text">
<div class="row">
<div class="col s12">
<p>
<span class="moose-site-generated">
        Site Generated with <a href="https://www.mooseframework.org">MOOSE</a>
</span>
<span class="moose-edit-markdown">
<a class="moose-edit-markdown-link" href="https://github.com/cpgr/numbat/edit/devel/docs/content/example2D.md" style="float:right">Edit Markdown</a>
</span>
</p>
</div>
</div>
<div class="row">
<div class="col s12">
<p class="moose-status-container">
<span id="moose-status">
<span class="new badge pass" data-badge-caption="pass"></span>
</span>
</p>
</div>
</div>
</div>
</footer>
<script src="https://code.jquery.com/jquery-2.1.1.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/js/materialize.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/prism.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js" type="text/javascript"></script>
<script src="https://cdn.rawgit.com/zenorocha/clipboard.js/master/dist/clipboard.min.js" type="text/javascript"></script>
<script src="../js/init.js" type="text/javascript"></script>
</body>
</html>