<!DOCTYPE html><html><head><meta charset="UTF-8"><link media="screen,projection" href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><script src="../../contrib/jquery/jquery.min.js" type="text/javascript"></script><script src="../../contrib/materialize/materialize.min.js" type="text/javascript"></script><script src="../../contrib/clipboard/clipboard.min.js" type="text/javascript"></script><script src="../../contrib/prism/prism.min.js" type="text/javascript"></script><script src="../../contrib/katex/katex.min.js" type="text/javascript"></script><script src="../../contrib/fuse/fuse.min.js" type="text/javascript"></script><script src="../../js/search_index.js" type="text/javascript"></script><script src="../../js/init.js" type="text/javascript"></script><title>TestHarness|Numbat</title><script src="../../contrib/plotly/plotly.min.js" type="text/javascript"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://github.com/cpgr/numbat" class="right"><img src="../../media/github-logo.png" class="github-mark"></img><img src="../../media/github-mark.png" class="github-logo"></img></a><a href="http://cpgr.github.io/numbat/" class="left moose-logo">Numbat</a><ul class="right hide-on-med-and-down" id="nav-mobile"><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="cecb47aa-94ff-4f75-8861-7bb2695ce6cd">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="d18fff13-35e2-4bf6-9475-09b180e86a64">Theory<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="76e26551-de3a-4402-a6a8-ef230e685a20">Details<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="ea0badd7-327d-4e94-a444-8a7a59fe4d07">Examples<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="082f1998-4aeb-4ad3-b4c3-dbcf551fec06">Manual<i class="material-icons right">arrow_drop_down</i></a></li></ul><ul class="dropdown-content" id="cecb47aa-94ff-4f75-8861-7bb2695ce6cd"><li><a href="../../getting_started.html">Installation</a></li></ul><ul class="dropdown-content" id="d18fff13-35e2-4bf6-9475-09b180e86a64"><li><a href="../../introduction.html">Introduction</a></li><li><a href="../../governing_equations.html">Governing equations</a></li></ul><ul class="dropdown-content" id="76e26551-de3a-4402-a6a8-ef230e685a20"><li><a href="../../implementation.html">Implementation</a></li><li><a href="../../input_file_syntax.html">Input file syntax</a></li><li><a href="../../running_numbat.html">Running Numbat</a></li><li><a href="../../systems.html">Available objects</a></li></ul><ul class="dropdown-content" id="ea0badd7-327d-4e94-a444-8a7a59fe4d07"><li><a href="../../example2D.html">2D</a></li><li><a href="../../example3D.html">3D</a></li></ul><ul class="dropdown-content" id="082f1998-4aeb-4ad3-b4c3-dbcf551fec06"><li><a href="../../download.html">User manual</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input autocomplete="off" onkeyup="mooseSearch()" type="text" id="moose-search-box"><label for="search">http://cpgr.github.io/numbat/</label></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-action modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><span class="breadcrumb">utilities</span><a href="." class="breadcrumb">python</a><a href="TestHarness.html" class="breadcrumb">TestHarness</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section data-section-text="TestHarness" data-section-level="1" id="e3d06de0-b5ac-4e59-a8a8-a7c3886111f6"><h1>TestHarness</h1><p>The TestHarness is the Python code behind the <code>run_tests</code> script in MOOSE and every MOOSE-based application. It is responsible for finding tests and running them. Here we describe how to use the <code>run_tests</code> script and how to create your own tests.</p><p>The ideas behind testing are described over the in the <a data-position="top" href="../../application_development/test_system.html" class="tooltipped" data-tooltip="../../application_development/test_system.html">MOOSE Test System</a> documentation.</p><section class="scrollspy" data-section-text="run _ tests" data-section-level="2" id="9659afc4-f567-4cef-822c-094b75cb5f32"><h2>run_tests</h2><p><code>run_tests</code> is a small Python script that can be found in every MOOSE-based application and in the framework itself (under <code>moose/test</code>). The <code>run_tests</code> script will find tests and run them with your compiled binary for your app.</p><section data-section-text="Basic   Usage" data-section-level="3" id="c2a9ddfc-9fee-4f2c-9cc1-8b8c73510206"><h3>Basic Usage</h3><p>To run the tests for any application, make sure the executable is built (generally by running <code>make</code> see the <a data-position="top" href="../../application_development/build_system.html" class="tooltipped" data-tooltip="../../application_development/build_system.html">Build System</a>) and then do:</p><pre><code class="language-bash">
./run_tests -j 8
</code></pre><p>There are many options for <code>run_tests</code>, but the <code>-j</code> option shown above is by far the most widely used. It tells the <code>run_tests</code> script how many processors to utilize on your local machine for running tests concurrently. Put the correct number there (instead of 8). The script will then go find and run your tests and display the results.</p></section><section data-section-text="More   Options" data-section-level="3" id="3b418e68-3cc7-4a65-9e14-c12cf7efcde1"><h3>More Options</h3><p>To see more options for <code>run_tests</code> you can invoke it with <code>-h</code>. There are many options to look through, but some of the important ones are:</p><ul class="browser-default"><li><p><code>--failed-tests</code>: Runs the tests that just failed. Note: as long as you keep using the <code>--failed-tests</code> option the set of failed tests will not change. </p></li><li><p><code>--n-threads #</code>: Causes the tests to run with <code>#</code> of (OpenMP/Pthread/TBB) threads. </p></li><li><p><code>-p #</code>: Causes the tests to run with <code>#</code> MPI processes. Useful for guaranteeing that you get the same result in parallel! </p></li><li><p><code>--valgrind</code>: Run all of the tests with the <a href="http://valgrind.org" data-tooltip="http://valgrind.org" data-position="top" class="tooltipped">Valgrind</a> utility. Does extensive memory checking to catch segfaults and uninitialized memory errors. </p></li><li><p><code>--recover</code>: Run all of the tests in "recovery" mode. This runs the test halfway, stops, then attempts to "recover" it and run until the end. This is very rigorous testing that tests whether everything in your application can work with restart/recover.</p></li></ul></section></section><section class="scrollspy" data-section-text="testroot" data-section-level="2" id="94773c28-15bb-47e6-a087-c3462d3849ed"><h2><code>testroot</code></h2><p>The <code>testroot</code> file is a small configuration file that is formatted like a MOOSE input file. It is read by the <code>run_tests</code> script. It should be placed in the root of your application directory (i.e. right next to where the binary is). Some things you can set in that file are:</p><ul class="browser-default"><li><p><code>app_name</code>: A unique, short name for your application. </p></li><li><p><code>allow_warnings</code>: <code>true</code> by default, set this to <code>false</code> to make all warnings from running tests be _errors_ instead. </p></li><li><p><code>allow_override</code> and <code>allow_unused</code>: <code>true</code> by default if set to <code>false</code> then syntax errors in your test input files will be treated as errors.</p></li></ul><p>The one thing we do <strong>not</strong> recommend is enforcing that the use of deprecated code should be treated like an error. That is entirely too rigid of a requirement and impedes the normal flow of development. Instead, developers should periodically run their tests with <code>--error-deprecated</code> to see if any of their tests are using deprecated code / parameters and then fix them up at that point. The MOOSE team is not responsible for fixing deprecations. </p></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a data-delay="1000" data-position="left" href="#9659afc4-f567-4cef-822c-094b75cb5f32" class="tooltipped" data-tooltip="run _ tests">run _ tests</a></li><li><a data-delay="1000" data-position="left" href="#94773c28-15bb-47e6-a087-c3462d3849ed" class="tooltipped" data-tooltip="testroot">testroot</a></li></ul></div></div></div></div></main></div></body></html>