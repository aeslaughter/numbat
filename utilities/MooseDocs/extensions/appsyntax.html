<!DOCTYPE html><html><head><meta charset="UTF-8"><link media="screen,projection" href="../../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet"></link><link href="../../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/moose.css" type="text/css" rel="stylesheet"></link><script src="../../../contrib/jquery/jquery.min.js" type="text/javascript"></script><script src="../../../contrib/materialize/materialize.min.js" type="text/javascript"></script><script src="../../../contrib/clipboard/clipboard.min.js" type="text/javascript"></script><script src="../../../contrib/prism/prism.min.js" type="text/javascript"></script><script src="../../../contrib/katex/katex.min.js" type="text/javascript"></script><script src="../../../contrib/fuse/fuse.min.js" type="text/javascript"></script><script src="../../../js/search_index.js" type="text/javascript"></script><script src="../../../js/init.js" type="text/javascript"></script><title>AppSyntax   Extension|Numbat</title></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://github.com/cpgr/numbat" class="right"><img src="../../../media/github-logo.png" class="github-mark"></img><img src="../../../media/github-mark.png" class="github-logo"></img></a><a href="http://cpgr.github.io/numbat/" class="left moose-logo">Numbat</a><ul class="right hide-on-med-and-down" id="nav-mobile"><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="4630054e-b9d7-47c8-950f-540b91a3e22c">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="0322afaa-cedc-4de1-82dc-30c2d5f7216c">Theory<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="33d7dd54-554b-45d3-b56e-a634f1be4f49">Details<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="f74047dd-bc79-4ec3-9ab4-469e9755f0fc">Examples<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="31def644-74d7-4264-bf5c-e5e62f919549">Manual<i class="material-icons right">arrow_drop_down</i></a></li></ul><ul class="dropdown-content" id="4630054e-b9d7-47c8-950f-540b91a3e22c"><li><a href="../../../getting_started.html">Installation</a></li></ul><ul class="dropdown-content" id="0322afaa-cedc-4de1-82dc-30c2d5f7216c"><li><a href="../../../introduction.html">Introduction</a></li><li><a href="../../../governing_equations.html">Governing equations</a></li></ul><ul class="dropdown-content" id="33d7dd54-554b-45d3-b56e-a634f1be4f49"><li><a href="../../../implementation.html">Implementation</a></li><li><a href="../../../input_file_syntax.html">Input file syntax</a></li><li><a href="../../../systems.html">Available objects</a></li></ul><ul class="dropdown-content" id="f74047dd-bc79-4ec3-9ab4-469e9755f0fc"><li><a href="../../../example2D.html">2D</a></li><li><a href="../../../example3D.html">3D</a></li></ul><ul class="dropdown-content" id="31def644-74d7-4264-bf5c-e5e62f919549"><li><a href="../../../download.html">User manual</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input autocomplete="off" onkeyup="mooseSearch()" type="text" id="moose-search-box"><label for="search">http://cpgr.github.io/numbat/</label></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-action modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><span class="breadcrumb">utilities</span><a href=".." class="breadcrumb">MooseDocs</a><span class="breadcrumb">extensions</span><a href="appsyntax.html" class="breadcrumb">appsyntax</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section data-section-text="AppSyntax   Extension" data-section-level="1" id="48110ef4-adbd-4ea6-83e4-84097e61d526"><h1>AppSyntax Extension</h1><p>The AppSyntax Extension defines the <code>!syntax</code> markdown <a data-position="top" href="command.html" class="tooltipped" data-tooltip="command.html">command</a>, which contains various sub-commands for creating MOOSE specific links and tables within your markdown, each are explained below. Note, the examples below refer to documentation associated with Kernels and/or the Diffusion Kernel. This should be replaced by the syntax for the system or object being documented. The configuration options for the extension itself are listed in <a class="tooltipped" href="#appsyntax-config" data-tooltip="#appsyntax-config" data-position="top">Table 1</a>.</p><div id="appsyntax-config" class="card"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Table 1: </span><span class="moose-caption-text">Configuration options for the AppSyntax extension.</span></p><div class="moose-table-div"><table><thead><tr><th>Key</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td>inputs</td><td>[]</td><td>List of directories to interrogate for input files using an object.</td></tr><tr><td>executable</td><td>None</td><td>The MOOSE application executable to use for generating syntax.</td></tr><tr><td>hide</td><td>None</td><td>Dictionary of syntax to hide.</td></tr><tr><td>alias</td><td>None</td><td>List of Dictionary of lists of syntax aliases.</td></tr><tr><td>remove</td><td>None</td><td>List or Dictionary of lists of syntax to remove.</td></tr><tr><td>includes</td><td>[]</td><td>List of include directories to investigate for class information.</td></tr><tr><td>visible</td><td>set(['required', 'optional'])</td><td>Parameter groups to show as un-collapsed.</td></tr><tr><td>disable</td><td>False</td><td>Disable running the MOOSE application executable and simply use place holder text.</td></tr><tr><td>allow-test-objects</td><td>False</td><td>Enable the test objects.</td></tr></tbody></table></div></div></div><section class="section scrollspy" data-section-text="Class   Description   ( !syntax description )" data-section-level="2" id="0f5922f8-f4b4-4de6-a7ee-8be87c6fbda3"><h2>Class Description (<code>!syntax description</code>)</h2><p>The <code>description</code> sub-command adds a paragraph with the content of InputParameters object class descriptions, which is added in the MOOSE application within the <code>validParams</code> method. The available settings are included in <a class="tooltipped" href="#appsyntax-description-settings" data-tooltip="#appsyntax-description-settings" data-position="top">Table 2</a>.</p><div id="appsyntax-description-settings" class="card"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Table 2: </span><span class="moose-caption-text">Available command settings for <code>!syntax description</code> command.</span></p><div class="moose-table-div"><table><thead><tr><th>Key</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td>style</td><td></td><td>The style settings that are passed to rendered HTML tag.</td></tr><tr><td>syntax</td><td>None</td><td>The name of the syntax to extract. If the name of the syntax is the first item in the settings the 'syntax=' may be omitted, e.g., `!syntax parameters /Kernels/Diffusion`.</td></tr><tr><td>class</td><td></td><td>The class settings to be passed to rendered HTML tag.</td></tr><tr><td>id</td><td></td><td>The class settings to be passed to the rendered tag.</td></tr></tbody></table></div></div></div><p>For example, the FileMesh object includes a <code>validParams</code> function as shown in <a class="tooltipped" href="#file-mesh-valid-params" data-tooltip="#file-mesh-valid-params" data-position="top">Listing 1</a>. Notice, that the <code>addClassDescription</code> method includes a short description of the object. To display this text the <code>!syntax description</code> command is used followed by the MOOSE input file syntax for the object as in <a class="tooltipped" href="#appsyntax-description" data-tooltip="#appsyntax-description" data-position="top">Example 1</a>.</p><div id="appsyntax-description" class="card"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Example 1: </span><span class="moose-caption-text">Example use of the <code>!syntax description</code> command.</span></p><div class="row card-content"><div class="moose-example-code col s12 m12 l12"><pre><code class="language-text">!syntax description /Mesh/FileMesh style=color:green
</code></pre></div><div class="moose-example-rendered col s12 m12 l12"><p>Read a mesh from a file.</p></div></div></div></div><div class="card"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Listing 1: </span><span class="moose-caption-text">The validParams function from the FileMesh object.</span></p><pre style="max-height:350px;"><code class="language-cpp">template &lt;&gt;
InputParameters
validParams&lt;FileMesh&gt;()
{
  InputParameters params = validParams&lt;MooseMesh&gt;();
  params.addRequiredParam&lt;MeshFileName&gt;(&quot;file&quot;, &quot;The name of the mesh file to read&quot;);
  params.addClassDescription(&quot;Read a mesh from a file.&quot;);
  return params;
}</code></pre><a data-position="top" href="#4258d5e8-bafc-47aa-aac6-759d00b3358e" class="tooltipped modal-trigger" data-tooltip="/Users/gre462/Documents/MOOSE/projects/moose/framework/src/mesh/FileMesh.C">(../moose/framework/src/mesh/FileMesh.C)</a></div></div></section><section class="section scrollspy" data-section-text="Object   Parameters   ( !syntax parameters )" data-section-level="2" id="dba1c45c-f896-47a3-b124-cd57c707a618"><h2>Object Parameters (<code>!syntax parameters</code>)</h2><p>The <code>parameters</code> sub-command provides a means for displaying the default input file syntax for an object as shown in <a class="tooltipped" href="#appsyntax-parameters-example" data-tooltip="#appsyntax-parameters-example" data-position="top">Example 2</a>. The available settings for the parameters commaond are shown in <a class="tooltipped" href="#appsyntax-parameters-settings" data-tooltip="#appsyntax-parameters-settings" data-position="top">Table 3</a>.</p><div id="appsyntax-parameters-settings" class="card"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Table 3: </span><span class="moose-caption-text">Command settings for <code>!syntax parameters</code> command.</span></p><div class="moose-table-div"><table><thead><tr><th>Key</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td>style</td><td></td><td>The style settings that are passed to rendered HTML tag.</td></tr><tr><td>hide</td><td>None</td><td>Space separated list of parameters to remove from output.</td></tr><tr><td>groups</td><td>None</td><td>Space separated list of groups, in desired order, to output.</td></tr><tr><td>show</td><td>None</td><td>Space separated list of parameters to display in output.</td></tr><tr><td>class</td><td></td><td>The class settings to be passed to rendered HTML tag.</td></tr><tr><td>syntax</td><td>None</td><td>The name of the syntax to extract. If the name of the syntax is the first item in the settings the 'syntax=' may be omitted, e.g., `!syntax parameters /Kernels/Diffusion`.</td></tr><tr><td>visible</td><td>None</td><td>Space separated list of parameter groups to display with un-collapsed sections.</td></tr><tr><td>heading-level</td><td>2</td><td>Heading level for section title.</td></tr><tr><td>id</td><td></td><td>The class settings to be passed to the rendered tag.</td></tr><tr><td>heading</td><td>Input Parameters</td><td>The heading title for the input parameters table, use 'None' to remove the heading.</td></tr></tbody></table></div></div></div><div id="appsyntax-parameters-example" class="card"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Example 2: </span><span class="moose-caption-text">Example of <code>!syntax parameters</code> command.</span></p><div class="row card-content"><div class="moose-example-code col s12 m12 l12"><pre><code class="language-text">!syntax parameters /Dampers/ConstantDamper
</code></pre></div><div class="moose-example-rendered col s12 m12 l12"><h2>Input Parameters</h2><h3 data-details-open="open">Required Parameters</h3><ul data-collapsible="expandable" class="collapsible"><li><div class="collapsible-header"><span class="moose-parameter-name">damping</span><span class="moose-parameter-header-description">The percentage (between 0 and 1) of the newton update to take.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>double</p><p class="moose-parameter-description"><span>Description:</span>The percentage (between 0 and 1) of the newton update to take.</p></div></li></ul><h3 data-details-open="open">Optional Parameters</h3><ul data-collapsible="expandable" class="collapsible"><li><div class="collapsible-header"><span class="moose-parameter-name">min_damping</span><span class="moose-parameter-header-default">0</span><span class="moose-parameter-header-description">Minimum value of computed damping. Damping lower than this will result in an exception being thrown and cutting the time step</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>0</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>double</p><p class="moose-parameter-description"><span>Description:</span>Minimum value of computed damping. Damping lower than this will result in an exception being thrown and cutting the time step</p></div></li></ul><h3 data-details-open="close">Advanced Parameters</h3><ul data-collapsible="expandable" class="collapsible"><li><div class="collapsible-header"><span class="moose-parameter-name">control_tags</span><span class="moose-parameter-header-description">Adds user-defined labels for accessing object parameters via control logic.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<std::string></p><p class="moose-parameter-description"><span>Description:</span>Adds user-defined labels for accessing object parameters via control logic.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">enable</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Set the enabled status of the MooseObject.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description"><span>Description:</span>Set the enabled status of the MooseObject.</p></div></li></ul></div></div></div></div></section><section class="section scrollspy" data-section-text="Input   Files   ( !syntax inputs )" data-section-level="2" id="d92ed212-f307-49f9-a9dd-e993c324157c"><h2>Input Files (<code>!syntax inputs</code>)</h2><p>In many cases it is useful to know where in the examples, tutorials, or tests an object is utilized in an input file. Therefore, <code>inputs</code> sub-command is defined. <a class="tooltipped" href="#appsyntax-inputs-example" data-tooltip="#appsyntax-inputs-example" data-position="top">Example 3</a> lists all the input files that use include the ConstantDamper object and <a class="tooltipped" href="#appsyntax-inputs-settings" data-tooltip="#appsyntax-inputs-settings" data-position="top">Table 4</a> provides the available settings for the <code>inputs</code> command.</p><div id="appsyntax-inputs-settings" class="card"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Table 4: </span><span class="moose-caption-text">Available command settings for <code>!syntax inputs</code> commands.</span></p><div class="moose-table-div"><table><thead><tr><th>Key</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td>style</td><td></td><td>The style settings that are passed to rendered HTML tag.</td></tr><tr><td>class</td><td></td><td>The class settings to be passed to rendered HTML tag.</td></tr><tr><td>syntax</td><td>None</td><td>The name of the syntax to extract. If the name of the syntax is the first item in the settings the 'syntax=' may be omitted, e.g., `!syntax parameters /Kernels/Diffusion`.</td></tr><tr><td>heading-level</td><td>2</td><td>Heading level for section title.</td></tr><tr><td>id</td><td></td><td>The class settings to be passed to the rendered tag.</td></tr><tr><td>heading</td><td>Input Files</td><td>Heading to include for sections, use 'None' to remove the title.</td></tr></tbody></table></div></div></div><div id="appsyntax-inputs-example" class="card"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Example 3: </span><span class="moose-caption-text">Example use of the <code>!syntax inputs</code> command.</span></p><div class="row card-content"><div class="moose-example-code col s12 m12 l12"><pre><code class="language-text">!syntax inputs /Dampers/ConstantDamper
</code></pre></div><div class="moose-example-rendered col s12 m12 l12"></div></div></div></div></section><section class="section scrollspy" data-section-text="Child   Objects   ( !syntax children )" data-section-level="2" id="64220273-9aa1-4f71-ba28-306857598ddc"><h2>Child Objects (<code>!syntax children</code>)</h2><p>MOOSE is designed on the idea of <a href="https://en.wikipedia.org/wiki/Inheritance_(object-oriented_programming" data-tooltip="https://en.wikipedia.org/wiki/Inheritance_(object-oriented_programming" data-position="top" class="tooltipped">inheritance</a>, as such it is often useful to understand which classes inherit from another. The <code>children</code> sub-command creates a list of all child classes of the given object, as shown in <a class="tooltipped" href="#appsyntax-children-example" data-tooltip="#appsyntax-children-example" data-position="top">Example 4</a>. The available settings for the <code>children</code> command are provided below.</p><div id="appsyntax-children-example" class="card"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Example 4: </span><span class="moose-caption-text">Example use the the <code>!syntax children</code> command.</span></p><div class="row card-content"><div class="moose-example-code col s12 m12 l12"><pre><code class="language-text">!syntax children /Kernels/Diffusion
</code></pre></div><div class="moose-example-rendered col s12 m12 l12"></div></div></div></div><div id="appsyntax-children-settings" class="card"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Table 5: </span><span class="moose-caption-text">Command settings for <code>!syntax children</code> command.</span></p><div class="moose-table-div"><table><thead><tr><th>Key</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td>style</td><td></td><td>The style settings that are passed to rendered HTML tag.</td></tr><tr><td>class</td><td></td><td>The class settings to be passed to rendered HTML tag.</td></tr><tr><td>syntax</td><td>None</td><td>The name of the syntax to extract. If the name of the syntax is the first item in the settings the 'syntax=' may be omitted, e.g., `!syntax parameters /Kernels/Diffusion`.</td></tr><tr><td>heading-level</td><td>2</td><td>Heading level for section title.</td></tr><tr><td>id</td><td></td><td>The class settings to be passed to the rendered tag.</td></tr><tr><td>heading</td><td>Child Objects</td><td>Heading to include for sections, use 'None' to remove the title.</td></tr></tbody></table></div></div></div></section><section class="section scrollspy" data-section-text="Actions ,   Objects ,   and   Systems   ( !syntax list )" data-section-level="2" id="30747041-9b52-4a4f-8ee2-094cb7f5c4b8"><h2>Actions, Objects, and Systems (<code>!syntax list</code>)</h2><p>MOOSE is based on systems (e.g., Kernels), where each system contains a set of objects, actions, and subsystems that can be used within an input file block. It is desirable to list the available object for a given system, which is the reason behind the <code>!syntax list</code> command. The available settings for this command are included in <a class="tooltipped" href="#appsyntax-list-settings" data-tooltip="#appsyntax-list-settings" data-position="top">Table 6</a>.</p><div id="appsyntax-list-settings" class="card"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Table 6: </span><span class="moose-caption-text">Command settings for <code>!syntax list</code> command.</span></p><div class="moose-table-div"><table><thead><tr><th>Key</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td>style</td><td></td><td>The style settings that are passed to rendered HTML tag.</td></tr><tr><td>subsystems</td><td>True</td><td>Include a list of sub system syntax in the output.</td></tr><tr><td>actions</td><td>True</td><td>Include a list of Action objects in syntax.</td></tr><tr><td>syntax</td><td>None</td><td>The name of the syntax to extract. If the name of the syntax is the first item in the settings the 'syntax=' may be omitted, e.g., `!syntax parameters /Kernels/Diffusion`.</td></tr><tr><td>objects</td><td>True</td><td>Include a list of MooseObject objects in syntax.</td></tr><tr><td>groups</td><td>None</td><td>List of groups (apps) to include in the complete syntax list.</td></tr><tr><td>id</td><td></td><td>The class settings to be passed to the rendered tag.</td></tr><tr><td>class</td><td></td><td>The class settings to be passed to rendered HTML tag.</td></tr></tbody></table></div></div></div><div id="appsyntax-list-example" class="card"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Example 5: </span><span class="moose-caption-text">None</span></p><div class="row card-content"><div class="moose-example-code col s12 m12 l12"><pre><code class="language-text">!syntax list /Adaptivity
</code></pre></div><div class="moose-example-rendered col s12 m12 l12"><ul class="collection with-header"><li class="moose-syntax-actions collection-item"><a href="../../../documentation/systems/Adaptivity/SetAdaptivityOptionsAction.html" class="moose-syntax-actions-name">SetAdaptivityOptionsAction</a></li><li class="moose-syntax-subsystems collection-item"><a href="../../../documentation/systems/Adaptivity/Indicators/index.html" class="moose-syntax-subsystems-name">Indicators</a></li><li class="moose-syntax-subsystems collection-item"><a href="../../../documentation/systems/Adaptivity/Markers/index.html" class="moose-syntax-subsystems-name">Markers</a></li></ul></div></div></div></div></section><section class="section scrollspy" data-section-text="Complete   Syntax   List" data-section-level="2" id="b0c0c21c-d211-474d-9980-82f99a972346"><h2>Complete Syntax List</h2><pre><code class="language-text">
!syntax complete level=3
</code></pre></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a data-delay="1000" data-position="left" href="#0f5922f8-f4b4-4de6-a7ee-8be87c6fbda3" class="tooltipped" data-tooltip="Class   Description   ( !syntax description )">Class   Description   ( !syntax description )</a></li><li><a data-delay="1000" data-position="left" href="#dba1c45c-f896-47a3-b124-cd57c707a618" class="tooltipped" data-tooltip="Object   Parameters   ( !syntax parameters )">Object   Parameters   ( !syntax parameters )</a></li><li><a data-delay="1000" data-position="left" href="#d92ed212-f307-49f9-a9dd-e993c324157c" class="tooltipped" data-tooltip="Input   Files   ( !syntax inputs )">Input   Files   ( !syntax inputs )</a></li><li><a data-delay="1000" data-position="left" href="#64220273-9aa1-4f71-ba28-306857598ddc" class="tooltipped" data-tooltip="Child   Objects   ( !syntax children )">Child   Objects   ( !syntax children )</a></li><li><a data-delay="1000" data-position="left" href="#30747041-9b52-4a4f-8ee2-094cb7f5c4b8" class="tooltipped" data-tooltip="Actions ,   Objects ,   and   Systems   ( !syntax list )">Actions ,   Objects ,   and   Systems   ( !syntax list )</a></li><li><a data-delay="1000" data-position="left" href="#b0c0c21c-d211-474d-9980-82f99a972346" class="tooltipped" data-tooltip="Complete   Syntax   List">Complete   Syntax   List</a></li></ul></div></div></div></div></main></div><div id="4258d5e8-bafc-47aa-aac6-759d00b3358e" class="modal bottom-sheet"><div class="modal-content"><h4>/Users/gre462/Documents/MOOSE/projects/moose/framework/src/mesh/FileMesh.C</h4><pre><code class="language-cpp">// This file is part of the MOOSE framework
// https://www.mooseframework.org
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;FileMesh.h&quot;
#include &quot;Parser.h&quot;
#include &quot;MooseUtils.h&quot;
#include &quot;Moose.h&quot;
#include &quot;MooseApp.h&quot;

#include &quot;libmesh/exodusII_io.h&quot;
#include &quot;libmesh/nemesis_io.h&quot;
#include &quot;libmesh/parallel_mesh.h&quot;

registerMooseObject(&quot;MooseApp&quot;, FileMesh);

template &lt;&gt;
InputParameters
validParams&lt;FileMesh&gt;()
{
  InputParameters params = validParams&lt;MooseMesh&gt;();
  params.addRequiredParam&lt;MeshFileName&gt;(&quot;file&quot;, &quot;The name of the mesh file to read&quot;);
  params.addClassDescription(&quot;Read a mesh from a file.&quot;);
  return params;
}

FileMesh::FileMesh(const InputParameters &amp; parameters)
  : MooseMesh(parameters), _file_name(getParam&lt;MeshFileName&gt;(&quot;file&quot;))
{
  getMesh().set_mesh_dimension(getParam&lt;MooseEnum&gt;(&quot;dim&quot;));
}

FileMesh::FileMesh(const FileMesh &amp; other_mesh)
  : MooseMesh(other_mesh), _file_name(other_mesh._file_name)
{
}

FileMesh::~FileMesh() {}

std::unique_ptr&lt;MooseMesh&gt;
FileMesh::safeClone() const
{
  return libmesh_make_unique&lt;FileMesh&gt;(*this);
}

void
FileMesh::buildMesh()
{
  std::string _file_name = getParam&lt;MeshFileName&gt;(&quot;file&quot;);

  Moose::perf_log.push(&quot;Read Mesh&quot;, &quot;Setup&quot;);
  if (_is_nemesis)
  {
    // Nemesis_IO only takes a reference to DistributedMesh, so we can't be quite so short here.
    DistributedMesh &amp; pmesh = cast_ref&lt;DistributedMesh &amp;&gt;(getMesh());
    Nemesis_IO(pmesh).read(_file_name);

    getMesh().allow_renumbering(false);

    // Even if we want repartitioning when load balancing later, we'll
    // begin with the default partitioning defined by the Nemesis
    // file.
    bool skip_partitioning_later = getMesh().skip_partitioning();
    getMesh().skip_partitioning(true);
    getMesh().prepare_for_use();
    getMesh().skip_partitioning(skip_partitioning_later);
  }
  else // not reading Nemesis files
  {
    // See if the user has requested reading a solution from the file.  If so, we'll need to read
    // the mesh with the exodus reader instead of using mesh.read().  This will read the mesh on
    // every processor

    if (_app.setFileRestart() &amp;&amp; (_file_name.rfind(&quot;.exd&quot;) &lt; _file_name.size() ||
                                  _file_name.rfind(&quot;.e&quot;) &lt; _file_name.size()))
    {
      MooseUtils::checkFileReadable(_file_name);

      _exreader = libmesh_make_unique&lt;ExodusII_IO&gt;(getMesh());
      _exreader-&gt;read(_file_name);

      getMesh().allow_renumbering(false);
      getMesh().prepare_for_use();
    }
    else
    {
      auto slash_pos = _file_name.find_last_of(&quot;/&quot;);
      auto path = _file_name.substr(0, slash_pos);
      auto file = _file_name.substr(slash_pos + 1);

      bool restarting;
      // If we are reading a mesh while restarting, then we might have
      // a solution file that relies on that mesh partitioning and/or
      // numbering.  In that case, we need to turn off repartitioning
      // and renumbering, at least at first.
      if (file == &quot;LATEST&quot;)
      {
        std::list&lt;std::string&gt; files = MooseUtils::listDir(path);

        // Fill in the name of the LATEST file so we can open it and read it.
        _file_name = MooseUtils::getLatestMeshCheckpointFile(files);
        restarting = true;
      }
      else
        restarting = _file_name.rfind(&quot;.cpa&quot;) &lt; _file_name.size() ||
                     _file_name.rfind(&quot;.cpr&quot;) &lt; _file_name.size();

      const bool skip_partitioning_later = restarting &amp;&amp; getMesh().skip_partitioning();
      const bool allow_renumbering_later = restarting &amp;&amp; getMesh().allow_renumbering();

      if (restarting)
      {
        getMesh().skip_partitioning(true);
        getMesh().allow_renumbering(false);
      }

      if (!MooseUtils::pathExists(_file_name))
        mooseError(&quot;cannot locate mesh file '&quot;, _file_name, &quot;'&quot;);
      getMesh().read(_file_name);

      if (restarting)
      {
        getMesh().allow_renumbering(allow_renumbering_later);
        getMesh().skip_partitioning(skip_partitioning_later);
      }
    }
  }

  Moose::perf_log.pop(&quot;Read Mesh&quot;, &quot;Setup&quot;);
}

void
FileMesh::read(const std::string &amp; file_name)
{
  if (dynamic_cast&lt;DistributedMesh *&gt;(&amp;getMesh()) &amp;&amp; !_is_nemesis)
    getMesh().read(file_name, /*mesh_data=*/NULL, /*skip_renumber=*/false);
  else
    getMesh().read(file_name, /*mesh_data=*/NULL, /*skip_renumber=*/true);
}
</code></pre></div></div></body></html>