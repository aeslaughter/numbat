<!DOCTYPE html><html><head><meta charset="UTF-8"><link media="screen,projection" href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><script src="../../contrib/jquery/jquery.min.js" type="text/javascript"></script><script src="../../contrib/materialize/materialize.min.js" type="text/javascript"></script><script src="../../contrib/clipboard/clipboard.min.js" type="text/javascript"></script><script src="../../contrib/prism/prism.min.js" type="text/javascript"></script><script src="../../contrib/katex/katex.min.js" type="text/javascript"></script><script src="../../contrib/fuse/fuse.min.js" type="text/javascript"></script><script src="../../js/search_index.js" type="text/javascript"></script><script src="../../js/init.js" type="text/javascript"></script><title>NumbatBiasedMesh|Numbat</title><script src="../../contrib/plotly/plotly.min.js" type="text/javascript"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://github.com/cpgr/numbat" class="right"><img src="../../media/github-logo.png" class="github-mark"></img><img src="../../media/github-mark.png" class="github-logo"></img></a><a href="http://cpgr.github.io/numbat/" class="left moose-logo">Numbat</a><ul class="right hide-on-med-and-down" id="nav-mobile"><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="c07b1583-6498-44e3-8bb6-6800428d6f31">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="7225ce23-6141-4be8-bcc5-40addd597472">Theory<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="dbf7889b-eba0-48f1-91bb-c11e2e8e135d">Details<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="999e55a2-3ae6-421a-8136-4832947937c3">Examples<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="2c19374e-62a8-4ce2-8fd1-277c32ba299d">Manual<i class="material-icons right">arrow_drop_down</i></a></li></ul><ul class="dropdown-content" id="c07b1583-6498-44e3-8bb6-6800428d6f31"><li><a href="../../getting_started.html">Installation</a></li><li><a href="../../contributing.html">Contributing</a></li></ul><ul class="dropdown-content" id="7225ce23-6141-4be8-bcc5-40addd597472"><li><a href="../../introduction.html">Introduction</a></li><li><a href="../../governing_equations.html">Governing equations</a></li></ul><ul class="dropdown-content" id="dbf7889b-eba0-48f1-91bb-c11e2e8e135d"><li><a href="../../implementation.html">Implementation</a></li><li><a href="../../input_file_syntax.html">Input file syntax</a></li><li><a href="../../running_numbat.html">Running Numbat</a></li><li><a href="../../systems.html">Available objects</a></li></ul><ul class="dropdown-content" id="999e55a2-3ae6-421a-8136-4832947937c3"><li><a href="../../example2D.html">2D</a></li><li><a href="../../example3D.html">3D</a></li></ul><ul class="dropdown-content" id="2c19374e-62a8-4ce2-8fd1-277c32ba299d"><li><a href="../../download.html">User manual</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input autocomplete="off" onkeyup="mooseSearch()" type="text" id="moose-search-box"><label for="search">http://cpgr.github.io/numbat/</label></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-action modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">source</a><span class="breadcrumb">mesh</span><a href="NumbatBiasedMesh.html" class="breadcrumb">NumbatBiasedMesh</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section data-section-text="NumbatBiasedMesh" data-section-level="1" id="43848a43-e46d-4bfd-ad11-187037475d2a"><h1>NumbatBiasedMesh</h1><p>Generates a regular orthogonal mesh with a bias of specified initial resolution at a specified edge</p><p>NumbatBiasedMesh produces a generated mesh with a specified refinement at one edge so that the first element has a width (height) specified using the <code>refined_resolution</code> input parameter.</p><p>Each subsequent element increases in width (height) away from the boundary by a fixed increment <span class="moose-katex-inline-equation" id="moose-equation-9966caa1-2c42-4bc4-ad36-8bb3c7821a7a"><script>var element = document.getElementById("moose-equation-9966caa1-2c42-4bc4-ad36-8bb3c7821a7a");katex.render("\\delta", element, {displayMode:false,throwOnError:false});</script></span>, so that <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-2dc906f1-fc1b-4d19-83b9-e4e675807f06"></span><span class="moose-katex-equation-number">(1)</span><script>var element = document.getElementById("moose-equation-2dc906f1-fc1b-4d19-83b9-e4e675807f06");katex.render("x_{i+1} = x_i + \\delta,", element, {displayMode:true,throwOnError:false});</script></span> where the increment <span class="moose-katex-inline-equation" id="moose-equation-ed126dea-5ce8-4b40-943b-bad5cc89b16c"><script>var element = document.getElementById("moose-equation-ed126dea-5ce8-4b40-943b-bad5cc89b16c");katex.render("\\delta", element, {displayMode:false,throwOnError:false});</script></span> is calculated so that the dimensions of the mesh are unchanged.</p><p><a class="tooltipped" href="#fig:biased_mesh" data-tooltip="#fig:biased_mesh" data-position="top">Figure 1</a> demonstrates the effect of refinement on a simple two-dimensional mesh, where the elements are biased to the top of the mesh.</p><div style="width:20%;margin-left:10px" id="fig:biased_mesh" class="card"><div class="card-image"><img src="../../media/biased_mesh.png" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-heading">Figure 1: </span><span class="moose-caption-text">2D biased mesh</span></p></div></div><section class="scrollspy" data-section-text="Input   Parameters" data-section-level="2" id="900a3626-be10-44f3-b553-a323a35215a9"><h2>Input Parameters</h2><section data-details-open="open" data-section-text="Optional Parameters" data-section-level="3" id="597d1326-3b04-4d0a-9865-9cbd6d486bb1"><details open="open" class="moose-section-content"><ul data-collapsible="expandable" class="collapsible"><li><div class="collapsible-header"><span class="moose-parameter-name">zmax</span><span class="moose-parameter-header-default">1</span><span class="moose-parameter-header-description">Upper Z Coordinate of the generated mesh</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>1</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>double</p><p class="moose-parameter-description"><span>Description:</span>Upper Z Coordinate of the generated mesh</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">elem_type</span><span class="moose-parameter-header-description">The type of element from libMesh to generate (default: linear element for requested dimension)</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MooseEnum</p><p class="moose-parameter-description"><span>Description:</span>The type of element from libMesh to generate (default: linear element for requested dimension)</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">zmin</span><span class="moose-parameter-header-default">0</span><span class="moose-parameter-header-description">Lower Z Coordinate of the generated mesh</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>0</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>double</p><p class="moose-parameter-description"><span>Description:</span>Lower Z Coordinate of the generated mesh</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">allow_renumbering</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">If allow_renumbering=false, node and element numbers are kept fixed until deletion</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description"><span>Description:</span>If allow_renumbering=false, node and element numbers are kept fixed until deletion</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">nz</span><span class="moose-parameter-header-default">1</span><span class="moose-parameter-header-description">Number of elements in the Z direction</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>1</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>unsigned int</p><p class="moose-parameter-description"><span>Description:</span>Number of elements in the Z direction</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">nx</span><span class="moose-parameter-header-default">1</span><span class="moose-parameter-header-description">Number of elements in the X direction</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>1</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>unsigned int</p><p class="moose-parameter-description"><span>Description:</span>Number of elements in the X direction</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">ny</span><span class="moose-parameter-header-default">1</span><span class="moose-parameter-header-description">Number of elements in the Y direction</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>1</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>unsigned int</p><p class="moose-parameter-description"><span>Description:</span>Number of elements in the Y direction</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">gauss_lobatto_grid</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">Grade mesh into boundaries according to Gauss-Lobatto quadrature spacing.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description"><span>Description:</span>Grade mesh into boundaries according to Gauss-Lobatto quadrature spacing.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">refined_edge</span><span class="moose-parameter-header-default">top</span><span class="moose-parameter-header-description">The edge where the refinement should occur</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>top</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MooseEnum</p><p class="moose-parameter-description"><span>Description:</span>The edge where the refinement should occur</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">parallel_type</span><span class="moose-parameter-header-default">DEFAULT</span><span class="moose-parameter-header-description">DISTRIBUTED: Always use libMesh::DistributedMesh REPLICATED: Always use libMesh::ReplicatedMesh DEFAULT: Use libMesh::ReplicatedMesh unless --distributed-mesh is specified on the command line</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>DEFAULT</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MooseEnum</p><p class="moose-parameter-description"><span>Description:</span>DISTRIBUTED: Always use libMesh::DistributedMesh REPLICATED: Always use libMesh::ReplicatedMesh DEFAULT: Use libMesh::ReplicatedMesh unless --distributed-mesh is specified on the command line</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">xmax</span><span class="moose-parameter-header-default">1</span><span class="moose-parameter-header-description">Upper X Coordinate of the generated mesh</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>1</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>double</p><p class="moose-parameter-description"><span>Description:</span>Upper X Coordinate of the generated mesh</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">ghosting_patch_size</span><span class="moose-parameter-header-description">The number of nearest neighbors considered for ghosting purposes when 'iteration' patch update strategy is used. Default is 5 * patch_size.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>unsigned int</p><p class="moose-parameter-description"><span>Description:</span>The number of nearest neighbors considered for ghosting purposes when 'iteration' patch update strategy is used. Default is 5 * patch_size.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">xmin</span><span class="moose-parameter-header-default">0</span><span class="moose-parameter-header-description">Lower X Coordinate of the generated mesh</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>0</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>double</p><p class="moose-parameter-description"><span>Description:</span>Lower X Coordinate of the generated mesh</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">ymin</span><span class="moose-parameter-header-default">0</span><span class="moose-parameter-header-description">Lower Y Coordinate of the generated mesh</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>0</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>double</p><p class="moose-parameter-description"><span>Description:</span>Lower Y Coordinate of the generated mesh</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">refined_resolution</span><span class="moose-parameter-header-default">1</span><span class="moose-parameter-header-description">The resolution of the first element at the refined edge</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>1</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>double</p><p class="moose-parameter-description"><span>Description:</span>The resolution of the first element at the refined edge</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">max_leaf_size</span><span class="moose-parameter-header-default">10</span><span class="moose-parameter-header-description">The maximum number of points in each leaf of the KDTree used in the nearest neighbor search. As the leaf size becomes larger,KDTree construction becomes faster but the nearest neighbor searchbecomes slower.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>10</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>unsigned int</p><p class="moose-parameter-description"><span>Description:</span>The maximum number of points in each leaf of the KDTree used in the nearest neighbor search. As the leaf size becomes larger,KDTree construction becomes faster but the nearest neighbor searchbecomes slower.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">ymax</span><span class="moose-parameter-header-default">1</span><span class="moose-parameter-header-description">Upper Y Coordinate of the generated mesh</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>1</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>double</p><p class="moose-parameter-description"><span>Description:</span>Upper Y Coordinate of the generated mesh</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Optional Parameters</h3></summary></details></section><section data-details-open="close" data-section-text="Partitioning Parameters" data-section-level="3" id="bc762ed1-44b1-478c-b097-ac2a7dcf447a"><details class="moose-section-content"><ul data-collapsible="expandable" class="collapsible"><li><div class="collapsible-header"><span class="moose-parameter-name">partitioner</span><span class="moose-parameter-header-default">default</span><span class="moose-parameter-header-description">Specifies a mesh partitioner to use when splitting the mesh for a parallel computation.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>default</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MooseEnum</p><p class="moose-parameter-description"><span>Description:</span>Specifies a mesh partitioner to use when splitting the mesh for a parallel computation.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">centroid_partitioner_direction</span><span class="moose-parameter-header-description">Specifies the sort direction if using the centroid partitioner. Available options: x, y, z, radial</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MooseEnum</p><p class="moose-parameter-description"><span>Description:</span>Specifies the sort direction if using the centroid partitioner. Available options: x, y, z, radial</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Partitioning Parameters</h3></summary></details></section><section data-details-open="close" data-section-text="Advanced Parameters" data-section-level="3" id="452b7e6e-a1c7-4bfb-988b-a0c143e7a209"><details class="moose-section-content"><ul data-collapsible="expandable" class="collapsible"><li><div class="collapsible-header"><span class="moose-parameter-name">enable</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Set the enabled status of the MooseObject.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description"><span>Description:</span>Set the enabled status of the MooseObject.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">patch_update_strategy</span><span class="moose-parameter-header-default">never</span><span class="moose-parameter-header-description">How often to update the geometric search 'patch'.  The default is to never update it (which is the most efficient but could be a problem with lots of relative motion). 'always' will update the patch for all slave nodes at the beginning of every timestep which might be time consuming. 'auto' will attempt to determine at the start of which timesteps the patch for all slave nodes needs to be updated automatically.'iteration' updates the patch at every nonlinear iteration for a subset of slave nodes for which penetration is not detected. If there can be substantial relative motion between the master and slave surfaces during the nonlinear iterations within a timestep, it is advisable to use 'iteration' option to ensure accurate contact detection.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>never</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MooseEnum</p><p class="moose-parameter-description"><span>Description:</span>How often to update the geometric search 'patch'.  The default is to never update it (which is the most efficient but could be a problem with lots of relative motion). 'always' will update the patch for all slave nodes at the beginning of every timestep which might be time consuming. 'auto' will attempt to determine at the start of which timesteps the patch for all slave nodes needs to be updated automatically.'iteration' updates the patch at every nonlinear iteration for a subset of slave nodes for which penetration is not detected. If there can be substantial relative motion between the master and slave surfaces during the nonlinear iterations within a timestep, it is advisable to use 'iteration' option to ensure accurate contact detection.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">control_tags</span><span class="moose-parameter-header-description">Adds user-defined labels for accessing object parameters via control logic.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<std::string></p><p class="moose-parameter-description"><span>Description:</span>Adds user-defined labels for accessing object parameters via control logic.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">nemesis</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">If nemesis=true and file=foo.e, actually reads foo.e.N.0, foo.e.N.1, ... foo.e.N.N-1, where N = # CPUs, with NemesisIO.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description"><span>Description:</span>If nemesis=true and file=foo.e, actually reads foo.e.N.0, foo.e.N.1, ... foo.e.N.N-1, where N = # CPUs, with NemesisIO.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">construct_node_list_from_side_list</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Whether or not to generate nodesets from the sidesets (usually a good idea).</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description"><span>Description:</span>Whether or not to generate nodesets from the sidesets (usually a good idea).</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">patch_size</span><span class="moose-parameter-header-default">40</span><span class="moose-parameter-header-description">The number of nodes to consider in the NearestNode neighborhood.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>40</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>unsigned int</p><p class="moose-parameter-description"><span>Description:</span>The number of nodes to consider in the NearestNode neighborhood.</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Advanced Parameters</h3></summary></details></section><section data-details-open="close" data-section-text="Main Parameters" data-section-level="3" id="1dbc0e63-3f28-4e06-a96b-64331637b725"><details class="moose-section-content"><ul data-collapsible="expandable" class="collapsible"><li><div class="collapsible-header"><span class="moose-parameter-name">dim</span><span class="moose-parameter-header-description">The dimension of the mesh to be generated</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MooseEnum</p><p class="moose-parameter-description"><span>Description:</span>The dimension of the mesh to be generated</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Main Parameters</h3></summary></details></section></section><section class="scrollspy" data-section-text="Input   Files" data-section-level="2" id="f4d6d2dc-aed5-4b5b-9401-99d41247a258"><h2>Input Files</h2><ul class="moose-list-inputs browser-default"><li><a data-position="top" href="#7be1010a-4be6-4cf7-80ce-21d28a7a2279" class="tooltipped modal-trigger" data-tooltip="tests/3D/3DSF.i">tests/3D/3DSF.i</a></li><li><a data-position="top" href="#26e6574f-be0f-4b67-87df-cc4515df6985" class="tooltipped modal-trigger" data-tooltip="tests/mesh/2D_left.i">tests/mesh/2D_left.i</a></li><li><a data-position="top" href="#d9a6e857-4af7-4802-86b1-c7edb8f3c5e7" class="tooltipped modal-trigger" data-tooltip="tests/3D/3D_action.i">tests/3D/3D_action.i</a></li><li><a data-position="top" href="#c635302e-7dde-4361-a849-cf10491baa71" class="tooltipped modal-trigger" data-tooltip="tests/mesh/2D_top.i">tests/mesh/2D_top.i</a></li><li><a data-position="top" href="#0f3c6299-bff6-41a3-95c7-e7878256a659" class="tooltipped modal-trigger" data-tooltip="examples/3D/isotropic/3Dddc.i">examples/3D/isotropic/3Dddc.i</a></li><li><a data-position="top" href="#f86c8d28-3363-4f5e-80e3-a8d17949ea54" class="tooltipped modal-trigger" data-tooltip="tests/mesh/3D_bottom.i">tests/mesh/3D_bottom.i</a></li><li><a data-position="top" href="#ddba4ee9-17f6-478c-b60c-9d2953d1a9e7" class="tooltipped modal-trigger" data-tooltip="examples/3D/isotropic/3DddcSF.i">examples/3D/isotropic/3DddcSF.i</a></li><li><a data-position="top" href="#e36475ab-1702-4211-b6b0-e4307d813de8" class="tooltipped modal-trigger" data-tooltip="examples/inputfiles/2D.i">examples/inputfiles/2D.i</a></li><li><a data-position="top" href="#5656f7d1-4016-4854-8290-9fbcd989890a" class="tooltipped modal-trigger" data-tooltip="tests/mesh/2D_bottom_second_order.i">tests/mesh/2D_bottom_second_order.i</a></li><li><a data-position="top" href="#ef1d9f94-e1d4-4150-9104-7ce223741514" class="tooltipped modal-trigger" data-tooltip="examples/inputfiles/3D.i">examples/inputfiles/3D.i</a></li><li><a data-position="top" href="#e9236a37-3e35-468b-80a7-bf58946e5831" class="tooltipped modal-trigger" data-tooltip="tests/mesh/2D_bottom.i">tests/mesh/2D_bottom.i</a></li><li><a data-position="top" href="#eff69a9f-d295-4410-baf1-b9c4149c9e33" class="tooltipped modal-trigger" data-tooltip="tests/mesh/2D_edge_error.i">tests/mesh/2D_edge_error.i</a></li><li><a data-position="top" href="#85e95896-b7d9-44d6-8d81-02b94893e3e2" class="tooltipped modal-trigger" data-tooltip="tests/mesh/2D_right.i">tests/mesh/2D_right.i</a></li><li><a data-position="top" href="#e13e02ed-e87f-4bea-ba88-39e45d1a43d8" class="tooltipped modal-trigger" data-tooltip="examples/2D/anisotropic/2Dddc.i">examples/2D/anisotropic/2Dddc.i</a></li><li><a data-position="top" href="#cbd31670-7dd3-4c02-832e-45bd1878be39" class="tooltipped modal-trigger" data-tooltip="tests/3D/3DSF_anisotropic.i">tests/3D/3DSF_anisotropic.i</a></li><li><a data-position="top" href="#c00bf8b1-6a4d-4edd-aaa6-baf5986d35af" class="tooltipped modal-trigger" data-tooltip="tests/actions/3DSF.i">tests/actions/3DSF.i</a></li><li><a data-position="top" href="#c54c5d8d-80e1-4611-bdb9-bb056bca741a" class="tooltipped modal-trigger" data-tooltip="tests/3D/3DSF_anisotropic_action.i">tests/3D/3DSF_anisotropic_action.i</a></li><li><a data-position="top" href="#3bd688a4-280f-4534-9686-8676a91f1fc8" class="tooltipped modal-trigger" data-tooltip="tests/mesh/3D_top.i">tests/mesh/3D_top.i</a></li><li><a data-position="top" href="#6b955971-0504-4553-b7a1-8418e4c796be" class="tooltipped modal-trigger" data-tooltip="examples/3D/pseudo2D/3Dddcp.i">examples/3D/pseudo2D/3Dddcp.i</a></li><li><a data-position="top" href="#aa45bf22-106d-401b-a60c-433c9f230161" class="tooltipped modal-trigger" data-tooltip="examples/2D/isotropic/2DddcSF.i">examples/2D/isotropic/2DddcSF.i</a></li><li><a data-position="top" href="#4948a492-9faa-4171-a442-c3f0bbc31085" class="tooltipped modal-trigger" data-tooltip="tests/3D/3DSF_action.i">tests/3D/3DSF_action.i</a></li><li><a data-position="top" href="#f76b734e-5bec-4828-8ca7-e85ae295198a" class="tooltipped modal-trigger" data-tooltip="tests/mesh/2D_top_second_order.i">tests/mesh/2D_top_second_order.i</a></li><li><a data-position="top" href="#c21abfa0-63d4-4d6f-867b-708127f00ac8" class="tooltipped modal-trigger" data-tooltip="tests/3D/3D.i">tests/3D/3D.i</a></li><li><a data-position="top" href="#cb3d0673-2d6b-4c55-ba6d-ee315a291350" class="tooltipped modal-trigger" data-tooltip="examples/2D/isotropic/2Dddc.i">examples/2D/isotropic/2Dddc.i</a></li><li><a data-position="top" href="#26ed80a2-0c53-47e5-8a12-2fb655a686c2" class="tooltipped modal-trigger" data-tooltip="examples/2D/anisotropic/2DddcSF.i">examples/2D/anisotropic/2DddcSF.i</a></li><li><a data-position="top" href="#edd3175a-a27d-49e1-ba62-cb7a495dd6d0" class="tooltipped modal-trigger" data-tooltip="tests/actions/3D.i">tests/actions/3D.i</a></li></ul></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a data-delay="1000" data-position="left" href="#900a3626-be10-44f3-b553-a323a35215a9" class="tooltipped" data-tooltip="Input   Parameters">Input   Parameters</a></li><li><a data-delay="1000" data-position="left" href="#f4d6d2dc-aed5-4b5b-9401-99d41247a258" class="tooltipped" data-tooltip="Input   Files">Input   Files</a></li></ul></div></div></div></div></main></div><div id="7be1010a-4be6-4cf7-80ce-21d28a7a2279" class="modal bottom-sheet"><div class="modal-content"><h4>tests/3D/3DSF.i</h4><pre><code class="language-text">[Mesh]
  type = NumbatBiasedMesh
  dim = 3
  xmax = 10
  ymax = 10
  zmin = -100
  zmax = 0
  nx = 1
  ny = 1
  nz = 10
  refined_edge = top
  refined_resolution = 1
[]

[Variables]
  [./concentration]
    order = FIRST
    family = LAGRANGE
  [../]
  [./streamfunctionx]
    order = FIRST
    family = LAGRANGE
    initial_condition = 0.0
  [../]
  [./streamfunctiony]
    order = FIRST
    family = LAGRANGE
    initial_condition = 0.0
  [../]
[]

[Kernels]
  [./Darcy_x]
    type = NumbatDarcySF
    variable = streamfunctionx
    concentration = concentration
    component = x
  [../]
  [./Darcy_y]
    type = NumbatDarcySF
    variable = streamfunctiony
    concentration = concentration
    component = y
  [../]
  [./Convection]
    type = NumbatConvectionSF
    variable = concentration
    streamfunction = 'streamfunctionx streamfunctiony'
  [../]
  [./Diffusion]
    type = NumbatDiffusionSF
    variable = concentration
  [../]
  [./TimeDerivative]
    type = TimeDerivative
    variable = concentration
  [../]
[]

[AuxVariables]
  [./u]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./v]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./w]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./uAux]
    type = NumbatDarcyVelocitySF
    variable = u
    component = x
    streamfunction = 'streamfunctionx streamfunctiony'
  [../]
  [./vAux]
    type = NumbatDarcyVelocitySF
    variable = v
    component = y
    streamfunction = 'streamfunctionx streamfunctiony'
  [../]
  [./wAux]
    type = NumbatDarcyVelocitySF
    variable = w
    component = z
    streamfunction = 'streamfunctionx streamfunctiony'
  [../]
[]

[BCs]
  [./conctop]
    type = DirichletBC
    variable = concentration
    boundary = top
    value = 1.0
  [../]
  [./streamfunxtop]
    type = DirichletBC
    variable = streamfunctionx
    boundary = top
    value = 0.0
  [../]
  [./streamfunxbottom]
    type = DirichletBC
    variable = streamfunctionx
    boundary = bottom
    value = 0.0
  [../]
  [./streamfunytop]
    type = DirichletBC
    variable = streamfunctiony
    boundary = top
    value = 0.0
  [../]
  [./streamfunybottom]
    type = DirichletBC
    variable = streamfunctiony
    boundary = bottom
    value = 0.0
  [../]
  [./Periodic]
    [./xy]
      variable = 'concentration streamfunctionx streamfunctiony'
      auto_direction = 'x y'
    [../]
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  end_time = 100
  solve_type = PJFNK
[]

[Postprocessors]
  [./boundary_flux]
    type = NumbatSideFluxSF
    variable = concentration
    boundary = top
  [../]
  [./total_mass]
    type = NumbatTotalMassSF
    variable = concentration
  [../]
[]

[Outputs]
  perf_graph = true
  [./csvoutput]
    type = CSV
    file_base = 3DSF
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]
</code></pre></div></div><div id="26e6574f-be0f-4b67-87df-cc4515df6985" class="modal bottom-sheet"><div class="modal-content"><h4>tests/mesh/2D_left.i</h4><pre><code class="language-text">[Mesh]
  type = NumbatBiasedMesh
  dim = 2
  nx = 10
  xmax = 10
  refined_edge = left
  refined_resolution = 0.1
[]

[Variables]
  [./concentration]
    initial_condition = 0
  [../]
[]

[Kernels]
  [./diffusion]
    type = Diffusion
    variable = concentration
  [../]
[]

[BCs]
  [./concleft]
    type = DirichletBC
    variable = concentration
    boundary = left
    value = 1.0
  [../]
  [./concright]
    type = DirichletBC
    variable = concentration
    boundary = right
    value = 0
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Steady
  nl_rel_tol = 1e-12
[]

[VectorPostprocessors]
  [./conc]
    type = NodalValueSampler
    variable = concentration
    sort_by = id
  [../]
[]

[Outputs]
  execute_on = TIMESTEP_END
  csv = true
  file_base = 2D_left
[]
</code></pre></div></div><div id="d9a6e857-4af7-4802-86b1-c7edb8f3c5e7" class="modal bottom-sheet"><div class="modal-content"><h4>tests/3D/3D_action.i</h4><pre><code class="language-text">[Mesh]
  type = NumbatBiasedMesh
  dim = 3
  xmax = 10
  ymax = 10
  zmin = -100
  zmax = 0
  nx = 1
  ny = 1
  nz = 50
  refined_edge = top
  refined_resolution = 1
[]

[Numbat]
  [./Dimensional]
  [../]
[]

[ICs]
  [./concentration]
    type = ConstantIC
    variable = concentration
    value = 0
  [../]
  [./pressure]
    type = ConstantIC
    variable = pressure
    value = 1e6
  [../]
[]

[Materials]
  [./porosity]
    type = NumbatPorosity
    porosity = 0.2
  [../]
  [./permeability]
    type = NumbatPermeability
    permeability = '1e-12 0 0 0 1e-12 0 0 0 1e-12'
  [../]
  [./diffusivity]
    type = NumbatDiffusivity
    diffusivity = 1e-3
  [../]
  [./density]
    type = NumbatDensity
    concentration = concentration
    zero_density = 1000
    delta_density = 10
  [../]
  [./viscosity]
    type = NumbatViscosity
    viscosity = 1e-3
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  end_time = 50
  dt = 10
  solve_type = NEWTON
  petsc_options_iname = '-ksp_type -pc_type -pc_sub_type'
  petsc_options_value = 'gmres hypre lu'
[]

[Outputs]
  execute_on = TIMESTEP_END
  csv = true
  file_base = 3D
  perf_graph = true
[]
</code></pre></div></div><div id="c635302e-7dde-4361-a849-cf10491baa71" class="modal bottom-sheet"><div class="modal-content"><h4>tests/mesh/2D_top.i</h4><pre><code class="language-text">[Mesh]
  type = NumbatBiasedMesh
  dim = 2
  ny = 10
  ymax = 10
  refined_edge = top
  refined_resolution = 0.1
[]

[Variables]
  [./concentration]
    initial_condition = 0
  [../]
[]

[Kernels]
  [./diffusion]
    type = Diffusion
    variable = concentration
  [../]
[]

[BCs]
  [./conctop]
    type = DirichletBC
    variable = concentration
    boundary = top
    value = 1.0
  [../]
  [./concbottom]
    type = DirichletBC
    variable = concentration
    boundary = bottom
    value = 0.0
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  end_time = 1
  solve_type = NEWTON
[]

[VectorPostprocessors]
  [./conc]
    type = NodalValueSampler
    variable = concentration
    sort_by = id
  [../]
[]

[Outputs]
  execute_on = TIMESTEP_END
  csv = true
  file_base = 2D_top
[]
</code></pre></div></div><div id="0f3c6299-bff6-41a3-95c7-e7878256a659" class="modal bottom-sheet"><div class="modal-content"><h4>examples/3D/isotropic/3Dddc.i</h4><pre><code class="language-text"># 3D density-driven convective mixing. Instability is seeded by small perturbation
# to porosity. Don't try this on a laptop!

[Mesh]
  type = NumbatBiasedMesh
  dim = 3
  zmax = 1.5
  nx = 20
  ny = 20
  nz = 500
  refined_edge = front
  refined_resolution = 0.001
[]

[Numbat]
  [./Dimensional]
    concentration_scaling = 1e6
    boundary_concentration = 0.049306
    periodic_bcs = true
  [../]
[]

[AuxVariables]
  [./noise]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[ICs]
  [./noise]
    type = RandomIC
    variable = noise
    max = 0.003
    min = -0.003
  [../]
  [./pressure]
    type = ConstantIC
    variable = pressure
    value = 1e6
  [../]
[]

[Materials]
  [./porosity]
    type = NumbatPorosity
    porosity = 0.3
    noise = noise
  [../]
  [./permeability]
    type = NumbatPermeability
    permeability = '1e-11 0 0 0 1e-11 0 0 0 1e-11'
  [../]
  [./diffusivity]
    type = NumbatDiffusivity
    diffusivity = 2e-9
  [../]
  [./density]
    type = NumbatDensity
    concentration = concentration
    zero_density = 995
    delta_density = 10.5
    saturated_concentration = 0.049306
  [../]
  [./viscosity]
    type = NumbatViscosity
    viscosity = 6e-4
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  l_max_its = 200
  end_time = 3e5
  solve_type = NEWTON
  petsc_options = -ksp_snes_ew
  petsc_options_iname = '-pc_type -sub_pc_type -ksp_atol -pc_asm_overlap'
  petsc_options_value = 'asm ilu 1e-12 4'
  nl_abs_tol = 1e-10
  nl_max_its = 25
  dtmax = 2e3
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1
  [../]
[]

[Outputs]
  perf_graph = true
  [./exodus]
    type = Exodus
    file_base = 3Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./csvoutput]
    type = CSV
    file_base = 3Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]
</code></pre></div></div><div id="f86c8d28-3363-4f5e-80e3-a8d17949ea54" class="modal bottom-sheet"><div class="modal-content"><h4>tests/mesh/3D_bottom.i</h4><pre><code class="language-text">[Mesh]
  type = NumbatBiasedMesh
  dim = 3
  nz = 10
  zmax = 10
  refined_edge = bottom
  refined_resolution = 0.1
[]

[Variables]
  [./concentration]
    initial_condition = 0
  [../]
[]

[Kernels]
  [./diffusion]
    type = Diffusion
    variable = concentration
  [../]
[]

[BCs]
  [./conctop]
    type = DirichletBC
    variable = concentration
    boundary = top
    value = 0.0
  [../]
  [./concbottom]
    type = DirichletBC
    variable = concentration
    boundary = bottom
    value = 1.0
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Steady
  nl_rel_tol = 1e-12
  solve_type = NEWTON
[]

[VectorPostprocessors]
  [./conc]
    type = NodalValueSampler
    variable = concentration
    sort_by = id
  [../]
[]

[Outputs]
  execute_on = TIMESTEP_END
  csv = true
  file_base = 3D_bottom
[]
</code></pre></div></div><div id="ddba4ee9-17f6-478c-b60c-9d2953d1a9e7" class="modal bottom-sheet"><div class="modal-content"><h4>examples/3D/isotropic/3DddcSF.i</h4><pre><code class="language-text"># Density-driven convective mixing in a 3D model using the streamfunction
# formulation.
#
# Note: do not run this on a laptop!

[Mesh]
  type = NumbatBiasedMesh
  dim = 3
  xmax = 500
  ymax = 500
  zmin = -200
  zmax = 0
  nx = 40
  ny = 40
  nz = 20
  refined_edge = top
  refined_resolution = 2
[]

[Adaptivity]
  max_h_level = 1
  initial_marker = boxmarker
  initial_steps = 1
  marker = errormarker
  [./Indicators]
    [./gradjumpindicator]
      type = GradientJumpIndicator
      variable = concentration
    [../]
  [../]
  [./Markers]
    [./errormarker]
      type = ErrorToleranceMarker
      refine = 0.05
      indicator = gradjumpindicator
    [../]
    [./boxmarker]
      type = BoxMarker
      bottom_left = '0 0 -10'
      top_right = '500 500 0'
      inside = refine
      outside = dont_mark
    [../]
  [../]
[]

[Numbat]
  [./Dimensionless]
  [../]
[]

[ICs]
  [./concentration]
    type = NumbatPerturbationIC
    variable = concentration
    amplitude = 0.1
    seed = 1
  [../]
  [./streamfunctionx]
    type = ConstantIC
    variable = streamfunction_x
    value = 0.0
  [../]
  [./streamfunctiony]
    type = ConstantIC
    variable = streamfunction_y
    value = 0.0
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  dtmax = 100
  end_time = 2500
  start_time = 1
  solve_type = NEWTON
  petsc_options = -snes_ksp_ew
  petsc_options_iname = '-pc_type -sub_pc_type -ksp_atol -pc_asm_overlap'
  petsc_options_value = 'asm ilu 1e-12 4'
  nl_abs_tol = 1e-10
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1
    cutback_factor = 0.5
    growth_factor = 2
  [../]
[]

[Postprocessors]
  [./numdofs]
    type = NumDOFs
  [../]
[]

[Outputs]
  perf_graph = true
  [./exodus]
    type = Exodus
    file_base = 3DddcSF
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./csvoutput]
    type = CSV
    file_base = 3DddcSF
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]
</code></pre></div></div><div id="e36475ab-1702-4211-b6b0-e4307d813de8" class="modal bottom-sheet"><div class="modal-content"><h4>examples/inputfiles/2D.i</h4><pre><code class="language-text"># Sample input file for 2D density-driven convective mixing
# Note: this input file is primarily used to generate documentation
# PLEASE DO NOT ALTER THIS FILE

[Mesh]
  type = NumbatBiasedMesh
  dim = 2
  ymax = 1.5
  nx = 100
  ny = 50
  refined_edge = top
  refined_resolution = 0.001
[]

[Variables]
  [./concentration]
    initial_condition = 0
    scaling = 1e6
  [../]
  [./pressure]
    initial_condition = 1e6
  [../]
[]

[AuxVariables]
  [./noise]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[ICs]
  [./noise]
    type = RandomIC
    variable = noise
    max = 0.003
    min = -0.003
  [../]
[]

[Materials]
  [./porosity]
    type = NumbatPorosity
    porosity = 0.3
    noise = noise
  [../]
  [./permeability]
    type = NumbatPermeability
    permeability = '1e-11 0 0 0 1e-11 0 0 0 1e-11'
  [../]
  [./diffusivity]
    type = NumbatDiffusivity
    diffusivity = 2e-9
  [../]
  [./density]
    type = NumbatDensity
    concentration = concentration
    zero_density = 995
    delta_density = 10.5
    saturated_concentration = 0.049306
  [../]
  [./viscosity]
    type = NumbatViscosity
    viscosity = 6e-4
  [../]
[]

[Kernels]
  [./time]
    type = NumbatTimeDerivative
    variable = concentration
  [../]
  [./diffusion]
    type = NumbatDiffusion
    variable = concentration
  [../]
  [./convection]
    type = NumbatConvection
    variable = concentration
    pressure = pressure
  [../]
  [./darcy]
    type = NumbatDarcy
    variable = pressure
    concentration = concentration
  [../]
[]

[BCs]
  [./conctop]
    type = PresetBC
    variable = concentration
    boundary = top
    value = 0.049306
  [../]
  [./Periodic]
    [./x]
      variable = concentration
      auto_direction = x
    [../]
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  l_max_its = 200
  end_time = 3e5
  solve_type = NEWTON
  petsc_options = -ksp_snes_ew
  petsc_options_iname = '-pc_type -sub_pc_type -ksp_atol'
  petsc_options_value = 'bjacobi ilu 1e-12'
  nl_abs_tol = 1e-10
  nl_max_its = 25
  dtmax = 2e3
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1
  [../]
[]

[Postprocessors]
  [./boundaryfluxint]
    type = NumbatSideFlux
    variable = concentration
    boundary = top
  [../]
  [./mass]
    type = NumbatTotalMass
    variable = concentration
  [../]
[]

[Outputs]
  perf_graph = true
  [./exodus]
    type = Exodus
    file_base = 2Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./csvoutput]
    type = CSV
    file_base = 2Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]
</code></pre></div></div><div id="5656f7d1-4016-4854-8290-9fbcd989890a" class="modal bottom-sheet"><div class="modal-content"><h4>tests/mesh/2D_bottom_second_order.i</h4><pre><code class="language-text">[Mesh]
  type = NumbatBiasedMesh
  dim = 2
  ny = 10
  ymax = 10
  elem_type = QUAD9
  refined_edge = bottom
  refined_resolution = 0.1
[]

[Variables]
  [./concentration]
    initial_condition = 0
  [../]
[]

[Kernels]
  [./diffusion]
    type = Diffusion
    variable = concentration
  [../]
[]

[BCs]
  [./conctop]
    type = DirichletBC
    variable = concentration
    boundary = top
    value = 0.0
  [../]
  [./concbottom]
    type = DirichletBC
    variable = concentration
    boundary = bottom
    value = 1.0
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Steady
  nl_rel_tol = 1e-12
  solve_type = NEWTON
[]

[VectorPostprocessors]
  [./conc]
    type = NodalValueSampler
    variable = concentration
    sort_by = id
  [../]
[]

[Outputs]
  execute_on = TIMESTEP_END
  csv = true
  file_base = 2D_bottom_second_order
[]
</code></pre></div></div><div id="ef1d9f94-e1d4-4150-9104-7ce223741514" class="modal bottom-sheet"><div class="modal-content"><h4>examples/inputfiles/3D.i</h4><pre><code class="language-text"># Sample input file for 3D density-driven convective mixing
# Note: this input file is primarily used to generate documentation
# PLEASE DO NOT ALTER THIS FILE

[Mesh]
  type = NumbatBiasedMesh
  dim = 3
  zmax = 1.5
  nx = 20
  ny = 20
  nz = 500
  refined_edge = front
  refined_resolution = 0.001
[]

[Variables]
  [./concentration]
    initial_condition = 0
    scaling = 1e6
  [../]
  [./pressure]
    initial_condition = 1e6
  [../]
[]

[AuxVariables]
  [./noise]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[ICs]
  [./noise]
    type = RandomIC
    variable = noise
    max = 0.003
    min = -0.003
  [../]
[]

[Materials]
  [./porosity]
    type = NumbatPorosity
    porosity = 0.3
    noise = noise
  [../]
  [./permeability]
    type = NumbatPermeability
    permeability = '1e-11 0 0 0 1e-11 0 0 0 1e-11'
  [../]
  [./diffusivity]
    type = NumbatDiffusivity
    diffusivity = 2e-9
  [../]
  [./density]
    type = NumbatDensity
    concentration = concentration
    zero_density = 995
    delta_density = 10.5
    saturated_concentration = 0.049306
  [../]
  [./viscosity]
    type = NumbatViscosity
    viscosity = 6e-4
  [../]
[]

[Kernels]
  [./time]
    type = NumbatTimeDerivative
    variable = concentration
  [../]
  [./diffusion]
    type = NumbatDiffusion
    variable = concentration
  [../]
  [./convection]
    type = NumbatConvection
    variable = concentration
    pressure = pressure
  [../]
  [./darcy]
    type = NumbatDarcy
    variable = pressure
    concentration = concentration
  [../]
[]

[BCs]
  [./conctop]
    type = PresetBC
    variable = concentration
    boundary = front
    value = 0.049306
  [../]
  [./Periodic]
    [./x]
      variable = concentration
      auto_direction = 'x y'
    [../]
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  l_max_its = 200
  end_time = 3e5
  solve_type = NEWTON
  petsc_options = -ksp_snes_ew
  petsc_options_iname = '-pc_type -sub_pc_type -ksp_atol'
  petsc_options_value = 'bjacobi ilu 1e-12'
  nl_abs_tol = 1e-10
  nl_max_its = 25
  dtmax = 2e3
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1
  [../]
[]

[Postprocessors]
  [./boundaryfluxint]
    type = NumbatSideFlux
    variable = concentration
    boundary = top
  [../]
  [./mass]
    type = NumbatTotalMass
    variable = concentration
  [../]
[]

[Outputs]
  perf_graph = true
  [./exodus]
    type = Exodus
    file_base = 3Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./csvoutput]
    type = CSV
    file_base = 3Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]
</code></pre></div></div><div id="e9236a37-3e35-468b-80a7-bf58946e5831" class="modal bottom-sheet"><div class="modal-content"><h4>tests/mesh/2D_bottom.i</h4><pre><code class="language-text">[Mesh]
  type = NumbatBiasedMesh
  dim = 2
  ny = 10
  ymax = 10
  refined_edge = bottom
  refined_resolution = 0.1
[]

[Variables]
  [./concentration]
    initial_condition = 0
  [../]
[]

[Kernels]
  [./diffusion]
    type = Diffusion
    variable = concentration
  [../]
[]

[BCs]
  [./conctop]
    type = DirichletBC
    variable = concentration
    boundary = top
    value = 0.0
  [../]
  [./concbottom]
    type = DirichletBC
    variable = concentration
    boundary = bottom
    value = 1.0
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Steady
  nl_rel_tol = 1e-12
  solve_type = NEWTON
[]

[VectorPostprocessors]
  [./conc]
    type = NodalValueSampler
    variable = concentration
    sort_by = id
  [../]
[]

[Outputs]
  execute_on = TIMESTEP_END
  csv = true
  file_base = 2D_bottom
[]
</code></pre></div></div><div id="eff69a9f-d295-4410-baf1-b9c4149c9e33" class="modal bottom-sheet"><div class="modal-content"><h4>tests/mesh/2D_edge_error.i</h4><pre><code class="language-text">[Mesh]
  type = NumbatBiasedMesh
  dim = 2
  refined_edge = front
[]

[Variables]
  [./concentration]
    initial_condition = 0
  [../]
[]

[Kernels]
  [./diffusion]
    type = Diffusion
    variable = concentration
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  end_time = 1
  solve_type = NEWTON
[]
</code></pre></div></div><div id="85e95896-b7d9-44d6-8d81-02b94893e3e2" class="modal bottom-sheet"><div class="modal-content"><h4>tests/mesh/2D_right.i</h4><pre><code class="language-text">[Mesh]
  type = NumbatBiasedMesh
  dim = 2
  nx = 10
  xmax = 10
  refined_edge = right
  refined_resolution = 0.1
[]

[Variables]
  [./concentration]
    initial_condition = 0
  [../]
[]

[Kernels]
  [./diffusion]
    type = Diffusion
    variable = concentration
  [../]
[]

[BCs]
  [./concleft]
    type = DirichletBC
    variable = concentration
    boundary = left
    value = 0.0
  [../]
  [./concright]
    type = DirichletBC
    variable = concentration
    boundary = right
    value = 1.0
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Steady
  nl_rel_tol = 1e-12
[]

[VectorPostprocessors]
  [./conc]
    type = NodalValueSampler
    variable = concentration
    sort_by = id
  [../]
[]

[Outputs]
  execute_on = TIMESTEP_END
  csv = true
  file_base = 2D_right
[]
</code></pre></div></div><div id="e13e02ed-e87f-4bea-ba88-39e45d1a43d8" class="modal bottom-sheet"><div class="modal-content"><h4>examples/2D/anisotropic/2Dddc.i</h4><pre><code class="language-text"># 2D density-driven convective mixing with permeability anisotropy gamma = 0.5
# The dimensional Numbat action is used to add all variables, kernels etc.
# Instability is seeded by small perturbation to porosity.
# A coarse grid and time stepping used to allow this model to run in ~ 15 minutes

[Mesh]
  type = NumbatBiasedMesh
  dim = 2
  nx = 150
  ny = 50
  ymax = 0.5
  refined_edge = top
  refined_resolution = 0.001
[]

[Numbat]
  [./Dimensional]
    concentration_scaling = 1e4
    boundary_concentration = 0.049306
    periodic_bcs = true
  [../]
[]

[AuxVariables]
  [./noise]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[ICs]
  [./noise]
    type = RandomIC
    variable = noise
    max = 0.003
    min = -0.003
  [../]
  [./pressure]
    type = ConstantIC
    variable = pressure
    value = 10e6
  [../]
[]

[Materials]
  [./porosity]
    type = NumbatPorosity
    porosity = 0.3
    noise = noise
  [../]
  [./permeability]
    type = NumbatPermeability
    permeability = '1e-11 0 0 0 5e-12 0 0 0 1e-11'
  [../]
  [./diffusivity]
    type = NumbatDiffusivity
    diffusivity = 2e-9
  [../]
  [./density]
    type = NumbatDensity
    concentration = concentration
    zero_density = 994.56
    delta_density = 10.45
    saturated_concentration = 0.049306
  [../]
  [./viscosity]
    type = NumbatViscosity
    viscosity = 0.5947e-3
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Functions]
  [./timesteps]
    type = PiecewiseConstant
    x = '0 100 500 1e3 1e4 4e5'
    y = '10 50 100 500 1e3 2e3'
  [../]
[]

[Executioner]
  type = Transient
  l_max_its = 100
  end_time = 4e5
  solve_type = NEWTON
  petsc_options = -ksp_snes_ew
  petsc_options_iname = '-pc_type -sub_pc_type -ksp_atol'
  petsc_options_value = 'asm ilu 1e-12'
  nl_abs_tol = 1e-8
  [./TimeStepper]
    type = FunctionDT
    function = timesteps
  [../]
[]

[Outputs]
  perf_graph = true
  [./exodus]
    type = Exodus
    file_base = 2Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./csvoutput]
    type = CSV
    file_base = 2Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]
</code></pre></div></div><div id="cbd31670-7dd3-4c02-832e-45bd1878be39" class="modal bottom-sheet"><div class="modal-content"><h4>tests/3D/3DSF_anisotropic.i</h4><pre><code class="language-text">[Mesh]
  type = NumbatBiasedMesh
  dim = 3
  xmax = 10
  ymax = 10
  zmin = -100
  zmax = 0
  nx = 1
  ny = 1
  nz = 10
  refined_edge = top
  refined_resolution = 1
[]

[Variables]
  [./concentration]
    order = FIRST
    family = LAGRANGE
  [../]
  [./streamfunctionx]
    order = FIRST
    family = LAGRANGE
    initial_condition = 0.0
  [../]
  [./streamfunctiony]
    order = FIRST
    family = LAGRANGE
    initial_condition = 0.0
  [../]
[]

[Kernels]
  [./Darcy_x]
    type = NumbatDarcySF
    variable = streamfunctionx
    concentration = concentration
    component = x
    gamma = 0.5
  [../]
  [./Darcy_y]
    type = NumbatDarcySF
    variable = streamfunctiony
    concentration = concentration
    component = y
    gamma = 0.5
  [../]
  [./Convection]
    type = NumbatConvectionSF
    variable = concentration
    streamfunction = 'streamfunctionx streamfunctiony'
  [../]
  [./Diffusion]
    type = NumbatDiffusionSF
    variable = concentration
    anisotropic_tensor = '0.5 0 0 0 0.5 0 0 0 1'
  [../]
  [./TimeDerivative]
    type = TimeDerivative
    variable = concentration
  [../]
[]

[AuxVariables]
  [./u]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./v]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./w]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./uAux]
    type = NumbatDarcyVelocitySF
    variable = u
    component = x
    streamfunction = 'streamfunctionx streamfunctiony'
  [../]
  [./vAux]
    type = NumbatDarcyVelocitySF
    variable = v
    component = y
    streamfunction = 'streamfunctionx streamfunctiony'
  [../]
  [./wAux]
    type = NumbatDarcyVelocitySF
    variable = w
    component = z
    streamfunction = 'streamfunctionx streamfunctiony'
  [../]
[]

[BCs]
  [./conctop]
    type = DirichletBC
    variable = concentration
    boundary = top
    value = 1.0
  [../]
  [./streamfunxtop]
    type = DirichletBC
    variable = streamfunctionx
    boundary = top
    value = 0.0
  [../]
  [./streamfunxbottom]
    type = DirichletBC
    variable = streamfunctionx
    boundary = bottom
    value = 0.0
  [../]
  [./streamfunytop]
    type = DirichletBC
    variable = streamfunctiony
    boundary = top
    value = 0.0
  [../]
  [./streamfunybottom]
    type = DirichletBC
    variable = streamfunctiony
    boundary = bottom
    value = 0.0
  [../]
  [./Periodic]
    [./xy]
      variable = 'concentration streamfunctionx streamfunctiony'
      auto_direction = 'x y'
    [../]
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  end_time = 500
  dt = 10
  solve_type = PJFNK
[]

[Postprocessors]
  [./boundary_flux]
    type = NumbatSideFluxSF
    variable = concentration
    boundary = top
  [../]
  [./total_mass]
    type = NumbatTotalMassSF
    variable = concentration
  [../]
[]

[Outputs]
  perf_graph = true
  [./csvoutput]
    type = CSV
    file_base = 3DSF_anisotropic
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]
</code></pre></div></div><div id="c00bf8b1-6a4d-4edd-aaa6-baf5986d35af" class="modal bottom-sheet"><div class="modal-content"><h4>tests/actions/3DSF.i</h4><pre><code class="language-text">[Mesh]
  type = NumbatBiasedMesh
  dim = 3
  xmax = 10
  ymax = 10
  zmin = -100
  zmax = 0
  nx = 1
  ny = 1
  nz = 10
  refined_edge = top
  refined_resolution = 0.1
[]

[Numbat]
  [Dimensionless]
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  end_time = 1
  solve_type = PJFNK
[]
</code></pre></div></div><div id="c54c5d8d-80e1-4611-bdb9-bb056bca741a" class="modal bottom-sheet"><div class="modal-content"><h4>tests/3D/3DSF_anisotropic_action.i</h4><pre><code class="language-text">[Mesh]
  type = NumbatBiasedMesh
  dim = 3
  xmax = 10
  ymax = 10
  zmin = -100
  zmax = 0
  nx = 1
  ny = 1
  nz = 10
  refined_edge = top
  refined_resolution = 1
[]

[Numbat]
  [./Dimensionless]
    gamma = 0.5
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  end_time = 500
  dt = 10
  solve_type = PJFNK
[]

[Outputs]
  perf_graph = true
  [./csvoutput]
    type = CSV
    file_base = 3DSF_anisotropic
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]
</code></pre></div></div><div id="3bd688a4-280f-4534-9686-8676a91f1fc8" class="modal bottom-sheet"><div class="modal-content"><h4>tests/mesh/3D_top.i</h4><pre><code class="language-text">[Mesh]
  type = NumbatBiasedMesh
  dim = 3
  nz = 10
  zmax = 10
  refined_edge = top
  refined_resolution = 0.1
[]

[Variables]
  [./concentration]
    initial_condition = 0
  [../]
[]

[Kernels]
  [./diffusion]
    type = Diffusion
    variable = concentration
  [../]
[]

[BCs]
  [./conctop]
    type = DirichletBC
    variable = concentration
    boundary = top
    value = 1.0
  [../]
  [./concbottom]
    type = DirichletBC
    variable = concentration
    boundary = bottom
    value = 0.0
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Steady
  nl_rel_tol = 1e-12
  solve_type = NEWTON
[]

[VectorPostprocessors]
  [./conc]
    type = NodalValueSampler
    variable = concentration
    sort_by = id
  [../]
[]

[Outputs]
  execute_on = TIMESTEP_END
  csv = true
  file_base = 3D_top
[]
</code></pre></div></div><div id="6b955971-0504-4553-b7a1-8418e4c796be" class="modal bottom-sheet"><div class="modal-content"><h4>examples/3D/pseudo2D/3Dddcp.i</h4><pre><code class="language-text"># Density-driven convective mixing in a 3D representation of a 2D model. Only a single element is
# used in the y direction.
#
# Note: This example may take some time to run. At least 8 processors are recommended.

[Mesh]
  type = NumbatBiasedMesh
  dim = 3
  xmax = 1000
  zmin = -200
  zmax = 0
  nx = 80
  nz = 20
  ymax = 1
  ny = 1
  refined_edge = top
  refined_resolution = 2
[]

[Adaptivity]
  marker = combomarker
  max_h_level = 1
  initial_marker = boxmarker
  initial_steps = 1
  [./Indicators]
    [./gradjumpindicator]
      type = GradientJumpIndicator
      variable = concentration
    [../]
  [../]
  [./Markers]
    [./errormarker]
      type = ErrorToleranceMarker
      refine = 0.005
      indicator = gradjumpindicator
    [../]
    [./boxmarker]
      type = BoxMarker
      bottom_left = '0 0.0 -1.0'
      top_right = '1000 1 0'
      inside = refine
      outside = dont_mark
    [../]
    [./combomarker]
      type = ComboMarker
      markers = 'boxmarker errormarker'
    [../]
  [../]
[]

[Numbat]
  [./Dimensionless]
  [../]
[]

[ICs]
  [./concentration]
    type = NumbatPerturbationIC
    variable = concentration
    amplitude = 0.1
    seed = 1
  [../]
  [./streamfunctionx]
    type = ConstantIC
    variable = streamfunction_x
    value = 0.0
  [../]
  [./streamfunctiony]
    type = ConstantIC
    variable = streamfunction_y
    value = 0.0
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  dtmax = 100
  end_time = 2500
  start_time = 1
  solve_type = NEWTON
  petsc_options = -snes_ksp_ew
  nl_abs_tol = 1e-10
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1
    cutback_factor = 0.5
    growth_factor = 2
  [../]
[]

[Postprocessors]
  [./numdofs]
    type = NumDOFs
  [../]
[]

[Outputs]
  perf_graph = true
  [./exodus]
    type = Exodus
    file_base = 3Dddcp
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./csvoutput]
    type = CSV
    file_base = 3Dddcp
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]
</code></pre></div></div><div id="aa45bf22-106d-401b-a60c-433c9f230161" class="modal bottom-sheet"><div class="modal-content"><h4>examples/2D/isotropic/2DddcSF.i</h4><pre><code class="language-text"># Density-driven convective mixing using the streamfunction formulation in 2D.
# The dimensionless Numbat action is used to add all variables, kernels etc.
# Mesh adaptivity used to refine mesh wround fingers
# A coarse grid and time stepping used to allow this model to run in ~ 2 minutes

[Mesh]
  type = NumbatBiasedMesh
  dim = 2
  xmax = 1000
  ymin = -500
  ymax = 0
  nx = 100
  ny = 25
  refined_edge = top
  refined_resolution = 10
[]

[Numbat]
  [./Dimensionless]
    periodic_bcs = true
  [../]
[]

[Adaptivity]
  marker = errormarker
  max_h_level = 1
  [./Indicators]
    [./gradjumpindicator]
      type = GradientJumpIndicator
      variable = concentration
    [../]
  [../]
  [./Markers]
    [./errormarker]
      type = ErrorFractionMarker
      refine = 0.25
      indicator = gradjumpindicator
    [../]
  [../]
[]

[ICs]
  [./concentration]
    type = NumbatPerturbationIC
    variable = concentration
    amplitude = 0.1
    seed = 1
  [../]
[]

[Executioner]
  type = Transient
  dtmax = 100
  end_time = 3000
  start_time = 1
  solve_type = NEWTON
  nl_abs_tol = 1e-10
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1
    cutback_factor = 0.5
    growth_factor = 2
  [../]
[]

[Postprocessors]
  [./numdofs]
    type = NumDOFs
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
    petsc_options = -snes_ksp_ew
    petsc_options_iname = '-pc_type -sub_pc_type -ksp_atol'
    petsc_options_value = 'asm ilu 1e-12'
  [../]
[]

[Outputs]
  perf_graph = true
  [./exodus]
    type = Exodus
    file_base = 2DddcSF
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./csvoutput]
    type = CSV
    file_base = 2DddcSF
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]
</code></pre></div></div><div id="4948a492-9faa-4171-a442-c3f0bbc31085" class="modal bottom-sheet"><div class="modal-content"><h4>tests/3D/3DSF_action.i</h4><pre><code class="language-text">[Mesh]
  type = NumbatBiasedMesh
  dim = 3
  xmax = 10
  ymax = 10
  zmin = -100
  zmax = 0
  nx = 1
  ny = 1
  nz = 10
  refined_edge = top
  refined_resolution = 1
[]

[Numbat]
  [./Dimensionless]
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  end_time = 100
  solve_type = PJFNK
[]

[Outputs]
  perf_graph = true
  [./csvoutput]
    type = CSV
    file_base = 3DSF
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]
</code></pre></div></div><div id="f76b734e-5bec-4828-8ca7-e85ae295198a" class="modal bottom-sheet"><div class="modal-content"><h4>tests/mesh/2D_top_second_order.i</h4><pre><code class="language-text">[Mesh]
  type = NumbatBiasedMesh
  dim = 2
  ny = 10
  ymax = 10
  elem_type = QUAD9
  refined_edge = top
  refined_resolution = 0.1
[]

[Variables]
  [./concentration]
    initial_condition = 0
  [../]
[]

[Kernels]
  [./diffusion]
    type = Diffusion
    variable = concentration
  [../]
[]

[BCs]
  [./conctop]
    type = DirichletBC
    variable = concentration
    boundary = top
    value = 1.0
  [../]
  [./concbottom]
    type = DirichletBC
    variable = concentration
    boundary = bottom
    value = 0.0
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  end_time = 1
  solve_type = NEWTON
[]

[VectorPostprocessors]
  [./conc]
    type = NodalValueSampler
    variable = concentration
    sort_by = id
  [../]
[]

[Outputs]
  execute_on = TIMESTEP_END
  csv = true
  file_base = 2D_top_second_order
[]
</code></pre></div></div><div id="c21abfa0-63d4-4d6f-867b-708127f00ac8" class="modal bottom-sheet"><div class="modal-content"><h4>tests/3D/3D.i</h4><pre><code class="language-text">[Mesh]
  type = NumbatBiasedMesh
  dim = 3
  xmax = 10
  ymax = 10
  zmin = -100
  zmax = 0
  nx = 1
  ny = 1
  nz = 50
  refined_edge = top
  refined_resolution = 1
[]

[Variables]
  [./concentration]
    initial_condition = 0
  [../]
  [./pressure]
    initial_condition = 1e6
  [../]
[]

[Materials]
  [./porosity]
    type = NumbatPorosity
    porosity = 0.2
  [../]
  [./permeability]
    type = NumbatPermeability
    permeability = '1e-12 0 0 0 1e-12 0 0 0 1e-12'
  [../]
  [./diffusivity]
    type = NumbatDiffusivity
    diffusivity = 1e-3
  [../]
  [./density]
    type = NumbatDensity
    concentration = concentration
    zero_density = 1000
    delta_density = 10
  [../]
  [./viscosity]
    type = NumbatViscosity
    viscosity = 1e-3
  [../]
[]

[Kernels]
  [./time]
    type = NumbatTimeDerivative
    variable = concentration
  [../]
  [./diffusion]
    type = NumbatDiffusion
    variable = concentration
  [../]
  [./convection]
    type = NumbatConvection
    variable = concentration
    pressure = pressure
  [../]
  [./darcy]
    type = NumbatDarcy
    variable = pressure
    concentration = concentration
  [../]
[]

[BCs]
  [./conctop]
    type = DirichletBC
    variable = concentration
    boundary = top
    value = 1.0
  [../]
  [./Periodic]
    [./x]
      variable = 'concentration pressure'
      auto_direction = 'x y'
    [../]
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  end_time = 50
  dt = 10
  solve_type = NEWTON
  petsc_options_iname = '-ksp_type -pc_type -pc_sub_type'
  petsc_options_value = 'gmres hypre lu'
[]

[Postprocessors]
  [./boundary_flux]
    type = NumbatSideFlux
    variable = concentration
    boundary = top
  [../]
  [./total_mass]
    type = NumbatTotalMass
    variable = concentration
  [../]
[]

[Outputs]
  execute_on = TIMESTEP_END
  csv = true
  file_base = 3D
  perf_graph = true
[]
</code></pre></div></div><div id="cb3d0673-2d6b-4c55-ba6d-ee315a291350" class="modal bottom-sheet"><div class="modal-content"><h4>examples/2D/isotropic/2Dddc.i</h4><pre><code class="language-text"># 2D density-driven convective mixing
# The dimensional Numbat action is used to add all variables, kernels etc.
# Instability is seeded by small perturbation to porosity.
# A coarse grid and time stepping used to allow this model to run in ~ 15 minutes

[Mesh]
  type = NumbatBiasedMesh
  dim = 2
  nx = 150
  ny = 50
  ymax = 0.5
  refined_edge = top
  refined_resolution = 0.001
[]

[Numbat]
  [./Dimensional]
    concentration_scaling = 1e4
    boundary_concentration = 0.049306
    periodic_bcs = true
  [../]
[]

[AuxVariables]
  [./noise]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[ICs]
  [./noise]
    type = RandomIC
    variable = noise
    max = 0.003
    min = -0.003
  [../]
  [./pressure]
    type = ConstantIC
    variable = pressure
    value = 10e6
  [../]
[]

[Materials]
  [./porosity]
    type = NumbatPorosity
    porosity = 0.3
    noise = noise
  [../]
  [./permeability]
    type = NumbatPermeability
    permeability = '1e-11 0 0 0 1e-11 0 0 0 1e-11'
  [../]
  [./diffusivity]
    type = NumbatDiffusivity
    diffusivity = 2e-9
  [../]
  [./density]
    type = NumbatDensity
    concentration = concentration
    zero_density = 994.56
    delta_density = 10.45
    saturated_concentration = 0.049306
  [../]
  [./viscosity]
    type = NumbatViscosity
    viscosity = 0.5947e-3
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Functions]
  [./timesteps]
    type = PiecewiseConstant
    x = '0 100 500 1e3 1e4 2e5'
    y = '10 50 100 500 1e3 1e3'
  [../]
[]

[Executioner]
  type = Transient
  l_max_its = 100
  end_time = 2e5
  solve_type = NEWTON
  petsc_options = -ksp_snes_ew
  petsc_options_iname = '-pc_type -sub_pc_type -ksp_atol'
  petsc_options_value = 'asm ilu 1e-12'
  nl_abs_tol = 1e-8
  [./TimeStepper]
    type = FunctionDT
    function = timesteps
  [../]
[]

[Outputs]
  perf_graph = true
  [./exodus]
    type = Exodus
    file_base = 2Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./csvoutput]
    type = CSV
    file_base = 2Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]
</code></pre></div></div><div id="26ed80a2-0c53-47e5-8a12-2fb655a686c2" class="modal bottom-sheet"><div class="modal-content"><h4>examples/2D/anisotropic/2DddcSF.i</h4><pre><code class="language-text"># Density-driven convective mixing with permeability anisotropy using the
# streamfunction formulation in 2D.
# Example with gamma = kv/kh = 0.75
# Density-driven convective mixing
# The dimensionless Numbat action is used to add all variables, kernels etc.
# Mesh adaptivity used to refine mesh wround fingers
# A coarse grid and time stepping used to allow this model to run in ~ 2 minutes

[Mesh]
  type = NumbatBiasedMesh
  dim = 2
  xmax = 1000
  ymin = -500
  ymax = 0
  nx = 100
  ny = 25
  refined_edge = top
  refined_resolution = 10
[]

[Numbat]
  [./Dimensionless]
    gamma = 0.75
    periodic_bcs = true
  [../]
[]

[Adaptivity]
  marker = errormarker
  max_h_level = 1
  [./Indicators]
    [./gradjumpindicator]
      type = GradientJumpIndicator
      variable = concentration
    [../]
  [../]
  [./Markers]
    [./errormarker]
      type = ErrorFractionMarker
      refine = 0.25
      indicator = gradjumpindicator
    [../]
  [../]
[]

[ICs]
  [./concentration]
    type = NumbatPerturbationIC
    variable = concentration
    amplitude = 0.1
    seed = 1
  [../]
[]

[Executioner]
  type = Transient
  dtmax = 100
  end_time = 3000
  start_time = 1
  solve_type = NEWTON
  nl_abs_tol = 1e-10
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1
    cutback_factor = 0.5
    growth_factor = 2
  [../]
[]

[Postprocessors]
  [./numdofs]
    type = NumDOFs
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
    petsc_options = -snes_ksp_ew
    petsc_options_iname = '-pc_type -sub_pc_type -ksp_atol'
    petsc_options_value = 'asm ilu 1e-12'
  [../]
[]

[Outputs]
  perf_graph = true
  [./exodus]
    type = Exodus
    file_base = 2DddcSF
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./csvoutput]
    type = CSV
    file_base = 2DddcSF
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]
</code></pre></div></div><div id="edd3175a-a27d-49e1-ba62-cb7a495dd6d0" class="modal bottom-sheet"><div class="modal-content"><h4>tests/actions/3D.i</h4><pre><code class="language-text">[Mesh]
  type = NumbatBiasedMesh
  dim = 3
[]

[Numbat]
  [./Dimensional]
  [../]
[]

[ICs]
  [./concentration]
    type = ConstantIC
    variable = concentration
    value = 0
  [../]
  [./pressure]
    type = ConstantIC
    variable = pressure
    value = 1e6
  [../]
[]

[Materials]
  [./porosity]
    type = NumbatPorosity
    porosity = 0.2
  [../]
  [./permeability]
    type = NumbatPermeability
    permeability = '1e-12 0 0 0 1e-12 0 0 0 1e-12'
  [../]
  [./diffusivity]
    type = NumbatDiffusivity
    diffusivity = 1e-3
  [../]
  [./density]
    type = NumbatDensity
    concentration = concentration
    zero_density = 1000
    delta_density = 10
  [../]
  [./viscosity]
    type = NumbatViscosity
    viscosity = 1e-3
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  end_time = 1
  solve_type = PJFNK
  petsc_options_iname = '-ksp_type -pc_type -pc_sub_type'
  petsc_options_value = 'gmres hypre ilu'
[]
</code></pre></div></div></body></html>