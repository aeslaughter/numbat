<!DOCTYPE html>

<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" name="viewport"/>
<meta content="defaultdict(&lt;type 'int'&gt;, {})" name="moose-status">
<!-- Website title -->
<title>input_file_syntax</title>
<!-- CSS -->
<link href="../contrib/materialize/materialize.min.css" rel="stylesheet" type="text/css"/>
<link href="../contrib/prisim/prism.min.css" rel="stylesheet" type="text/css"/>
<link href="../contrib/katex/katex.min.css" rel="stylesheet" type="text/css"/>
<link href="../css/moose.css" rel="stylesheet" type="text/css"/>
<!-- JS -->
<script src="../contrib/katex/katex.min.js" type="text/javascript"></script>
</meta></head>
<body>
<div class="page-wrap">
<header>
<!--
Page header including the top and sidebar navigation.
-->
<nav>
<div class="nav-wrapper container">
<a class="page-title" href="../index.html">Numbat</a>
<a class="button-collapse" data-activates="mobile-nav" href="#"><i class="material-icons">menu</i></a>
<ul class="right hide-on-med-and-down">
<li><a class="dropdown-button" data-activates="dropdown-top-Getting-Started" href="#!">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-top-Getting-Started">
<li><a href="../getting_started/index.html">Installation</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-top-Theory" href="#!">Theory<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-top-Theory">
<li><a href="../introduction/index.html">Introduction</a></li>
<li><a href="../governing_equations/index.html">Governing equations</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-top-Details" href="#!">Details<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-top-Details">
<li><a href="../implementation/index.html">Implementation</a></li>
<li><a href="index.html">Input file syntax</a></li>
<li><a href="../systems/index.html">Available objects</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-top-Examples" href="#!">Examples<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-top-Examples">
<li><a href="../example2D/index.html">2D</a></li>
<li><a href="../example3D/index.html">3D</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-top-Manual" href="#!">Manual<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-top-Manual">
<li><a href="../download/index.html">User manual</a></li>
</ul>
<li>
<form>
<div class="input-field search-wrapper">
<input id="search" required="" type="search">
<label for="search"><i class="material-icons">search</i></label>
<i class="material-icons">close</i>
<div class="search-results"></div>
</input></div>
</form>
</li>
<li>
<a class="github-mark-label" href="https://github.com/cpgr/numbat">
<img class="github-mark" src="../media/github-mark-light.png">GitHub
            
          </img></a>
</li>
</ul>
<ul class="side-nav" id="mobile-nav">
<li><a class="dropdown-button" data-activates="dropdown-side-Getting-Started" href="#!">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-side-Getting-Started">
<li><a href="../getting_started/index.html">Installation</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-side-Theory" href="#!">Theory<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-side-Theory">
<li><a href="../introduction/index.html">Introduction</a></li>
<li><a href="../governing_equations/index.html">Governing equations</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-side-Details" href="#!">Details<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-side-Details">
<li><a href="../implementation/index.html">Implementation</a></li>
<li><a href="index.html">Input file syntax</a></li>
<li><a href="../systems/index.html">Available objects</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-side-Examples" href="#!">Examples<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-side-Examples">
<li><a href="../example2D/index.html">2D</a></li>
<li><a href="../example3D/index.html">3D</a></li>
</ul>
<li><a class="dropdown-button" data-activates="dropdown-side-Manual" href="#!">Manual<i class="material-icons right">arrow_drop_down</i></a></li>
<ul class="dropdown-content" id="dropdown-side-Manual">
<li><a href="../download/index.html">User manual</a></li>
</ul>
</ul>
</div>
</nav>
</header>
<main class="main">
<div class="container">
<!-- Breadcrumbs spanning entire page -->
<div class="row">
<div class="col hide-on-med-and-down l12">
<nav class="breadcrumb-nav">
<div class="nav-wrapper">
<div class="col s12 m9 l10">
<span class="breadcrumb"></span>
<a class="breadcrumb" href="../index.html">home</a>
<a class="breadcrumb" href="index.html">input_file_syntax</a>
</div>
</div>
</nav>
</div>
</div>
<!-- Row containing the markdown content and the table-of-contents on the right -->
<div class="row">
<!-- Markdown -->
<div class="col s12 m8 l9" id="moose-markdown-content">
<h1 id="input-file-syntax">Input file syntax</h1>
<p>The input file for a Numbat simulation is a simple, block-structured
text file based on the input files for a plain <a href="http://www.mooseframework.org">MOOSE</a> input file.</p>
<div class="section scrollspy" id="essential-input"><h2 id="essential-input">Essential input</h2>
<p>Details of the minimum input file requirements are given below.</p>
<h3 id="mesh">Mesh</h3>
<p>All simulations must feature a mesh. For the basic model with a
rectangular mesh, the built-in MOOSE <code>GeneratedMesh</code> can be used to
create a suitable mesh. In 2D, the input block looks like:</p>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[Mesh]
  type = 'GeneratedMesh'
  dim = '2'
  ymax = '1.5'
  nx = '100'
  ny = '50'
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/2D/isotropic/2Dddc.i" href="https://github.com/cpgr/numbat/blob/master/examples/2D/isotropic/2Dddc.i">(2Dddc.i)</a></div>
</div>
</p>
<p>In 3D, the Mesh block would look like:</p>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[Mesh]
  type = 'GeneratedMesh'
  dim = '3'
  zmax = '1.5'
  nx = '20'
  ny = '20'
  nz = '500'
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/3D/isotropic/3Dddc.i" href="https://github.com/cpgr/numbat/blob/master/examples/3D/isotropic/3Dddc.i">(3Dddc.i)</a></div>
</div>
</p>
<h3 id="variables">Variables</h3>
<p>The number and type of variables required depends on the chosen formulation. For the
dimensional formulation, two nonlinear variables must be provided, representing the fluid pressure and solute concentration.</p>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[Variables]
  [./concentration]
    initial_condition = '0'
    scaling = '1e6'
  [../]
  [./pressure]
    initial_condition = '1e6'
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/2D/isotropic/2Dddc.i" href="https://github.com/cpgr/numbat/blob/master/examples/2D/isotropic/2Dddc.i">(2Dddc.i)</a></div>
</div>
</p>
<p>For the dimensionless streamfunction formulation, the nonlinear variables for a 2D
simulations are solute concentration and streamfunction:</p>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[Variables]
  [./concentration]
    order = 'FIRST'
    family = 'LAGRANGE'
  [../]
  [./streamfunction]
    order = 'FIRST'
    family = 'LAGRANGE'
    initial_condition = '0.0'
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/2D/isotropic/2DddcSF.i" href="https://github.com/cpgr/numbat/blob/master/examples/2D/isotropic/2DddcSF.i">(2DddcSF.i)</a></div>
</div>
</p>
<p>In 3D, an additional streamfunction variable must also be added:</p>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[Variables]
  [./concentration]
    order = 'FIRST'
    family = 'LAGRANGE'
    [./InitialCondition]
      type = 'NumbatPerturbationIC'
      variable = 'concentration'
      amplitude = '0.1'
      seed = '1'
    [../]
  [../]
  [./streamfunctionx]
    order = 'FIRST'
    family = 'LAGRANGE'
    initial_condition = '0.0'
  [../]
  [./streamfunctiony]
    order = 'FIRST'
    family = 'LAGRANGE'
    initial_condition = '0.0'
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/3D/isotropic/3DddcSF.i" href="https://github.com/cpgr/numbat/blob/master/examples/3D/isotropic/3DddcSF.i">(3DddcSF.i)</a></div>
</div>
</p>
<h3 id="materials">Materials</h3>
<p>For the dimensional formulation, several material and fluid properties are required:
porosity, permeability, fluid density and viscosity, and diffusivity. These can be
added using the following Numbat materials:</p>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[Materials]
  [./porosity]
    type = 'NumbatPorosity'
    porosity = '0.3'
    noise = 'noise'
  [../]
  [./permeability]
    type = 'NumbatPermeability'
    permeability = '1e-11 0 0 0 1e-11 0 0 0 1e-11'
  [../]
  [./diffusivity]
    type = 'NumbatDiffusivity'
    diffusivity = '2e-9'
  [../]
  [./density]
    type = 'NumbatDensity'
    concentration = 'concentration'
    zero_density = '995'
    delta_density = '10.5'
    saturated_concentration = '0.049306'
  [../]
  [./viscosity]
    type = 'NumbatViscosity'
    viscosity = '6e-4'
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/2D/isotropic/2Dddc.i" href="https://github.com/cpgr/numbat/blob/master/examples/2D/isotropic/2Dddc.i">(2Dddc.i)</a></div>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>No material properties are required in the dimensionless streamfunction formulation</p>
</div>
<h3 id="kernels">Kernels</h3>
<p>Four kernels are required for a dimensional model: <code>NumbatTimeDerivative</code>, <code>NumbatDiffusion</code>, <code>NumbatConvection</code>, and <code>NumbatDarcy</code>.</p>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[Kernels]
  [./time]
    type = 'NumbatTimeDerivative'
    variable = 'concentration'
  [../]
  [./diffusion]
    type = 'NumbatDiffusion'
    variable = 'concentration'
  [../]
  [./convection]
    type = 'NumbatConvection'
    variable = 'concentration'
    pressure = 'pressure'
  [../]
  [./darcy]
    type = 'NumbatDarcy'
    variable = 'pressure'
    concentration = 'concentration'
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/2D/isotropic/2Dddc.i" href="https://github.com/cpgr/numbat/blob/master/examples/2D/isotropic/2Dddc.i">(2Dddc.i)</a></div>
</div>
</p>
<p>For the dimensionless streamfunction formulation, four kernels are required for a 2D model: a <code>NumbatDarcySF</code> kernel, a <code>NumbatDiffusionSF</code> kernel, a <code>NumbatConvectionSF</code> kernel, and a <code>TimeDerivative</code> kernel.</p>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[Kernels]
  [./Darcy]
    type = 'NumbatDarcySF'
    variable = 'streamfunction'
    concentration = 'concentration'
  [../]
  [./Convection]
    type = 'NumbatConvectionSF'
    variable = 'concentration'
    streamfunction = 'streamfunction'
  [../]
  [./Diffusion]
    type = 'NumbatDiffusionSF'
    variable = 'concentration'
  [../]
  [./TimeDerivative]
    type = 'TimeDerivative'
    variable = 'concentration'
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/2D/isotropic/2DddcSF.i" href="https://github.com/cpgr/numbat/blob/master/examples/2D/isotropic/2DddcSF.i">(2DddcSF.i)</a></div>
</div>
</p>
<p>For 3D models, an additional <code>NumbatDarcySF</code> kernel is required for the
additional streamfunction variable. An example of the kernels block for
a 3D isotropic model is</p>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[Kernels]
  [./Darcy_x]
    type = 'NumbatDarcySF'
    variable = 'streamfunctionx'
    concentration = 'concentration'
    component = 'x'
  [../]
  [./Darcy_y]
    type = 'NumbatDarcySF'
    variable = 'streamfunctiony'
    concentration = 'concentration'
    component = 'y'
  [../]
  [./Convection]
    type = 'NumbatConvectionSF'
    variable = 'concentration'
    streamfunction = 'streamfunctionx streamfunctiony'
  [../]
  [./Diffusion]
    type = 'NumbatDiffusionSF'
    variable = 'concentration'
  [../]
  [./TimeDerivative]
    type = 'TimeDerivative'
    variable = 'concentration'
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/3D/isotropic/3DddcSF.i" href="https://github.com/cpgr/numbat/blob/master/examples/3D/isotropic/3DddcSF.i">(3DddcSF.i)</a></div>
</div>
</p>
<p>In the 3D case, it is important to note that the <code>NumbatDarcySF</code> kernel must
specify the component that it applies to, and that the
<code>streamfunction</code> keyword in the <code>NumbatConvectionSF</code>
kernel must contain both streamfunction variables ordered by the <code>x</code>
component then the <code>y</code> component.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the streamfunction formulation, a <code>TimeDerivative</code> kernel is used, rather than a <code>NumbatTimeDerivative</code> kernel, as porosity has been scaled out of the problem.</p>
</div>
<h3 id="boundary-conditions">Boundary conditions</h3>
<p>Appropriate boundary conditions must be prescribed. Typically, these
will be constant concentration at the top of the model domain, periodic
boundary conditions on the lateral sides (to mimic an infinite
model), and no-flow boundary conditions at the top and bottom
surfaces.</p>
<p>In the 2D dimensional formulation, this can be achieved using the following input block:
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[BCs]
  [./conctop]
    type = 'PresetBC'
    variable = 'concentration'
    boundary = 'top'
    value = '0.049306'
  [../]
  [./Periodic]
    [./x]
      variable = 'concentration'
      auto_direction = 'x'
    [../]
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/2D/isotropic/2Dddc.i" href="https://github.com/cpgr/numbat/blob/master/examples/2D/isotropic/2Dddc.i">(2Dddc.i)</a></div>
</div>
</p>
<p>while in 3D
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[BCs]
  [./conctop]
    type = 'PresetBC'
    variable = 'concentration'
    boundary = 'front'
    value = '0.049306'
  [../]
  [./Periodic]
    [./x]
      variable = 'concentration'
      auto_direction = 'x y'
    [../]
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/3D/isotropic/3Dddc.i" href="https://github.com/cpgr/numbat/blob/master/examples/3D/isotropic/3Dddc.i">(3Dddc.i)</a></div>
</div>
</p>
<p>In this case, the <em>conctop</em> boundary condition is a Dirichlet condition
at the top of the model that fixes the value of concentration.</p>
<p>It is useful to note that a MOOSE <em>GeneratedMesh</em> provides descriptive
names for the sides of the model (top, bottom, left, right) which can be
referenced in the input file.</p>
<p>For the dimensionless streamfunction formulation,
no-flow boundary conditions are prescribed
on the top and bottom surfaces by holding the <em>streamfunction</em> variable
constant (in this case 0).</p>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[BCs]
  [./conctop]
    type = 'DirichletBC'
    variable = 'concentration'
    boundary = 'top'
    value = '1.0'
  [../]
  [./streamfuntop]
    type = 'DirichletBC'
    variable = 'streamfunction'
    boundary = 'top'
    value = '0.0'
  [../]
  [./streamfunbottom]
    type = 'DirichletBC'
    variable = 'streamfunction'
    boundary = 'bottom'
    value = '0.0'
  [../]
  [./Periodic]
    [./x]
      variable = 'concentration streamfunction'
      auto_direction = 'x'
    [../]
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/2D/isotropic/2DddcSF.i" href="https://github.com/cpgr/numbat/blob/master/examples/2D/isotropic/2DddcSF.i">(2DddcSF.i)</a></div>
</div>
</p>
<h3 id="executioner">Executioner</h3>
<p>Each MOOSE simulation must use an <em>Executioner</em>, which provides
parameters for the solve.</p>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[Executioner]
  type = 'Transient'
  l_max_its = '200'
  end_time = '3e5'
  solve_type = 'NEWTON'
  petsc_options = '-ksp_snes_ew'
  petsc_options_iname = '-pc_type -sub_pc_type -ksp_atol'
  petsc_options_value = 'bjacobi ilu 1e-12'
  nl_abs_tol = '1e-10'
  nl_max_its = '25'
  dtmax = '2e3'
  [./TimeStepper]
    type = 'IterationAdaptiveDT'
    dt = '1'
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/2D/isotropic/2Dddc.i" href="https://github.com/cpgr/numbat/blob/master/examples/2D/isotropic/2Dddc.i">(2Dddc.i)</a></div>
</div>
</p>
<p>Executioners are a standard MOOSE feature that are well documented on
the <a href="http://www.mooseframework.org">MOOSE</a>, so no further detail is provided here.</p>
<h3 id="preconditioning">Preconditioning</h3>
<p>A default preconditioning block is used that provides all Jacobian
entries to aid convergence.</p>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[Preconditioning]
  [./smp]
    type = 'SMP'
    full = 'true'
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/2D/isotropic/2Dddc.i" href="https://github.com/cpgr/numbat/blob/master/examples/2D/isotropic/2Dddc.i">(2Dddc.i)</a></div>
</div>
</p>
<p>This is a standard MOOSE feature that is documented on the <a href="http://www.mooseframework.org">MOOSE</a> website, so no further detail is provided here.</p>
<h3 id="outputs">Outputs</h3>
<p>To provide ouptut from the simulation, an <em>Outputs</em> block must be
specified. An example is</p>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[Outputs]
  [./console]
    type = 'Console'
    perf_log = 'true'
    output_nonlinear = 'true'
  [../]
  [./exodus]
    type = 'Exodus'
    file_base = '2Dddc'
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./csvoutput]
    type = 'CSV'
    file_base = '2Dddc'
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/2D/isotropic/2Dddc.i" href="https://github.com/cpgr/numbat/blob/master/examples/2D/isotropic/2Dddc.i">(2Dddc.i)</a></div>
</div>
</p>
<p>There are a large number of output options available in
MOOSE, see the <a href="http://www.mooseframework.org">MOOSE</a> website for further details.</p>
</div><div class="section scrollspy" id="optional-input"><h2 id="optional-input">Optional input</h2>
<p>While the above required blocks will enable a Numbat simulation to run,
there are a number of optional input blocks that will improve the
simulations are increase the amount of rsults provided.</p>
<h3 id="mesh-modifier">Mesh modifier</h3>
<p>It is often useful to bias the mesh so that the spatial resolution is more refined at the boundary where the solute enters the domain so that the small initial downwelling plumes can be accurately characterised. Numbat provides a mesh modifier, <a href="../documentation/systems/MeshModifiers/numbat/NumbatBiasedMesh/index.html">NumbatBiasedMesh</a>, that allows the mesh to be refined to a specified spatial resolution at one boundary.</p>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[MeshModifiers]
  [./bias]
    type = 'NumbatBiasedMesh'
    refined_edge = 'top'
    refined_resolution = '0.001'
    num_elems = '50'
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/2D/isotropic/2Dddc.i" href="https://github.com/cpgr/numbat/blob/master/examples/2D/isotropic/2Dddc.i">(2Dddc.i)</a></div>
</div>
</p>
<h3 id="mesh-adaptivity">Mesh adaptivity</h3>
<p>MOOSE features built-in mesh adaptivity that is extremely useful in
Numbat simulations to reduce computational expense. This can be included using:</p>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[Adaptivity]
  max_h_level = '1'
  initial_marker = 'boxmarker'
  initial_steps = '1'
  marker = 'errormarker'
  [./Indicators]
    [./gradjumpindicator]
      type = 'GradientJumpIndicator'
      variable = 'concentration'
    [../]
  [../]
  [./Markers]
    [./errormarker]
      type = 'ErrorToleranceMarker'
      refine = '0.05'
      indicator = 'gradjumpindicator'
    [../]
    [./boxmarker]
      type = 'BoxMarker'
      bottom_left = '0 0 -10'
      top_right = '500 500 0'
      inside = 'refine'
      outside = 'dont_mark'
    [../]
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/3D/isotropic/3DddcSF.i" href="https://github.com/cpgr/numbat/blob/master/examples/3D/isotropic/3DddcSF.i">(3DddcSF.i)</a></div>
</div>
</p>
<p>For details about mesh adaptivity, see the <a href="http://www.mooseframework.org">MOOSE</a> website.</p>
<h3 id="initial-condition">Initial condition</h3>
<p>To seed the instability, a random perturbation to the initial concentration can be prescribed using the <code>NumbatPerturbationIC</code> initial condition.</p>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[ICs]
  [./concentration]
    type = 'NumbatPerturbationIC'
    variable = 'concentration'
    amplitude = '0.1'
    seed = '1'
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/2D/isotropic/2DddcSF.i" href="https://github.com/cpgr/numbat/blob/master/examples/2D/isotropic/2DddcSF.i">(2DddcSF.i)</a></div>
</div>
</p>
<p>The <code>NumbatPerturbationIC</code> initial condition applies the diffusive concentration profile to the nodes for (scaled) time <span class="moose-katex-inline" id="moose-katex-equation-9812282e-da1f-4ff9-8208-ca2fd4702322"><script>var element = document.getElementById("moose-katex-equation-9812282e-da1f-4ff9-8208-ca2fd4702322");try{katex.render("t = 1", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: t = 1");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: t = 1";element.appendChild(err);}</script></span>,
<div class="moose-katex-block">
<div class="moose-katex-equation" data-moose-katex-equation-number="1" id="moose-katex-equation-1"></div>
<div class="moose-katex-block-number">(1)</div>
<script>var element = document.getElementById("moose-katex-equation-1");try{katex.render(" c_d(z, t =1) = 1 + \\mathrm{erf}(z /2), ", element, {displayMode:true});}catch (exception){console.log("KaTeX render failed:  c_d(z, t =1) = 1 + \\mathrm{erf}(z /2), ");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error:  c_d(z, t =1) = 1 + \\mathrm{erf}(z /2), ";element.appendChild(err);}</script>
</div>
for <span class="moose-katex-inline" id="moose-katex-equation-da96937e-2287-4815-8bf6-cd57ba573df6"><script>var element = document.getElementById("moose-katex-equation-da96937e-2287-4815-8bf6-cd57ba573df6");try{katex.render("z < 0", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: z < 0");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: z < 0";element.appendChild(err);}</script></span>, where <span class="moose-katex-inline" id="moose-katex-equation-b850e503-0005-4853-bd2b-317de2c8a273"><script>var element = document.getElementById("moose-katex-equation-b850e503-0005-4853-bd2b-317de2c8a273");try{katex.render("\\mathrm{erf(z)}", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: \\mathrm{erf(z)}");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: \\mathrm{erf(z)}";element.appendChild(err);}</script></span> is the error function.</p>
<p>A uniform random perturbation is then added to the diffusive concentration profile, where the amplitude of the perturbation is specified by the input file value <code>amplitude</code>.</p>
<h3 id="postprocessors">Postprocessors</h3>
<p>The flux over the top boundary or the total mass of solute in the model is of particular interest in many cases (especially convective mixing of CO<span class="moose-katex-inline" id="moose-katex-equation-e6711692-650e-4197-a2ff-fd1de2d71525"><script>var element = document.getElementById("moose-katex-equation-e6711692-650e-4197-a2ff-fd1de2d71525");try{katex.render("_2", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: _2");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: _2";element.appendChild(err);}</script></span>). These can be
calculated at each time step using the <a href="../documentation/systems/Postprocessors/numbat/NumbatSideFlux/index.html">NumbatSideFlux</a> and <a href="../documentation/systems/Postprocessors/numbat/NumbatTotalMass/index.html">NumbatTotalMass</a> Postprocessors.</p>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[Postprocessors]
  [./boundaryfluxint]
    type = 'NumbatSideFlux'
    variable = 'concentration'
    boundary = 'top'
  [../]
  [./mass]
    type = 'NumbatTotalMass'
    variable = 'concentration'
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/2D/isotropic/2Dddc.i" href="https://github.com/cpgr/numbat/blob/master/examples/2D/isotropic/2Dddc.i">(2Dddc.i)</a></div>
</div>
</p>
<p>Versions of these Postprocessors for the dimensionless streamfunction formulation are also
provided, see <a href="../documentation/systems/Postprocessors/numbat/NumbatSideFluxSF/index.html">NumbatSideFluxSF</a> and <a href="../documentation/systems/Postprocessors/numbat/NumbatTotalMassSF/index.html">NumbatTotalMassSF</a> for details.</p>
<p>Numbat also provides a simple Postprocessor to calculate the Rayleigh number for
dimensional simulations, see <a href="../documentation/systems/Postprocessors/numbat/NumbatRayleighNumber/index.html">NumbatRayleighNumber</a> for details.</p>
<h3 id="auxkernels">AuxKernels</h3>
<p>The velocity components in the <span class="moose-katex-inline" id="moose-katex-equation-c9b1922c-bda1-4894-a164-cb9a9b75b391"><script>var element = document.getElementById("moose-katex-equation-c9b1922c-bda1-4894-a164-cb9a9b75b391");try{katex.render("x", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: x");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: x";element.appendChild(err);}</script></span> and <span class="moose-katex-inline" id="moose-katex-equation-1f357030-fe2a-41d6-8254-15a67400f2cf"><script>var element = document.getElementById("moose-katex-equation-1f357030-fe2a-41d6-8254-15a67400f2cf");try{katex.render("y", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: y");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: y";element.appendChild(err);}</script></span> directions (in 2D), and <span class="moose-katex-inline" id="moose-katex-equation-4a4dc0e7-0ced-467b-9b56-a7bc4c8bb245"><script>var element = document.getElementById("moose-katex-equation-4a4dc0e7-0ced-467b-9b56-a7bc4c8bb245");try{katex.render("x", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: x");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: x";element.appendChild(err);}</script></span>,
<span class="moose-katex-inline" id="moose-katex-equation-2c9882a6-67e0-42b6-8c0d-1a4eaf828465"><script>var element = document.getElementById("moose-katex-equation-2c9882a6-67e0-42b6-8c0d-1a4eaf828465");try{katex.render("y", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: y");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: y";element.appendChild(err);}</script></span>, and <span class="moose-katex-inline" id="moose-katex-equation-c027ea8d-d02a-4ba5-b8cc-827212468a96"><script>var element = document.getElementById("moose-katex-equation-c027ea8d-d02a-4ba5-b8cc-827212468a96");try{katex.render("z", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: z");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: z";element.appendChild(err);}</script></span> directions in 3D can be calculated using the auxiliary
system. These velocity components are calculated using the
streamfunction(s), see the governing equations for details.</p>
<p>In the 2D case, two auxiliary variables, <span class="moose-katex-inline" id="moose-katex-equation-6f362839-0c32-44cd-91f8-03d2a3a46bdd"><script>var element = document.getElementById("moose-katex-equation-6f362839-0c32-44cd-91f8-03d2a3a46bdd");try{katex.render("u", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: u");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: u";element.appendChild(err);}</script></span> and <span class="moose-katex-inline" id="moose-katex-equation-d554684f-2fe8-46c8-8c62-5a6cd05c271e"><script>var element = document.getElementById("moose-katex-equation-d554684f-2fe8-46c8-8c62-5a6cd05c271e");try{katex.render("w", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: w");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: w";element.appendChild(err);}</script></span>, can be defined for
the horizontal and vertical velocity components, respectively.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Importantly, these auxiliary variables <strong>must</strong> have monomial
shape functions (these are referred to as <em>elemental</em> variables, as the
value is constant over each mesh element). This restriction is due to fact
that the gradient of variables is undefined for
<em>nodal</em> auxiliary variables (for example, those using linear Lagrange
shape functions).</p>
</div>
<p>An example of the input syntax for the 2D case is</p>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[AuxVariables]
  [./u]
    order = 'CONSTANT'
    family = 'MONOMIAL'
  [../]
  [./w]
    order = 'CONSTANT'
    family = 'MONOMIAL'
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/2D/isotropic/2DddcSF.i" href="https://github.com/cpgr/numbat/blob/master/examples/2D/isotropic/2DddcSF.i">(2DddcSF.i)</a></div>
</div>
</p>
<p>For the 3D case, there is an additional horizontal velocity component
(<em>v</em>), so the input syntax is</p>
<p>
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[AuxVariables]
  [./u]
    order = 'CONSTANT'
    family = 'MONOMIAL'
  [../]
  [./v]
    order = 'CONSTANT'
    family = 'MONOMIAL'
  [../]
  [./w]
    order = 'CONSTANT'
    family = 'MONOMIAL'
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/3D/isotropic/3DddcSF.i" href="https://github.com/cpgr/numbat/blob/master/examples/3D/isotropic/3DddcSF.i">(3DddcSF.i)</a></div>
</div>
</p>
<p>The velocity components are calculated by <a href="../documentation/systems/AuxKernels/numbat/NumbatDarcyVelocity/index.html">NumbatDarcyVelocity</a> AuxKernels (or <a href="../documentation/systems/AuxKernels/numbat/NumbatDarcyVelocitySF/index.html">NumbatDarcyVelocitySF</a> AuxKernels for the
dimensionless streamfunction formulation). Each velocity component is computed by an
AuxKernel.</p>
<p>For the 2D case, two AuxKernels are required:
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[AuxKernels]
  [./uAux]
    type = 'NumbatDarcyVelocitySF'
    variable = 'u'
    component = 'x'
    streamfunction = 'streamfunction'
  [../]
  [./wAux]
    type = 'NumbatDarcyVelocitySF'
    variable = 'w'
    component = 'y'
    streamfunction = 'streamfunction'
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/2D/isotropic/2DddcSF.i" href="https://github.com/cpgr/numbat/blob/master/examples/2D/isotropic/2DddcSF.i">(2DddcSF.i)</a></div>
</div>
</p>
<p>while for 3D, three AuxKernels are necessary:
<div class="moose-float-div moose-listing-div" style="label:False;">
<pre style="overflow-y:scroll;max-height:350px"><code class="language-text">[AuxKernels]
  [./uAux]
    type = 'NumbatDarcyVelocitySF'
    variable = 'u'
    component = 'x'
    streamfunction = 'streamfunctionx streamfunctiony'
  [../]
  [./vAux]
    type = 'NumbatDarcyVelocitySF'
    variable = 'v'
    component = 'y'
    streamfunction = 'streamfunctionx streamfunctiony'
  [../]
  [./wAux]
    type = 'NumbatDarcyVelocitySF'
    variable = 'w'
    component = 'z'
    streamfunction = 'streamfunctionx streamfunctiony'
  [../]
[]
</code></pre>
<div><a class="moose-listing-link tooltipped" data-tooltip="examples/3D/isotropic/3DddcSF.i" href="https://github.com/cpgr/numbat/blob/master/examples/3D/isotropic/3DddcSF.i">(3DddcSF.i)</a></div>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the 3D case, both streamfunction variables must be given, in the correct order (eg. <span class="moose-katex-inline" id="moose-katex-equation-6d7151e8-dd3a-4aa6-945b-4113f0bf2609"><script>var element = document.getElementById("moose-katex-equation-6d7151e8-dd3a-4aa6-945b-4113f0bf2609");try{katex.render("x", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: x");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: x";element.appendChild(err);}</script></span> then <span class="moose-katex-inline" id="moose-katex-equation-2b8eca44-cc61-40c9-8fda-f3c9d729f45c"><script>var element = document.getElementById("moose-katex-equation-2b8eca44-cc61-40c9-8fda-f3c9d729f45c");try{katex.render("y", element, {displayMode:false});}catch (exception){console.log("KaTeX render failed: y");var err=document.createElement("span");err.setAttribute("class", "moose-katex-error");err.textContent = "LaTeX Error: y";element.appendChild(err);}</script></span>)</p>
</div>
</div>
</div>
<!-- TOC -->
<div class="col hide-on-med-and-down l3">
<!--
Table of Contents

Loops through the current MoosePage object and builds a list
of second level headers.

Additionally, the "Edit on Github" button is added that links
the source markdown file if the 'github_edit' paramater is
set to True (the default).

-->
<div class="toc-wrapper pin-top">
<div class="moose-devel-links-container">
</div>
<div class="section table-of-contents">
<ul>
<li><a href="#essential-input">Essential input</a></li>
<li><a href="#optional-input">Optional input</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</main>
</div>
<footer class="page-footer">
<!--MOOSE Footer-->
<div class="container white-text">
<div class="row">
<div class="col s12">
<p>
<span class="moose-site-generated">
        Site Generated with <a href="https://www.mooseframework.org">MOOSE</a>
</span>
<span class="moose-edit-markdown">
<a class="moose-edit-markdown-link" href="https://github.com/cpgr/numbat/edit/devel/docs/content/input_file_syntax.md" style="float:right">Edit Markdown</a>
</span>
</p>
</div>
</div>
<div class="row">
<div class="col s12">
<p class="moose-status-container">
<span id="moose-status">
<span class="new badge pass" data-badge-caption="pass"></span>
</span>
</p>
</div>
</div>
</div>
</footer>
<script src="../contrib/jquery/jquery-3.2.1.min.js" type="text/javascript"></script>
<script src="../contrib/materialize/materialize.min.js" type="text/javascript"></script>
<script src="../contrib/clipboard/clipboard.min.js" type="text/javascript"></script>
<script src="../contrib/prisim/prism.min.js" type="text/javascript"></script>
<script src="../js/init.js" type="text/javascript"></script>
</body>
</html>