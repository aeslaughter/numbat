<!DOCTYPE html><html><head><meta charset="UTF-8"><link media="screen,projection" href="contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet"></link><link href="contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="css/moose.css" type="text/css" rel="stylesheet"></link><script src="contrib/jquery/jquery.min.js" type="text/javascript"></script><script src="contrib/materialize/materialize.min.js" type="text/javascript"></script><script src="contrib/clipboard/clipboard.min.js" type="text/javascript"></script><script src="contrib/prism/prism.min.js" type="text/javascript"></script><script src="contrib/katex/katex.min.js" type="text/javascript"></script><script src="contrib/fuse/fuse.min.js" type="text/javascript"></script><script src="js/search_index.js" type="text/javascript"></script><script src="js/init.js" type="text/javascript"></script><title>Implementation   details|Numbat</title><script src="contrib/plotly/plotly.min.js" type="text/javascript"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://github.com/cpgr/numbat" class="right"><img src="media/github-logo.png" class="github-mark"></img><img src="media/github-mark.png" class="github-logo"></img></a><a href="http://cpgr.github.io/numbat/" class="left moose-logo">Numbat</a><ul class="right hide-on-med-and-down" id="nav-mobile"><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="8a572da6-b2eb-417f-ad50-3287d4214f76">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="614f67c5-fede-4102-abd8-ca235f9116d7">Theory<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="21ff120a-cd79-49fc-bc6f-d2929fba96c0">Details<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="78d95ab2-9dd6-4f09-b5f8-4571ae84214a">Examples<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="f93f5d90-799f-4222-8b11-5a98ed2baf00">Manual<i class="material-icons right">arrow_drop_down</i></a></li></ul><ul class="dropdown-content" id="8a572da6-b2eb-417f-ad50-3287d4214f76"><li><a href="getting_started.html">Installation</a></li></ul><ul class="dropdown-content" id="614f67c5-fede-4102-abd8-ca235f9116d7"><li><a href="introduction.html">Introduction</a></li><li><a href="governing_equations.html">Governing equations</a></li></ul><ul class="dropdown-content" id="21ff120a-cd79-49fc-bc6f-d2929fba96c0"><li><a href="implementation.html">Implementation</a></li><li><a href="input_file_syntax.html">Input file syntax</a></li><li><a href="running_numbat.html">Running Numbat</a></li><li><a href="systems.html">Available objects</a></li></ul><ul class="dropdown-content" id="78d95ab2-9dd6-4f09-b5f8-4571ae84214a"><li><a href="example2D.html">2D</a></li><li><a href="example3D.html">3D</a></li></ul><ul class="dropdown-content" id="f93f5d90-799f-4222-8b11-5a98ed2baf00"><li><a href="download.html">User manual</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input autocomplete="off" onkeyup="mooseSearch()" type="text" id="moose-search-box"><label for="search">http://cpgr.github.io/numbat/</label></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-action modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href="implementation.html" class="breadcrumb">implementation</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section data-section-text="Implementation   details" data-section-level="1" id="40d19c87-3324-4ea6-bbf4-9ef205c021d5"><h1>Implementation details</h1><section class="scrollspy" data-section-text="Rayleigh   number" data-section-level="2" id="bbdecca7-8129-4c50-b60c-7099686f8207"><h2>Rayleigh number</h2><p>The Rayleigh number relates the relative importance of buoyancy forces to diffusive forces, and is an important dimensionless number in convection. <a href="#slim2014">Slim (2014)</a> showed that increasing the Rayleigh number increases the number of flow regimes that the convective mixing process goes through.</p><p>In the dimensionless model implemented in Numbat, the Rayleigh number appears in the vertical position of the bottom boundary only (<a href="#slim2014">Slim, 2014</a>). As a result, it is simple to vary the Rayleigh number in the dimensionless model by simply extending the mesh in the vertical direction.</p><p>In the dimensional model, the Rayleigh number may be varied by changing the various physical parameters present, such as permeability, fluid viscosity etc.</p></section><section class="scrollspy" data-section-text="Mesh   considerations" data-section-level="2" id="e5c346ab-970e-4c9c-a1b4-a9aeb0e33d52"><h2>Mesh considerations</h2><p>The process of density-driven convective mixing in porous media begins initially as diffusive mass transfer across the interface between a saturated fluid lying atop an unsaturated fluid. After a sufficient time, the gravitational instability grows until small downwelling fingers of saturated fluid descend into the unsaturated fluid. As time continues, these fingers grow and merge, forming larger fingers. The temporal evolution of this process is shown in <a class="tooltipped" href="#fig:evolution" data-tooltip="#fig:evolution" data-position="top">Figure 1</a>. The top image shows an initial diffusive profile. As time increases, fingers form, merge and grow in a complex manner.</p><div style="width:90%;margin:auto" id="fig:evolution" class="card"><div class="card-image"><img src="media/evolution.png" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-heading">Figure 1: </span><span class="moose-caption-text">Evolution of convective dissolution (time increasing downwards). Note that the scale is identical for all images.</span></p></div></div><p>It is apparent from the temporal evolution above that the mesh requirements differ in different regimes. Early on and near the top of the mesh, the elements must be sufficiently refined to capture the initial formation of small fingers. Later on, and away from the top boundary, larger elements may adequately capture the large downwelling fingers, and as such, the mesh may be coarser in this region.</p><p>There are two ways that the user may deal with these disparate mesh requirements: use a mesh that is more refined in the vicinity of the top boundary; or use adaptive mesh refinement. Both of these are possible in Numbat.</p><p>Numbat provides a type of <a data-position="top" href="source/mesh/GeneratedMesh.html" class="tooltipped" data-tooltip="source/mesh/GeneratedMesh.html">GeneratedMesh</a> where the elements are biased towards the top boundary, <a data-position="top" href="source/mesh/NumbatBiasedMesh.html" class="tooltipped" data-tooltip="source/mesh/NumbatBiasedMesh.html">NumbatBiasedMesh</a>, so that it is more refined in the vicinity of the constant concentration boundary. This is particularly useful in two dimensions.</p><p>For three-dimensional models, an external meshing code may be used to generate an unstructured mesh. MOOSE can read a number of mesh formats natively, see the <a class="tooltipped" href="http://www.mooseframework.org" data-tooltip="http://www.mooseframework.org" data-position="top">MOOSE</a> documentation for details. One open-source option for generating unstructured meshes that MOOSE can read is <a href="http://www.gmsh.info" data-tooltip="http://www.gmsh.info" data-position="top" class="tooltipped">Gmsh</a>. An example of a fully unstructured 3D mesh that is refined near the top boundary and coarse near the bottom boundary is shown in <a class="tooltipped" href="#fig:unstructuredmesh" data-tooltip="#fig:unstructuredmesh" data-position="top">Figure 2</a>.</p><div style="width:100%;margin:auto" id="fig:unstructuredmesh" class="card"><div class="card-image"><img src="media/unstructuredmesh.png" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-heading">Figure 2: </span><span class="moose-caption-text">Example of unstructured mesh used in Numbat that was generated by Gmsh. Leftmost image shows small section near the top with the concentration profile at an early time; middle image shows top quarter of full mesh and concentration profile at an intermediate time; rightmost image shows full mesh and concentration profile at late time.</span></p></div></div></section><section class="scrollspy" data-section-text="Seeding   the   perturbation" data-section-level="2" id="36692f73-1747-43c9-b107-17bdaf18b425"><h2>Seeding the perturbation</h2><p>Numerical simulations of solutal convection rely on seeding the gravitational instability to initiate the convective mixing process. Numerical roundoff will eventually initiate convective mixing, but can significantly overestimate the critical time for the onset of convection.</p><p>Instead, it is usual to seed the instability using a prescribed random perturbation in the model. Several types of perturbation have been considered in the literature, see <a href="#emami-meybodi2015">Emami-Meybodi et al. (2015)</a> for a detailed review.</p><p>In Numbat, an initial perturbation to seed the instability can be applied in several ways:</p><ul class="browser-default"><li><p>In the dimensional formulation, a random noise sampled from a uniform distribution can be applied to the porosity; </p></li><li><p>In the dimensionless streamfunction formulation, an initial perturbation to the diffusive concentration profile can be applied; </p></li><li><p>A random fluctuation to the concentration boundary condition can be applied.</p></li></ul><p>The strength of the initial perturbation has been shown to affect the initial onset time for convection, see <a href="#emami-meybodi2015">Emami-Meybodi et al. (2015)</a> for details. This should be taken into consideration when modelling convective mixing in porous media.</p></section><section class="scrollspy" data-section-text="References" data-section-level="2" id="d247f48d-8c1b-4b9b-a596-a94aff239123"><h2>References</h2><ol class="moose-bibliogrpahy"><li id="emami-meybodi2015">Hamid Emami-Meybodi, Hassan Hassanzadeh, Christopher&nbsp;P. Green, and Jonathan Ennis-King.
<span class="bibtex-protected">Convective dissolution of CO$_2$ in saline aquifers: Progress in modeling and experiments</span>.
<em>International Journal of Greenhouse Gas Control</em>, 40:238–266, 2015.<a style="padding-left:10px;" href="#365b435f-48df-4e18-856f-31383432da63" class="modal-trigger moose-bibtex-modal">[BibTeX]</a><div id="365b435f-48df-4e18-856f-31383432da63" class="modal"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{emami-meybodi2015,
    author = "Emami-Meybodi, Hamid and Hassanzadeh, Hassan and Green, Christopher P. and Ennis-King, Jonathan",
    title = "{Convective dissolution of CO$\_2$ in saline aquifers: Progress in modeling and experiments}",
    journal = "International Journal of Greenhouse Gas Control",
    volume = "40",
    pages = "238--266",
    year = "2015"
}
</code></pre></div></div></li><li id="slim2014">A.C. Slim.
Solutal-convection regimes in a two-dimensional porous medium.
<em>J. Fluid Mech.</em>, 741:461–491, 2014.<a style="padding-left:10px;" href="#07fd861b-88b5-4d59-8d5f-c11c2690e0ee" class="modal-trigger moose-bibtex-modal">[BibTeX]</a><div id="07fd861b-88b5-4d59-8d5f-c11c2690e0ee" class="modal"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{slim2014,
    author = "Slim, A.C.",
    title = "Solutal-convection regimes in a two-dimensional porous medium",
    journal = "J. Fluid Mech.",
    volume = "741",
    pages = "461--491",
    year = "2014"
}
</code></pre></div></div></li></ol></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a data-delay="1000" data-position="left" href="#bbdecca7-8129-4c50-b60c-7099686f8207" class="tooltipped" data-tooltip="Rayleigh   number">Rayleigh   number</a></li><li><a data-delay="1000" data-position="left" href="#e5c346ab-970e-4c9c-a1b4-a9aeb0e33d52" class="tooltipped" data-tooltip="Mesh   considerations">Mesh   considerations</a></li><li><a data-delay="1000" data-position="left" href="#36692f73-1747-43c9-b107-17bdaf18b425" class="tooltipped" data-tooltip="Seeding   the   perturbation">Seeding   the   perturbation</a></li><li><a data-delay="1000" data-position="left" href="#d247f48d-8c1b-4b9b-a596-a94aff239123" class="tooltipped" data-tooltip="References">References</a></li></ul></div></div></div></div></main></div></body></html>