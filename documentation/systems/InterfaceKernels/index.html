<!DOCTYPE html><html><head><meta charset="UTF-8"><link media="screen,projection" href="../../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet"></link><link href="../../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/moose.css" type="text/css" rel="stylesheet"></link><script src="../../../contrib/jquery/jquery.min.js" type="text/javascript"></script><script src="../../../contrib/materialize/materialize.min.js" type="text/javascript"></script><script src="../../../contrib/clipboard/clipboard.min.js" type="text/javascript"></script><script src="../../../contrib/prism/prism.min.js" type="text/javascript"></script><script src="../../../contrib/katex/katex.min.js" type="text/javascript"></script><script src="../../../contrib/fuse/fuse.min.js" type="text/javascript"></script><script src="../../../js/search_index.js" type="text/javascript"></script><script src="../../../js/init.js" type="text/javascript"></script><title>InterfaceKernels   System|Numbat</title></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://github.com/cpgr/numbat" class="right"><img src="../../../media/github-logo.png" class="github-mark"></img><img src="../../../media/github-mark.png" class="github-logo"></img></a><a href="http://cpgr.github.io/numbat/" class="left moose-logo">Numbat</a><ul class="right hide-on-med-and-down" id="nav-mobile"><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="fd61ce1b-70f3-45db-9ba3-e84c2d91eeb7">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="1fab6356-ed50-437f-93cf-933d2ad34c7a">Theory<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="f42c6a15-eb16-4fb9-a360-d968fdb5e255">Details<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="154e71b6-cdb0-46bf-a4ee-390304f7ac72">Examples<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="bca097b2-740a-49d8-b34f-8f20266ea59e">Manual<i class="material-icons right">arrow_drop_down</i></a></li></ul><ul class="dropdown-content" id="fd61ce1b-70f3-45db-9ba3-e84c2d91eeb7"><li><a href="../../../getting_started.html">Installation</a></li></ul><ul class="dropdown-content" id="1fab6356-ed50-437f-93cf-933d2ad34c7a"><li><a href="../../../introduction.html">Introduction</a></li><li><a href="../../../governing_equations.html">Governing equations</a></li></ul><ul class="dropdown-content" id="f42c6a15-eb16-4fb9-a360-d968fdb5e255"><li><a href="../../../implementation.html">Implementation</a></li><li><a href="../../../input_file_syntax.html">Input file syntax</a></li><li><a href="../../../running_numbat.html">Running Numbat</a></li><li><a href="../../../systems.html">Available objects</a></li></ul><ul class="dropdown-content" id="154e71b6-cdb0-46bf-a4ee-390304f7ac72"><li><a href="../../../example2D.html">2D</a></li><li><a href="../../../example3D.html">3D</a></li></ul><ul class="dropdown-content" id="bca097b2-740a-49d8-b34f-8f20266ea59e"><li><a href="../../../download.html">User manual</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input autocomplete="off" onkeyup="mooseSearch()" type="text" id="moose-search-box"><label for="search">http://cpgr.github.io/numbat/</label></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-action modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><span class="breadcrumb">documentation</span><a href=".." class="breadcrumb">systems</a><a href="." class="breadcrumb">InterfaceKernels</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section data-section-text="InterfaceKernels   System" data-section-level="1" id="43640816-c3d1-49ca-850f-b9567afdb573"><h1>InterfaceKernels System</h1><p>Interface kernels are meant to assist in coupling different physics across sub-domains. The most straightforward example is the case in which one wants to set the flux of a specie A in subdomain 0 equal to the flux of a specie B in subdomain 1 at the boundary between subdomains 0 and 1. In mathematical terms, we might be interested in establishing the condition:</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-1123f05d-fced-4f44-8f8f-e703b6e91665"></span><span class="moose-katex-equation-number">(1)</span><script>var element = document.getElementById("moose-equation-1123f05d-fced-4f44-8f8f-e703b6e91665");katex.render("-D_0 \\frac{\\partial c_0}{\\partial x} = -D_1 \\frac{\\partial c_1}{\\partial x}", element, {displayMode:true,throwOnError:false});</script></span></p><p>where <span class="moose-katex-inline-equation" id="moose-equation-303d359e-1b2f-4c96-9759-ff9285761c0a"><script>var element = document.getElementById("moose-equation-303d359e-1b2f-4c96-9759-ff9285761c0a");katex.render("D_i", element, {displayMode:false,throwOnError:false});</script></span> is the diffusion coefficient of specie <span class="moose-katex-inline-equation" id="moose-equation-8fced9be-2e97-40a4-b079-a6e3088d9bce"><script>var element = document.getElementById("moose-equation-8fced9be-2e97-40a4-b079-a6e3088d9bce");katex.render("i", element, {displayMode:false,throwOnError:false});</script></span> in subdomain <span class="moose-katex-inline-equation" id="moose-equation-504b0305-0b37-4553-97f3-6f0c2827d5b7"><script>var element = document.getElementById("moose-equation-504b0305-0b37-4553-97f3-6f0c2827d5b7");katex.render("i", element, {displayMode:false,throwOnError:false});</script></span>, and <span class="moose-katex-inline-equation" id="moose-equation-a984f326-4939-4c86-868f-81110b0e9545"><script>var element = document.getElementById("moose-equation-a984f326-4939-4c86-868f-81110b0e9545");katex.render("c_i", element, {displayMode:false,throwOnError:false});</script></span> is the concentration of specie <span class="moose-katex-inline-equation" id="moose-equation-0593241d-64f2-4551-b667-a54c2a05268a"><script>var element = document.getElementById("moose-equation-0593241d-64f2-4551-b667-a54c2a05268a");katex.render("i", element, {displayMode:false,throwOnError:false});</script></span> in subdomain <span class="moose-katex-inline-equation" id="moose-equation-642d24c7-42fe-4cd7-b9fc-648c675dcdae"><script>var element = document.getElementById("moose-equation-642d24c7-42fe-4cd7-b9fc-648c675dcdae");katex.render("i", element, {displayMode:false,throwOnError:false});</script></span>. An example of this condition is shown in the MOOSE test directory; see files below:</p><p><a data-position="top" href="#e77f68c4-9e3a-4703-acc8-1fa18aac967b" class="tooltipped modal-trigger" data-tooltip="/Users/gre462/Documents/MOOSE/projects/moose/test/tests/interfacekernels/2d_interface/coupled_value_coupled_flux.i">coupled_value_coupled_flux.i</a></p><p><a data-position="top" href="#3b5d5f8e-30ab-45db-9c33-fe99d581ccb6" class="tooltipped modal-trigger" data-tooltip="/Users/gre462/Documents/MOOSE/projects/moose/test/src/interfacekernels/InterfaceDiffusion.C">InterfaceDiffusion.C</a></p><p><a data-position="top" href="#edda8670-3988-4bf2-85db-3f610d4e6786" class="tooltipped modal-trigger" data-tooltip="/Users/gre462/Documents/MOOSE/projects/moose/test/include/interfacekernels/InterfaceDiffusion.h">InterfaceDiffusion.h</a></p><p>Interface kernels can be used to provide any general flux condition at an interface, and even more generally can be used to impose any interfacial condition that requires access to values of different variables and gradients of different variables on either side of an interface. In an input file, the user will specify at a minimum the following parameters:</p><ul class="browser-default"><li><p><code>type</code>: The type of interface kernel to be used </p></li><li><p><code>variable</code>: This is the "master" variable. Note that the master variable must exist on the same subdomain as the sideset specified in the <code>boundary</code> parameter. The existence of a "master" and "slave" or "neighbor" variable ensures that the interface kernel residual and jacobian functions get called the correct number of times. <code>variable</code> could be <span class="moose-katex-inline-equation" id="moose-equation-aa8e41a0-405e-4ea0-8833-aa9a5a92b4e5"><script>var element = document.getElementById("moose-equation-aa8e41a0-405e-4ea0-8833-aa9a5a92b4e5");katex.render("c_0", element, {displayMode:false,throwOnError:false});</script></span> from our example above. </p></li><li><p><code>neighbor_var</code>: The "slave" variable. This could be <span class="moose-katex-inline-equation" id="moose-equation-1302a366-7096-4e1f-9402-03ac8c8a5d30"><script>var element = document.getElementById("moose-equation-1302a366-7096-4e1f-9402-03ac8c8a5d30");katex.render("c_1", element, {displayMode:false,throwOnError:false});</script></span> from our example above. </p></li><li><p><code>boundary</code>: The interfacial boundary between the subdomains. Note that this must be a sideset and again must exist on the same subdomain as the master variable. The fact that this boundary is a sideset allows access to variable gradients.</p></li></ul><p>For additional information about the interface kernel system, don't hesitate to email the moose list at <a href="mailto:moose-users@googlegroups.com" data-tooltip="mailto:moose-users@googlegroups.com" data-position="top" class="tooltipped">moose-users@googlegroups.com</a>.</p><ul class="collection with-header"><li class="moose-syntax-actions collection-item"><a href="AddInterfaceKernelAction.html" class="moose-syntax-actions-name">AddInterfaceKernelAction</a></li></ul></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"></ul></div></div></div></div></main></div><div id="e77f68c4-9e3a-4703-acc8-1fa18aac967b" class="modal bottom-sheet"><div class="modal-content"><h4>/Users/gre462/Documents/MOOSE/projects/moose/test/tests/interfacekernels/2d_interface/coupled_value_coupled_flux.i</h4><pre><code class="language-text">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 2
  xmax = 2
  ny = 2
  ymax = 2
[]

[MeshModifiers]
  [./subdomain1]
    type = SubdomainBoundingBox
    bottom_left = '0 0 0'
    top_right = '1 1 0'
    block_id = 1
  [../]
  [./interface]
    type = SideSetsBetweenSubdomains
    depends_on = subdomain1
    master_block = '0'
    paired_block = '1'
    new_boundary = 'master0_interface'
  [../]
  [./break_boundary]
    depends_on = interface
    type = BreakBoundaryOnSubdomain
  [../]
[]

[Variables]
  [./u]
    order = FIRST
    family = LAGRANGE
    block = 0
  [../]

  [./v]
    order = FIRST
    family = LAGRANGE
    block = 1
  [../]
[]

[Kernels]
  [./diff_u]
    type = CoeffParamDiffusion
    variable = u
    D = 4
    block = 0
  [../]
  [./diff_v]
    type = CoeffParamDiffusion
    variable = v
    D = 2
    block = 1
  [../]
  [./source_u]
    type = BodyForce
    variable = u
    value = 1
  [../]
[]

[InterfaceKernels]
  [./interface]
    type = InterfaceDiffusion
    variable = u
    neighbor_var = v
    boundary = master0_interface
    D = 4
    D_neighbor = 2
  [../]
[]

[BCs]
  [./u]
    type = VacuumBC
    variable = u
    boundary = 'left_to_0 bottom_to_0 right top'
  [../]
  [./v]
    type = VacuumBC
    variable = v
    boundary = 'left_to_1 bottom_to_1'
  [../]
  [./middle]
    type = MatchedValueBC
    variable = v
    boundary = 'master0_interface'
    v = u
  [../]
[]

[Postprocessors]
  [./u_int]
    type = ElementIntegralVariablePostprocessor
    variable = u
    block = 0
  [../]
  [./v_int]
    type = ElementIntegralVariablePostprocessor
    variable = v
    block = 1
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Steady
  solve_type = NEWTON
[]

[Outputs]
  exodus = true
  print_linear_residuals = true
[]
</code></pre></div></div><div id="3b5d5f8e-30ab-45db-9c33-fe99d581ccb6" class="modal bottom-sheet"><div class="modal-content"><h4>/Users/gre462/Documents/MOOSE/projects/moose/test/src/interfacekernels/InterfaceDiffusion.C</h4><pre><code class="language-cpp">// This file is part of the MOOSE framework
// https://www.mooseframework.org
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;InterfaceDiffusion.h&quot;

#include &lt;cmath&gt;

registerMooseObject(&quot;MooseTestApp&quot;, InterfaceDiffusion);

template &lt;&gt;
InputParameters
validParams&lt;InterfaceDiffusion&gt;()
{
  InputParameters params = validParams&lt;InterfaceKernel&gt;();
  params.addParam&lt;MaterialPropertyName&gt;(&quot;D&quot;, &quot;D&quot;, &quot;The diffusion coefficient.&quot;);
  params.addParam&lt;MaterialPropertyName&gt;(
      &quot;D_neighbor&quot;, &quot;D_neighbor&quot;, &quot;The neighboring diffusion coefficient.&quot;);
  return params;
}

InterfaceDiffusion::InterfaceDiffusion(const InputParameters &amp; parameters)
  : InterfaceKernel(parameters),
    _D(getMaterialProperty&lt;Real&gt;(&quot;D&quot;)),
    _D_neighbor(getMaterialProperty&lt;Real&gt;(&quot;D_neighbor&quot;))
{
}

Real
InterfaceDiffusion::computeQpResidual(Moose::DGResidualType type)
{
  Real r = 0.5 * (-_D[_qp] * _grad_u[_qp] * _normals[_qp] +
                  -_D_neighbor[_qp] * _grad_neighbor_value[_qp] * _normals[_qp]);

  switch (type)
  {
    case Moose::Element:
      r *= _test[_i][_qp];
      break;

    case Moose::Neighbor:
      r *= -_test_neighbor[_i][_qp];
      break;
  }

  return r;
}

Real
InterfaceDiffusion::computeQpJacobian(Moose::DGJacobianType type)
{
  Real jac = 0;

  switch (type)
  {

    case Moose::ElementElement:
      jac -= 0.5 * _D[_qp] * _grad_phi[_j][_qp] * _normals[_qp] * _test[_i][_qp];
      break;

    case Moose::NeighborNeighbor:
      jac += 0.5 * _D_neighbor[_qp] * _grad_phi_neighbor[_j][_qp] * _normals[_qp] *
             _test_neighbor[_i][_qp];
      break;

    case Moose::NeighborElement:
      jac += 0.5 * _D[_qp] * _grad_phi[_j][_qp] * _normals[_qp] * _test_neighbor[_i][_qp];
      break;

    case Moose::ElementNeighbor:
      jac -= 0.5 * _D_neighbor[_qp] * _grad_phi_neighbor[_j][_qp] * _normals[_qp] * _test[_i][_qp];
      break;
  }

  return jac;
}
</code></pre></div></div><div id="edda8670-3988-4bf2-85db-3f610d4e6786" class="modal bottom-sheet"><div class="modal-content"><h4>/Users/gre462/Documents/MOOSE/projects/moose/test/include/interfacekernels/InterfaceDiffusion.h</h4><pre><code class="language-cpp">// This file is part of the MOOSE framework
// https://www.mooseframework.org
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#ifndef INTERFACEDIFFUSION_H
#define INTERFACEDIFFUSION_H

#include &quot;InterfaceKernel.h&quot;

// Forward Declarations
class InterfaceDiffusion;

template &lt;&gt;
InputParameters validParams&lt;InterfaceDiffusion&gt;();

/**
 * DG kernel for interfacing diffusion between two variables on adjacent blocks
 */
class InterfaceDiffusion : public InterfaceKernel
{
public:
  InterfaceDiffusion(const InputParameters &amp; parameters);

protected:
  virtual Real computeQpResidual(Moose::DGResidualType type);
  virtual Real computeQpJacobian(Moose::DGJacobianType type);

  const MaterialProperty&lt;Real&gt; &amp; _D;
  const MaterialProperty&lt;Real&gt; &amp; _D_neighbor;
};

#endif
</code></pre></div></div></body></html>