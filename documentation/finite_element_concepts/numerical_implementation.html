<!DOCTYPE html><html><head><meta charset="UTF-8"><link media="screen,projection" href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><script src="../../contrib/jquery/jquery.min.js" type="text/javascript"></script><script src="../../contrib/materialize/materialize.min.js" type="text/javascript"></script><script src="../../contrib/clipboard/clipboard.min.js" type="text/javascript"></script><script src="../../contrib/prism/prism.min.js" type="text/javascript"></script><script src="../../contrib/katex/katex.min.js" type="text/javascript"></script><script src="../../contrib/fuse/fuse.min.js" type="text/javascript"></script><script src="../../js/search_index.js" type="text/javascript"></script><script src="../../js/init.js" type="text/javascript"></script><title>Numerical   Integration|Numbat</title></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://github.com/cpgr/numbat" class="right"><img src="../../media/github-logo.png" class="github-mark"></img><img src="../../media/github-mark.png" class="github-logo"></img></a><a href="http://cpgr.github.io/numbat/" class="left moose-logo">Numbat</a><ul class="right hide-on-med-and-down" id="nav-mobile"><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="1930f6e6-518a-4cb6-8aea-71bff4efaaa6">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="6fd6cb25-ff52-46a4-b9e8-48854eec575e">Theory<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="c93783a2-aacc-4774-bd74-1a5053f981dc">Details<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="f8ef3b41-b361-451e-bdff-489b71d8315c">Examples<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="2a3b1240-b0f2-4b99-9098-baa10d245487">Manual<i class="material-icons right">arrow_drop_down</i></a></li></ul><ul class="dropdown-content" id="1930f6e6-518a-4cb6-8aea-71bff4efaaa6"><li><a href="../../getting_started.html">Installation</a></li></ul><ul class="dropdown-content" id="6fd6cb25-ff52-46a4-b9e8-48854eec575e"><li><a href="../../introduction.html">Introduction</a></li><li><a href="../../governing_equations.html">Governing equations</a></li></ul><ul class="dropdown-content" id="c93783a2-aacc-4774-bd74-1a5053f981dc"><li><a href="../../implementation.html">Implementation</a></li><li><a href="../../input_file_syntax.html">Input file syntax</a></li><li><a href="../../running_numbat.html">Running Numbat</a></li><li><a href="../../systems.html">Available objects</a></li></ul><ul class="dropdown-content" id="f8ef3b41-b361-451e-bdff-489b71d8315c"><li><a href="../../example2D.html">2D</a></li><li><a href="../../example3D.html">3D</a></li></ul><ul class="dropdown-content" id="2a3b1240-b0f2-4b99-9098-baa10d245487"><li><a href="../../download.html">User manual</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input autocomplete="off" onkeyup="mooseSearch()" type="text" id="moose-search-box"><label for="search">http://cpgr.github.io/numbat/</label></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-action modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><span class="breadcrumb">documentation</span><a href="." class="breadcrumb">finite_element_concepts</a><a href="numerical_implementation.html" class="breadcrumb">numerical_implementation</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section data-section-text="Numerical   Integration" data-section-level="1" id="22058a74-22c9-4018-a89e-bea5384e1633"><h1>Numerical Integration</h1><ul class="browser-default"><li><p>The only remaining non-discretized parts of the weak form are the integrals. </p></li><li><p>We split the domain integral into a sum of integrals over elements: <span class="moose-katex-inline-equation" id="moose-equation-86ade42e-9065-4207-9144-11eefbe06023"><script>var element = document.getElementById("moose-equation-86ade42e-9065-4207-9144-11eefbe06023");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-f74b26ff-8cf7-46e6-93ec-85eb635cbcd4"><script>var element = document.getElementById("moose-equation-f74b26ff-8cf7-46e6-93ec-85eb635cbcd4");katex.render("\\int_{\\Omega} f(\\vec{x}) \\;\\text{d}\\vec{x} = \\sum_e \\int_{\\Omega_e} f(\\vec{x}) \\;\\text{d}\\vec{x}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-faf70fdd-8f8a-41bb-979a-f9a07e92b065"><script>var element = document.getElementById("moose-equation-faf70fdd-8f8a-41bb-979a-f9a07e92b065");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> </p></li><li><p>Through a change of variables, the element integrals are mapped to integrals over the "reference" elements <span class="moose-katex-inline-equation" id="moose-equation-37bff186-39b2-487b-a6a5-3de36aa06ef1"><script>var element = document.getElementById("moose-equation-37bff186-39b2-487b-a6a5-3de36aa06ef1");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-3c0f53ee-ed7c-41df-8a33-32d44a25cc57"><script>var element = document.getElementById("moose-equation-3c0f53ee-ed7c-41df-8a33-32d44a25cc57");katex.render("\\hat{\\Omega}_e", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-a3c11bba-fbc9-45d9-8068-06c0f1dd2967"><script>var element = document.getElementById("moose-equation-a3c11bba-fbc9-45d9-8068-06c0f1dd2967");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>. <span class="moose-katex-inline-equation" id="moose-equation-7560299d-d62e-4e01-a181-5f2b3ab46257"><script>var element = document.getElementById("moose-equation-7560299d-d62e-4e01-a181-5f2b3ab46257");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-3aaafb19-9116-4084-b629-484ca7df1725"><script>var element = document.getElementById("moose-equation-3aaafb19-9116-4084-b629-484ca7df1725");katex.render("\\sum_e \\int_{\\Omega_e} f(\\vec{x}) \\;\\text{d}\\vec{x} =       \\sum_e \\int_{\\hat{\\Omega}_e} f(\\vec{\\xi}) \\left|\\mathcal{J}_e\\right| \\;\\text{d}\\vec{\\xi}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-d4c48095-2ff3-4c4f-ae2b-e4900f721988"><script>var element = document.getElementById("moose-equation-d4c48095-2ff3-4c4f-ae2b-e4900f721988");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> </p></li><li><p><span class="moose-katex-inline-equation" id="moose-equation-d3a3b1e7-be11-4a82-887b-cc1bc49cf7c0"><script>var element = document.getElementById("moose-equation-d3a3b1e7-be11-4a82-887b-cc1bc49cf7c0");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-e2d53afa-e1b1-40c7-8207-4d7e375e0ad8"><script>var element = document.getElementById("moose-equation-e2d53afa-e1b1-40c7-8207-4d7e375e0ad8");katex.render("\\mathcal{J}_e", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-a42d25af-255f-4dff-bf25-9ac1a08fddf4"><script>var element = document.getElementById("moose-equation-a42d25af-255f-4dff-bf25-9ac1a08fddf4");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> is the Jacobian of the map from the physical element to the reference element. </p></li><li><p>To approximate the reference element integrals numerically, we use quadrature (typically "Gaussian Quadrature"): <span class="moose-katex-inline-equation" id="moose-equation-f906f787-6216-4e4c-b62f-79bc4936a845"><script>var element = document.getElementById("moose-equation-f906f787-6216-4e4c-b62f-79bc4936a845");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-8d7c71c1-7384-4714-98a9-dc692f1555de"><script>var element = document.getElementById("moose-equation-8d7c71c1-7384-4714-98a9-dc692f1555de");katex.render("\\sum_e \\int_{\\hat{\\Omega}_e} f(\\vec{\\xi}) \\left|\\mathcal{J}_e\\right| \\;\\text{d}\\vec{\\xi} \\approx       \\sum_e \\sum_{q} w_{q} f( \\vec{x}_{q}) \\left|\\mathcal{J}_e(\\vec{x}_{q})\\right|", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-efa8c0bb-25dc-4710-98ee-49a45696b20d"><script>var element = document.getElementById("moose-equation-efa8c0bb-25dc-4710-98ee-49a45696b20d");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> </p></li><li><p><span class="moose-katex-inline-equation" id="moose-equation-39027e40-e303-4080-9c76-4238cfe5a07f"><script>var element = document.getElementById("moose-equation-39027e40-e303-4080-9c76-4238cfe5a07f");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-55cd2666-f086-4d9f-9cce-a215c82adae8"><script>var element = document.getElementById("moose-equation-55cd2666-f086-4d9f-9cce-a215c82adae8");katex.render("\\vec{x}_{q}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-83ad57a5-fa10-410d-9c77-2ae6d2883aa2"><script>var element = document.getElementById("moose-equation-83ad57a5-fa10-410d-9c77-2ae6d2883aa2");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> is the spatial location of the <span class="moose-katex-inline-equation" id="moose-equation-92eaab29-c4ec-43ab-8a5c-fde6c00bbd8d"><script>var element = document.getElementById("moose-equation-92eaab29-c4ec-43ab-8a5c-fde6c00bbd8d");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-6618a8de-91be-406d-acf9-5d4317481cbb"><script>var element = document.getElementById("moose-equation-6618a8de-91be-406d-acf9-5d4317481cbb");katex.render("q", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-cf8339a8-6188-4833-87e2-6f78c607d84c"><script>var element = document.getElementById("moose-equation-cf8339a8-6188-4833-87e2-6f78c607d84c");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>th quadrature point and <span class="moose-katex-inline-equation" id="moose-equation-a927cffa-2dd6-4987-808f-b02b57927771"><script>var element = document.getElementById("moose-equation-a927cffa-2dd6-4987-808f-b02b57927771");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-139ba31c-74e2-4cc1-a038-9e414b0ae818"><script>var element = document.getElementById("moose-equation-139ba31c-74e2-4cc1-a038-9e414b0ae818");katex.render("w_{q}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-57571a8a-ed42-492f-93a0-8fa03df974f9"><script>var element = document.getElementById("moose-equation-57571a8a-ed42-492f-93a0-8fa03df974f9");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> is its associated weight. </p></li><li><p>MOOSE handles multiplication by the Jacobian and the weight automatically, thus your <code>Kernel</code> is only responsible for computing the <span class="moose-katex-inline-equation" id="moose-equation-9fb794c2-0d89-4b89-9a5c-8fe37b4fac06"><script>var element = document.getElementById("moose-equation-9fb794c2-0d89-4b89-9a5c-8fe37b4fac06");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-e1a6d4f3-cfa9-4736-8390-986bb37f064f"><script>var element = document.getElementById("moose-equation-e1a6d4f3-cfa9-4736-8390-986bb37f064f");katex.render("f(\\vec{x}_{q})", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-27890862-4d57-4c6a-b79d-8d17100fc2ad"><script>var element = document.getElementById("moose-equation-27890862-4d57-4c6a-b79d-8d17100fc2ad");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> part of the integrand. </p></li><li><p>Under certain common situations, the quadrature approximation is exact!  - For example, in 1 dimension, Gaussian Quadrature can exactly integrate polynomials of order <span class="moose-katex-inline-equation" id="moose-equation-ded36001-6e43-4155-a560-abe362f28b61"><script>var element = document.getElementById("moose-equation-ded36001-6e43-4155-a560-abe362f28b61");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-194eeba6-5949-45e6-96b5-0b34788f1641"><script>var element = document.getElementById("moose-equation-194eeba6-5949-45e6-96b5-0b34788f1641");katex.render("2n-1", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-86572c78-5ff3-428f-9a46-cbb3fb003e6d"><script>var element = document.getElementById("moose-equation-86572c78-5ff3-428f-9a46-cbb3fb003e6d");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> with <span class="moose-katex-inline-equation" id="moose-equation-e52706f9-8de8-4089-b2f0-93fbf9de19f0"><script>var element = document.getElementById("moose-equation-e52706f9-8de8-4089-b2f0-93fbf9de19f0");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-21d8894a-1b18-4fea-9c3a-4bf14af965bf"><script>var element = document.getElementById("moose-equation-21d8894a-1b18-4fea-9c3a-4bf14af965bf");katex.render("n", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-76d08c8e-8e96-412d-ae4e-e1986d84d33a"><script>var element = document.getElementById("moose-equation-76d08c8e-8e96-412d-ae4e-e1986d84d33a");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> quadrature points. </p></li><li><p>Note that sampling <span class="moose-katex-inline-equation" id="moose-equation-0eb0d92a-c61b-4c00-8c97-c4ef47287ac1"><script>var element = document.getElementById("moose-equation-0eb0d92a-c61b-4c00-8c97-c4ef47287ac1");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-7da6de81-a6aa-4759-be54-201ab4db91e5"><script>var element = document.getElementById("moose-equation-7da6de81-a6aa-4759-be54-201ab4db91e5");katex.render("u_h", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-6c43671d-3b97-4991-81b0-3dd74c70dd0c"><script>var element = document.getElementById("moose-equation-6c43671d-3b97-4991-81b0-3dd74c70dd0c");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> at the quadrature points yields:  <span class="moose-katex-inline-equation" id="moose-equation-d397d6e0-9d2c-42c1-a4b9-844797875e14"><script>var element = document.getElementById("moose-equation-d397d6e0-9d2c-42c1-a4b9-844797875e14");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-ed80bcfe-96d6-4b53-89db-fb5a5ffa978a"><script>var element = document.getElementById("moose-equation-ed80bcfe-96d6-4b53-89db-fb5a5ffa978a");katex.render("\\begin{aligned}   u(\\vec{x}_{q}) &\\approx u_h(\\vec{x}_{q}) = \\sum u_j \\phi_j(\\vec{x}_{q}) \\\\   \\nabla u (\\vec{x}_{q}) &\\approx \\nabla u_h(\\vec{x}_{q}) = \\sum u_j \\nabla \\phi_j(\\vec{x}_{q})\\end{aligned}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-212f54c5-e722-4289-9993-2e8ce4475c23"><script>var element = document.getElementById("moose-equation-212f54c5-e722-4289-9993-2e8ce4475c23");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> </p></li><li><p>And our weak form becomes: <span class="moose-katex-inline-equation" id="moose-equation-7a2d21f1-b7a7-49ed-9f0e-553cfe2e3a34"><script>var element = document.getElementById("moose-equation-7a2d21f1-b7a7-49ed-9f0e-553cfe2e3a34");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-5e128d8e-d07a-4a02-9c46-d7fa1369266d"><script>var element = document.getElementById("moose-equation-5e128d8e-d07a-4a02-9c46-d7fa1369266d");katex.render("\\begin{aligned} R_i(u_h) &= \\sum_e \\sum_{q} w_{q} \\left|\\mathcal{J}_e\\right|\\left[ \\nabla\\psi_i\\cdot k \\nabla u_h + \\psi_i \\left(\\vec\\beta\\cdot \\nabla u_h \\right) - \\psi_i f \\right](\\vec{x}_{q}) \\\\ &- \\sum_f \\sum_{q_{face}} w_{q_{face}} \\left|\\mathcal{J}_f\\right| \\left[\\psi_i k \\nabla u_h \\cdot \\vec{n} \\right](\\vec x_{q_{face}}) \\end{aligned}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-9b5e594d-cbcb-4169-8434-f924206a9ddc"><script>var element = document.getElementById("moose-equation-9b5e594d-cbcb-4169-8434-f924206a9ddc");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> </p></li><li><p>The second sum is over boundary faces, <span class="moose-katex-inline-equation" id="moose-equation-b1f1330e-4c7d-4a4b-8040-181c133b88a7"><script>var element = document.getElementById("moose-equation-b1f1330e-4c7d-4a4b-8040-181c133b88a7");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-96555e59-784e-4807-bdd1-2024f8283b02"><script>var element = document.getElementById("moose-equation-96555e59-784e-4807-bdd1-2024f8283b02");katex.render("f", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-7b79fbed-6ea3-4ead-a983-8b2384d4bf99"><script>var element = document.getElementById("moose-equation-7b79fbed-6ea3-4ead-a983-8b2384d4bf99");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>. </p></li><li><p>MOOSE <code>Kernels</code> must provide each of the terms in square brackets (evaluated at <span class="moose-katex-inline-equation" id="moose-equation-3e698137-b9d6-4355-aa82-82874702d9f3"><script>var element = document.getElementById("moose-equation-3e698137-b9d6-4355-aa82-82874702d9f3");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-6e6bc803-ccbe-4061-b528-9af723c66787"><script>var element = document.getElementById("moose-equation-6e6bc803-ccbe-4061-b528-9af723c66787");katex.render("\\vec{x}_{q}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-e9ed13d8-cc14-4850-931f-8efa5f4aaace"><script>var element = document.getElementById("moose-equation-e9ed13d8-cc14-4850-931f-8efa5f4aaace");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> or <span class="moose-katex-inline-equation" id="moose-equation-6c22f6e5-50a1-4997-8ebc-170e15d0de61"><script>var element = document.getElementById("moose-equation-6c22f6e5-50a1-4997-8ebc-170e15d0de61");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-46363568-c4eb-46e0-855a-0aa6a1c4baab"><script>var element = document.getElementById("moose-equation-46363568-c4eb-46e0-855a-0aa6a1c4baab");katex.render("\\vec x_{q_{face}}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-ff741dd3-f304-44ad-b751-d0046ce2cbd1"><script>var element = document.getElementById("moose-equation-ff741dd3-f304-44ad-b751-d0046ce2cbd1");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> as necessary).</p></li></ul></section><section data-section-text="Newton ' s   Method" data-section-level="1" id="62b6ea52-be5c-4057-aa42-08a70fd49ec5"><h1>Newton's Method</h1><ul class="browser-default"><li><p>We now have a nonlinear system of equations, <span class="moose-katex-inline-equation" id="moose-equation-6a792e33-4211-4bd1-974b-bd78dd13d461"><script>var element = document.getElementById("moose-equation-6a792e33-4211-4bd1-974b-bd78dd13d461");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-bf8721f9-dc7f-4c56-b070-d1ac3349fffd"><script>var element = document.getElementById("moose-equation-bf8721f9-dc7f-4c56-b070-d1ac3349fffd");katex.render("R_i(u_h)=0, \\qquad i=1,\\ldots, N", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-b8e96318-f9a9-4b5f-92d0-1f18d8ca32f6"><script>var element = document.getElementById("moose-equation-b8e96318-f9a9-4b5f-92d0-1f18d8ca32f6");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> to solve for the coefficients <span class="moose-katex-inline-equation" id="moose-equation-2e77e091-fcb2-4946-943f-c77b0d4398e8"><script>var element = document.getElementById("moose-equation-2e77e091-fcb2-4946-943f-c77b0d4398e8");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-aba699a9-2208-42ec-973e-e7cba1431870"><script>var element = document.getElementById("moose-equation-aba699a9-2208-42ec-973e-e7cba1431870");katex.render("u_j, j=1,\\dots,N", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-5dc03f94-011e-4db0-b3ac-22380da1f639"><script>var element = document.getElementById("moose-equation-5dc03f94-011e-4db0-b3ac-22380da1f639");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>.</p><p></p></li><li><p>Newton's method has good convergence properties, we use it to solve this system of nonlinear equations. </p></li><li><p>Newton's method is a "root finding" method: it finds zeros of nonlinear equations. </p></li><li><p>Newton's Method in "Update Form" for finding roots of the scalar equation <span class="moose-katex-inline-equation" id="moose-equation-e26b0c7f-2946-4b1a-9da1-43bd8eb7e009"><script>var element = document.getElementById("moose-equation-e26b0c7f-2946-4b1a-9da1-43bd8eb7e009");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-f87fe89e-87af-4e60-a904-5399f226ff1b"><script>var element = document.getElementById("moose-equation-f87fe89e-87af-4e60-a904-5399f226ff1b");katex.render("\\begin{array}{rl}f(x)&=0, f(x): \\mathbb{R} &\\rightarrow \\mathbb{R}\\textrm{ is given by}:\\\\ f\'(x_n) \\delta x_{n+1} &= -f(x_n) \\\\ x_{n+1} &= x_n + \\delta x_{n+1}\\end{array}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-5cc2ca6b-b4e1-4195-bf05-855645459527"><script>var element = document.getElementById("moose-equation-5cc2ca6b-b4e1-4195-bf05-855645459527");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> </p></li><li><p>We don't have just one scalar equation: we have a system of nonlinear equations. </p></li><li><p>This leads to the following form of Newton's Method:</p><p> <span class="moose-katex-inline-equation" id="moose-equation-0d83eeb8-6d07-4391-88df-47f081f7fdb5"><script>var element = document.getElementById("moose-equation-0d83eeb8-6d07-4391-88df-47f081f7fdb5");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-bdc88adb-124f-4b93-a430-6cf0375787bf"><script>var element = document.getElementById("moose-equation-bdc88adb-124f-4b93-a430-6cf0375787bf");katex.render("\\begin{aligned}   \\mathbf{J}(\\vec{u}_n) \\delta\\vec{u}_{n+1} &= -\\vec{R}(\\vec{u}_n) \\\\   \\vec{u}_{n+1} &= \\vec{u}_n + \\delta\\vec{u}_{n+1}\\end{aligned}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-38196089-d743-452d-b1ca-2e4e39b429be"><script>var element = document.getElementById("moose-equation-38196089-d743-452d-b1ca-2e4e39b429be");katex.render("", element, {displayMode:false,throwOnError:false});</script></span></p><p></p></li><li><p>Where <span class="moose-katex-inline-equation" id="moose-equation-a5f49377-c428-4066-b603-3c1af800744c"><script>var element = document.getElementById("moose-equation-a5f49377-c428-4066-b603-3c1af800744c");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-f8173d6a-da64-4140-9711-20b09d1320fe"><script>var element = document.getElementById("moose-equation-f8173d6a-da64-4140-9711-20b09d1320fe");katex.render("\\mathbf{J}(\\vec{u}_n)", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-cc1a1a2b-f175-4eec-b459-728d481bae7d"><script>var element = document.getElementById("moose-equation-cc1a1a2b-f175-4eec-b459-728d481bae7d");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> is the Jacobian matrix evaluated at the current iterate:  <span class="moose-katex-inline-equation" id="moose-equation-a39a0345-93d7-447a-8662-cd0f593c29ea"><script>var element = document.getElementById("moose-equation-a39a0345-93d7-447a-8662-cd0f593c29ea");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-3f59add1-530f-4c2b-a6a3-b49903bc189c"><script>var element = document.getElementById("moose-equation-3f59add1-530f-4c2b-a6a3-b49903bc189c");katex.render("J_{ij}(\\vec{u}_n) = \\frac{\\partial R_i(\\vec{u}_n)}{\\partial u_j}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-2a1831cb-a822-4d27-a9c2-cc56e7fccd94"><script>var element = document.getElementById("moose-equation-2a1831cb-a822-4d27-a9c2-cc56e7fccd94");katex.render("", element, {displayMode:false,throwOnError:false});</script></span></p><p></p></li><li><p>Note that:  <span class="moose-katex-inline-equation" id="moose-equation-6d348dba-d04f-4e23-857e-b584c7069543"><script>var element = document.getElementById("moose-equation-6d348dba-d04f-4e23-857e-b584c7069543");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-e3eae1cb-43cc-42b9-a5c5-e5a7252fddaf"><script>var element = document.getElementById("moose-equation-e3eae1cb-43cc-42b9-a5c5-e5a7252fddaf");katex.render("\\frac{\\partial u_h}{\\partial u_j} =     \\sum_k\\frac{\\partial }{\\partial u_j}\\left(u_k \\phi_k\\right) = \\phi_j   \\qquad   \\frac{\\partial \\left(\\nabla u_h\\right)}{\\partial u_j} =     \\sum_k \\frac{\\partial }{\\partial u_j}\\left(u_k \\nabla \\phi_k\\right) = \\nabla \\phi_j", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-49293ac5-04b7-436c-bf41-590d47f0809f"><script>var element = document.getElementById("moose-equation-49293ac5-04b7-436c-bf41-590d47f0809f");katex.render("", element, {displayMode:false,throwOnError:false});</script></span></p></li></ul></section><section data-section-text="Newton   for   a   Simple   Equation" data-section-level="1" id="7c1049fc-5c26-429e-a990-5c89fefca80e"><h1>Newton for a Simple Equation</h1><ul class="browser-default"><li><p>Consider the convection-diffusion equation with nonlinear <span class="moose-katex-inline-equation" id="moose-equation-de30f573-b782-4945-bc2d-ba670bda806f"><script>var element = document.getElementById("moose-equation-de30f573-b782-4945-bc2d-ba670bda806f");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-3983dea5-05ef-4bb5-9d37-e360ca02975a"><script>var element = document.getElementById("moose-equation-3983dea5-05ef-4bb5-9d37-e360ca02975a");katex.render("k", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-9b84b20b-3b24-4324-825c-8b3e64b9afc2"><script>var element = document.getElementById("moose-equation-9b84b20b-3b24-4324-825c-8b3e64b9afc2");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-18d8e4da-b3e5-4ebe-b77c-a5dd4a9fa9da"><script>var element = document.getElementById("moose-equation-18d8e4da-b3e5-4ebe-b77c-a5dd4a9fa9da");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-66bee221-7011-4c11-bae5-57419c7e29e6"><script>var element = document.getElementById("moose-equation-66bee221-7011-4c11-bae5-57419c7e29e6");katex.render("\\vec{\\beta}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-4eff6540-634b-4ef3-b930-4aa304a7b0aa"><script>var element = document.getElementById("moose-equation-4eff6540-634b-4ef3-b930-4aa304a7b0aa");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>, and <span class="moose-katex-inline-equation" id="moose-equation-1ff390f2-e8e9-49ef-a4b1-d98124396b31"><script>var element = document.getElementById("moose-equation-1ff390f2-e8e9-49ef-a4b1-d98124396b31");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-48ebebac-637c-4e17-a476-3afabb32607e"><script>var element = document.getElementById("moose-equation-48ebebac-637c-4e17-a476-3afabb32607e");katex.render("f", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-d46de7f9-584b-461a-be17-b61ab8d310cb"><script>var element = document.getElementById("moose-equation-d46de7f9-584b-461a-be17-b61ab8d310cb");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>:  <span class="moose-katex-inline-equation" id="moose-equation-67a59d90-8834-47e2-bfdd-e7abf8d8add8"><script>var element = document.getElementById("moose-equation-67a59d90-8834-47e2-bfdd-e7abf8d8add8");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-ea7d7edd-1b55-4d60-bd74-2180584a28c0"><script>var element = document.getElementById("moose-equation-ea7d7edd-1b55-4d60-bd74-2180584a28c0");katex.render("\\begin{aligned}- \\nabla\\cdot k\\nabla u + \\vec{\\beta} \\cdot \\nabla u = f\\end{aligned}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-a042a72c-a6d0-4fe7-bfbf-decf8eb9ff27"><script>var element = document.getElementById("moose-equation-a042a72c-a6d0-4fe7-bfbf-decf8eb9ff27");katex.render("", element, {displayMode:false,throwOnError:false});</script></span></p><p></p></li><li><p>The <span class="moose-katex-inline-equation" id="moose-equation-893dcb9e-862b-4f4c-9371-f662363f2bc0"><script>var element = document.getElementById("moose-equation-893dcb9e-862b-4f4c-9371-f662363f2bc0");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-46aab6be-42ab-4d59-94c4-34aeee20ab65"><script>var element = document.getElementById("moose-equation-46aab6be-42ab-4d59-94c4-34aeee20ab65");katex.render("i^{th}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-4a28921e-f270-48c7-a26d-80ea792b2c63"><script>var element = document.getElementById("moose-equation-4a28921e-f270-48c7-a26d-80ea792b2c63");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> component of the residual vector is:  <span class="moose-katex-inline-equation" id="moose-equation-afa588d5-39f0-41bd-bc0a-9fb158feef2d"><script>var element = document.getElementById("moose-equation-afa588d5-39f0-41bd-bc0a-9fb158feef2d");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-9517667b-b3c4-4050-aac5-39d2add2c2de"><script>var element = document.getElementById("moose-equation-9517667b-b3c4-4050-aac5-39d2add2c2de");katex.render("\\begin{aligned}   R_i(u_h) = \\left(\\nabla\\psi_i, k\\nabla u_h \\right) - \\langle\\psi_i, k\\nabla u_h\\cdot \\hat{n} \\rangle +   \\left(\\psi_i, \\vec{\\beta} \\cdot \\nabla u_h\\right) - \\left(\\psi_i, f\\right)\\end{aligned}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-2ded09cc-282e-4078-b004-4b1c0ef8061f"><script>var element = document.getElementById("moose-equation-2ded09cc-282e-4078-b004-4b1c0ef8061f");katex.render("", element, {displayMode:false,throwOnError:false});</script></span></p></li></ul><ul class="browser-default"><li><p>Using the previously-defined rules for <span class="moose-katex-inline-equation" id="moose-equation-e9bfd379-7a5d-42b0-8c93-ed3d73b0ab3b"><script>var element = document.getElementById("moose-equation-e9bfd379-7a5d-42b0-8c93-ed3d73b0ab3b");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-21fe3e6c-6ff2-44b2-92de-d56de9b6f7a8"><script>var element = document.getElementById("moose-equation-21fe3e6c-6ff2-44b2-92de-d56de9b6f7a8");katex.render("\\frac{\\partial u_h}{\\partial u_j}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-1deeba01-f6c1-4492-9f68-36035b328d20"><script>var element = document.getElementById("moose-equation-1deeba01-f6c1-4492-9f68-36035b328d20");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> and <span class="moose-katex-inline-equation" id="moose-equation-a219c1e0-ed71-4039-a27c-a7f39dc41537"><script>var element = document.getElementById("moose-equation-a219c1e0-ed71-4039-a27c-a7f39dc41537");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-685192c8-ef51-4047-a0a6-61be9fdd12fa"><script>var element = document.getElementById("moose-equation-685192c8-ef51-4047-a0a6-61be9fdd12fa");katex.render("\\frac{\\partial \\left(\\nabla u_h\\right)}{\\partial u_j}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-9cffd2e3-8388-4cc7-b674-6aed9b874146"><script>var element = document.getElementById("moose-equation-9cffd2e3-8388-4cc7-b674-6aed9b874146");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>, the <span class="moose-katex-inline-equation" id="moose-equation-b6c5bf54-5b2f-4209-9080-212ee8ce9cdc"><script>var element = document.getElementById("moose-equation-b6c5bf54-5b2f-4209-9080-212ee8ce9cdc");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-92a8bebe-5c19-470c-be4c-6a52ca0fb906"><script>var element = document.getElementById("moose-equation-92a8bebe-5c19-470c-be4c-6a52ca0fb906");katex.render("(i,j)", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-071a4119-3ecd-430b-b566-6bbc5fa132f1"><script>var element = document.getElementById("moose-equation-071a4119-3ecd-430b-b566-6bbc5fa132f1");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> entry of the Jacobian is then:</p></li></ul><p><span class="moose-katex-inline-equation" id="moose-equation-0973988f-b2c0-4c3c-b6ee-596e1b77b1ce"><script>var element = document.getElementById("moose-equation-0973988f-b2c0-4c3c-b6ee-596e1b77b1ce");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-a00f9f33-fe13-4a9b-9d1a-c99e093545b8"><script>var element = document.getElementById("moose-equation-a00f9f33-fe13-4a9b-9d1a-c99e093545b8");katex.render("\\begin{aligned} J_{ij}(u_h) &= \\left(\\nabla\\psi_i, \\frac{\\partial k}{\\partial u_j}\\nabla u_h \\right) + \\left(\\nabla\\psi_i, k \\nabla \\phi_j \\right) - \\left \\langle\\psi_i, \\frac{\\partial k}{\\partial u_j}\\nabla u_h\\cdot \\hat{n} \\right\\rangle \\\\&- \\left \\langle\\psi_i, k\\nabla \\phi_j\\cdot \\hat{n} \\right\\rangle + \\left(\\psi_i, \\frac{\\partial \\vec{\\beta}}{\\partial u_j} \\cdot\\nabla u_h\\right) + \\left(\\psi_i, \\vec{\\beta} \\cdot \\nabla \\phi_j\\right) - \\left(\\psi_i, \\frac{\\partial f}{\\partial u_j}\\right)\\end{aligned}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-6fd52f9d-c29e-4b34-9dc3-ab4ea8240c12"><script>var element = document.getElementById("moose-equation-6fd52f9d-c29e-4b34-9dc3-ab4ea8240c12");katex.render("", element, {displayMode:false,throwOnError:false});</script></span></p><ul class="browser-default"><li><p>Note that even for this "simple" equation, the Jacobian entries are nontrivial: they depend on the partial derivatives of <span class="moose-katex-inline-equation" id="moose-equation-5855141a-bdf2-429a-b55a-d18134d6aec1"><script>var element = document.getElementById("moose-equation-5855141a-bdf2-429a-b55a-d18134d6aec1");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-3c88dd81-a902-4cf7-b060-2cb6bfaacd00"><script>var element = document.getElementById("moose-equation-3c88dd81-a902-4cf7-b060-2cb6bfaacd00");katex.render("k", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-7b7d292d-3d3d-4a41-9ad1-d9a8f39cf560"><script>var element = document.getElementById("moose-equation-7b7d292d-3d3d-4a41-9ad1-d9a8f39cf560");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-fa047a83-3153-4236-afae-138b36d64f0d"><script>var element = document.getElementById("moose-equation-fa047a83-3153-4236-afae-138b36d64f0d");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-7bab8d9f-737f-408b-9f8e-aeb9c60de3db"><script>var element = document.getElementById("moose-equation-7bab8d9f-737f-408b-9f8e-aeb9c60de3db");katex.render("\\vec{\\beta}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-c30be247-7063-4afc-820a-52f2be409352"><script>var element = document.getElementById("moose-equation-c30be247-7063-4afc-820a-52f2be409352");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>, and <span class="moose-katex-inline-equation" id="moose-equation-f33f739e-ff09-4dfc-a39c-ca4ae2e4b71f"><script>var element = document.getElementById("moose-equation-f33f739e-ff09-4dfc-a39c-ca4ae2e4b71f");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-ad651020-1778-40f9-a132-bfe880d97db8"><script>var element = document.getElementById("moose-equation-ad651020-1778-40f9-a132-bfe880d97db8");katex.render("f", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-f2ddfb61-110e-4a4e-92df-c0ab98d61790"><script>var element = document.getElementById("moose-equation-f2ddfb61-110e-4a4e-92df-c0ab98d61790");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>, which may be difficult or time-consuming to compute analytically.</p><p></p></li><li><p>In a multiphysics setting with many coupled equations and complicated material properties, the Jacobian might be extremely difficult to determine.</p></li></ul></section><section data-section-text="Chain   Rule" data-section-level="1" id="8fde1728-d40b-4add-9842-2ca05599f640"><h1>Chain Rule</h1><ul class="browser-default"><li><p>On the previous slide, the term <span class="moose-katex-inline-equation" id="moose-equation-494c76c3-7ae1-4dec-abda-95aec61767b4"><script>var element = document.getElementById("moose-equation-494c76c3-7ae1-4dec-abda-95aec61767b4");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-5d0ec78a-ee1d-427e-aa70-8959fc92d4ef"><script>var element = document.getElementById("moose-equation-5d0ec78a-ee1d-427e-aa70-8959fc92d4ef");katex.render("\\frac{\\partial f}{\\partial u_j}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-d2692ddf-5810-4f8f-92d1-c7fb49ad3c6a"><script>var element = document.getElementById("moose-equation-d2692ddf-5810-4f8f-92d1-c7fb49ad3c6a");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> was used, where <span class="moose-katex-inline-equation" id="moose-equation-6edf1d7c-00a6-474d-8532-3483d67a409c"><script>var element = document.getElementById("moose-equation-6edf1d7c-00a6-474d-8532-3483d67a409c");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-7e99ff2f-c20a-4c18-b7f4-5a3781adc20d"><script>var element = document.getElementById("moose-equation-7e99ff2f-c20a-4c18-b7f4-5a3781adc20d");katex.render("f", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-441b28ce-a32d-4366-9aac-0f696c63b894"><script>var element = document.getElementById("moose-equation-441b28ce-a32d-4366-9aac-0f696c63b894");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> was a nonlinear forcing function.</p><p></p></li><li><p>The chain rule allows us to write this term as</p><p><span class="moose-katex-inline-equation" id="moose-equation-6a9ac221-b27e-47c0-9419-d6b5f9362e48"><script>var element = document.getElementById("moose-equation-6a9ac221-b27e-47c0-9419-d6b5f9362e48");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-330db7de-1c67-4bbc-90a9-f4edf153e91c"><script>var element = document.getElementById("moose-equation-330db7de-1c67-4bbc-90a9-f4edf153e91c");katex.render("\\begin{aligned}   \\frac{\\partial f}{\\partial u_j} &= \\frac{\\partial f}{\\partial u_h} \\frac{\\partial u_h}{\\partial u_j}   \\\\   &=\\frac{\\partial f}{\\partial u_h} \\phi_j\\end{aligned}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-2ed7bd54-5a45-42fa-8b6d-75d19eba7668"><script>var element = document.getElementById("moose-equation-2ed7bd54-5a45-42fa-8b6d-75d19eba7668");katex.render("", element, {displayMode:false,throwOnError:false});</script></span></p><p></p></li><li><p>If a functional form of <span class="moose-katex-inline-equation" id="moose-equation-33bb16bb-0fb6-4836-b25f-ecd685981d3b"><script>var element = document.getElementById("moose-equation-33bb16bb-0fb6-4836-b25f-ecd685981d3b");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-54ef24b8-cb5b-4565-9ea8-4298623d69ad"><script>var element = document.getElementById("moose-equation-54ef24b8-cb5b-4565-9ea8-4298623d69ad");katex.render("f", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-9a156438-e270-4f20-975d-07173e4557b2"><script>var element = document.getElementById("moose-equation-9a156438-e270-4f20-975d-07173e4557b2");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> is known, e.g. <span class="moose-katex-inline-equation" id="moose-equation-df87b7f9-0b3e-4d03-a3a8-05490a7345fb"><script>var element = document.getElementById("moose-equation-df87b7f9-0b3e-4d03-a3a8-05490a7345fb");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-7dabcb8e-4105-4e19-9415-d79e82f44fb6"><script>var element = document.getElementById("moose-equation-7dabcb8e-4105-4e19-9415-d79e82f44fb6");katex.render("f(u) = \\sin(u)", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-f64aa347-9a95-4938-a211-ac2457bfe0b4"><script>var element = document.getElementById("moose-equation-f64aa347-9a95-4938-a211-ac2457bfe0b4");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>, this formula implies that its Jacobian contribution is given by</p><p> <span class="moose-katex-inline-equation" id="moose-equation-6f85e149-b698-47a9-a21b-eb41663bbd55"><script>var element = document.getElementById("moose-equation-6f85e149-b698-47a9-a21b-eb41663bbd55");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-0b0f4cdf-7c79-4bc9-9b8a-55fcf2472518"><script>var element = document.getElementById("moose-equation-0b0f4cdf-7c79-4bc9-9b8a-55fcf2472518");katex.render("\\frac{\\partial f}{\\partial u_j} = \\cos(u_h) \\phi_j", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-e063d1a2-edc2-4b8f-988a-bb4f1983e26e"><script>var element = document.getElementById("moose-equation-e063d1a2-edc2-4b8f-988a-bb4f1983e26e");katex.render("", element, {displayMode:false,throwOnError:false});</script></span></p></li></ul></section><section data-section-text="Jacobian   Free   Newton   Krylov" data-section-level="1" id="0c75cba8-88be-4886-9424-f25a537be902"><h1>Jacobian Free Newton Krylov</h1><ul class="browser-default"><li><p><span class="moose-katex-inline-equation" id="moose-equation-8e08509b-b9c6-4b3a-bf86-5ea43a0a6c99"><script>var element = document.getElementById("moose-equation-8e08509b-b9c6-4b3a-bf86-5ea43a0a6c99");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-1bfe1f87-b2bd-4c3d-b255-8d354fd85d7d"><script>var element = document.getElementById("moose-equation-1bfe1f87-b2bd-4c3d-b255-8d354fd85d7d");katex.render("\\mathbf{J}(\\vec{u}_n)\\delta \\vec{u}_{n+1} = -\\vec{R}(\\vec{u}_n)", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-77fdd937-8931-485a-9e43-2ed002f8606f"><script>var element = document.getElementById("moose-equation-77fdd937-8931-485a-9e43-2ed002f8606f");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> is a linear system solved during each Newton step. </p></li><li><p>For simplicity, we can write this linear system as <span class="moose-katex-inline-equation" id="moose-equation-7fd8e262-71b6-42dc-b4e9-239bed7b0fc8"><script>var element = document.getElementById("moose-equation-7fd8e262-71b6-42dc-b4e9-239bed7b0fc8");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-468d031b-7de5-481b-9585-8e0121bb7464"><script>var element = document.getElementById("moose-equation-468d031b-7de5-481b-9585-8e0121bb7464");katex.render("\\mathbf{A}\\vec{x} = \\vec{b}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-4dcbfa0f-cb98-4527-bfbd-a41b1702e230"><script>var element = document.getElementById("moose-equation-4dcbfa0f-cb98-4527-bfbd-a41b1702e230");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>, where:  - <span class="moose-katex-inline-equation" id="moose-equation-81a5389b-485d-451a-b64f-f1cffb4bc984"><script>var element = document.getElementById("moose-equation-81a5389b-485d-451a-b64f-f1cffb4bc984");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-c82d86d4-643a-4a23-a8b7-b4696cc46975"><script>var element = document.getElementById("moose-equation-c82d86d4-643a-4a23-a8b7-b4696cc46975");katex.render("\\mathbf{A} \\equiv \\mathbf{J}(\\vec{u}_n)", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-d37b2891-ddcc-4c97-99cd-832ea27cbe72"><script>var element = document.getElementById("moose-equation-d37b2891-ddcc-4c97-99cd-832ea27cbe72");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>  - <span class="moose-katex-inline-equation" id="moose-equation-259cfb80-6fa4-4411-ac86-32fd039da213"><script>var element = document.getElementById("moose-equation-259cfb80-6fa4-4411-ac86-32fd039da213");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-5d4f1838-dac7-4f0e-852e-4655009addf0"><script>var element = document.getElementById("moose-equation-5d4f1838-dac7-4f0e-852e-4655009addf0");katex.render("\\vec{x} \\equiv \\delta \\vec{u}_{n+1}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-bee73cd4-b3e8-4482-aaf8-b0ea0ba531c2"><script>var element = document.getElementById("moose-equation-bee73cd4-b3e8-4482-aaf8-b0ea0ba531c2");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>  - <span class="moose-katex-inline-equation" id="moose-equation-a3e1110f-454c-43d9-a7cd-59a25e3cc73b"><script>var element = document.getElementById("moose-equation-a3e1110f-454c-43d9-a7cd-59a25e3cc73b");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-611d872b-35e4-440b-87f6-88b4708f43d8"><script>var element = document.getElementById("moose-equation-611d872b-35e4-440b-87f6-88b4708f43d8");katex.render("\\vec{b} \\equiv -\\vec{R}(\\vec{u}_n)", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-4afa21b2-40b3-4aef-b754-26f88763c94e"><script>var element = document.getElementById("moose-equation-4afa21b2-40b3-4aef-b754-26f88763c94e");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> </p></li><li><p>We employ an iterative Krylov method (e.g. GMRES) to produce a sequence of iterates <span class="moose-katex-inline-equation" id="moose-equation-f4f512be-143f-4562-8e3b-ee3d52b07a90"><script>var element = document.getElementById("moose-equation-f4f512be-143f-4562-8e3b-ee3d52b07a90");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-cb22fc1b-2326-494d-90a0-94547d6815ac"><script>var element = document.getElementById("moose-equation-cb22fc1b-2326-494d-90a0-94547d6815ac");katex.render("\\vec{x}_k \\rightarrow \\vec{x}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-c86e5e56-455b-485e-b934-e3a7fcc7aeb8"><script>var element = document.getElementById("moose-equation-c86e5e56-455b-485e-b934-e3a7fcc7aeb8");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-5a34a77a-9314-44be-9de9-0999fd6be3da"><script>var element = document.getElementById("moose-equation-5a34a77a-9314-44be-9de9-0999fd6be3da");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-73656694-0018-4c5a-a1c5-26f985132987"><script>var element = document.getElementById("moose-equation-73656694-0018-4c5a-a1c5-26f985132987");katex.render("k=1,2,\\ldots", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-0ca5bb45-895f-4da1-9668-7f8ad69015ab"><script>var element = document.getElementById("moose-equation-0ca5bb45-895f-4da1-9668-7f8ad69015ab");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> </p></li><li><p><span class="moose-katex-inline-equation" id="moose-equation-1fe11911-ba97-44d8-bc16-b0f02e9c9fb1"><script>var element = document.getElementById("moose-equation-1fe11911-ba97-44d8-bc16-b0f02e9c9fb1");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-e349514c-0605-4b0f-8ca3-d13401b56397"><script>var element = document.getElementById("moose-equation-e349514c-0605-4b0f-8ca3-d13401b56397");katex.render("\\mathbf{A}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-62788536-5cd4-44a5-9422-49017fd96d23"><script>var element = document.getElementById("moose-equation-62788536-5cd4-44a5-9422-49017fd96d23");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> and <span class="moose-katex-inline-equation" id="moose-equation-b652a3e1-f947-4518-93b7-7f5cf0d78fa6"><script>var element = document.getElementById("moose-equation-b652a3e1-f947-4518-93b7-7f5cf0d78fa6");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-2a421e89-79ed-41b2-acf5-477cabe2bf61"><script>var element = document.getElementById("moose-equation-2a421e89-79ed-41b2-acf5-477cabe2bf61");katex.render("\\vec{b}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-0a80d5c7-a613-41bb-ad60-e3d4abc6746c"><script>var element = document.getElementById("moose-equation-0a80d5c7-a613-41bb-ad60-e3d4abc6746c");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> remain <em>fixed</em> during the iterative process. </p></li><li><p>The "linear residual" at step <span class="moose-katex-inline-equation" id="moose-equation-bea794e4-5257-4bac-b5dd-6b1daffd4b4f"><script>var element = document.getElementById("moose-equation-bea794e4-5257-4bac-b5dd-6b1daffd4b4f");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-5e24886e-e40d-471b-bc24-d0564bfde539"><script>var element = document.getElementById("moose-equation-5e24886e-e40d-471b-bc24-d0564bfde539");katex.render("k", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-337ab3c7-9487-4248-b32f-c5a81a7bad7a"><script>var element = document.getElementById("moose-equation-337ab3c7-9487-4248-b32f-c5a81a7bad7a");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> is defined as</p><p><span class="moose-katex-inline-equation" id="moose-equation-af123759-bb69-481d-8d38-8732ff7cbc2d"><script>var element = document.getElementById("moose-equation-af123759-bb69-481d-8d38-8732ff7cbc2d");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-c12a6023-2aea-47d9-8c16-0013ba3a79ee"><script>var element = document.getElementById("moose-equation-c12a6023-2aea-47d9-8c16-0013ba3a79ee");katex.render("\\vec{\\rho}_k \\equiv \\mathbf{A}\\vec{x}_k - \\vec{b}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-066b4827-a8a7-49f2-959e-667b92c7b3fa"><script>var element = document.getElementById("moose-equation-066b4827-a8a7-49f2-959e-667b92c7b3fa");katex.render("", element, {displayMode:false,throwOnError:false});</script></span></p><p></p></li><li><p>MOOSE prints the norm of this vector, <span class="moose-katex-inline-equation" id="moose-equation-83b601bc-8552-4951-a9d9-497cf5b73ae9"><script>var element = document.getElementById("moose-equation-83b601bc-8552-4951-a9d9-497cf5b73ae9");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-a4ed3af8-e064-4799-8dfa-33a2d90584b7"><script>var element = document.getElementById("moose-equation-a4ed3af8-e064-4799-8dfa-33a2d90584b7");katex.render("\\|\\vec{\\rho}_k\\|", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-8fc8b055-c4aa-45dd-a9bb-d42fef84f072"><script>var element = document.getElementById("moose-equation-8fc8b055-c4aa-45dd-a9bb-d42fef84f072");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>, at each iteration, if you set <code>print_linear_residuals = true</code> in the <code>Outputs</code> block.</p><p></p></li><li><p>The "nonlinear residual" printed by MOOSE is <span class="moose-katex-inline-equation" id="moose-equation-92ab3d67-e0cd-4eb9-a78a-618361607d12"><script>var element = document.getElementById("moose-equation-92ab3d67-e0cd-4eb9-a78a-618361607d12");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-447d220f-ab57-400e-8d20-becf549a7919"><script>var element = document.getElementById("moose-equation-447d220f-ab57-400e-8d20-becf549a7919");katex.render("\\|\\vec{R}(\\vec{u}_n)\\|", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-dcc115d2-3749-4da3-8ece-590e0a9b7b48"><script>var element = document.getElementById("moose-equation-dcc115d2-3749-4da3-8ece-590e0a9b7b48");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>.</p><p></p></li><li><p>By iterate <span class="moose-katex-inline-equation" id="moose-equation-eeb656b7-13b3-4cbe-95c4-8b59ffaa5ab5"><script>var element = document.getElementById("moose-equation-eeb656b7-13b3-4cbe-95c4-8b59ffaa5ab5");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-b00cf18c-49ae-490a-b722-987de8351793"><script>var element = document.getElementById("moose-equation-b00cf18c-49ae-490a-b722-987de8351793");katex.render("k", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-fdf28ea2-cafc-4346-b4ce-e889dff6137d"><script>var element = document.getElementById("moose-equation-fdf28ea2-cafc-4346-b4ce-e889dff6137d");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>, the Krylov method has constructed the subspace</p><p><span class="moose-katex-inline-equation" id="moose-equation-459fdee4-0e34-464e-8fae-5f39b6afbb2d"><script>var element = document.getElementById("moose-equation-459fdee4-0e34-464e-8fae-5f39b6afbb2d");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-dd16ee39-242c-4e11-9daf-b421b3736144"><script>var element = document.getElementById("moose-equation-dd16ee39-242c-4e11-9daf-b421b3736144");katex.render("\\mathcal{K}_k = \\text{span}\\{ \\vec{b}, \\mathbf{A}\\vec{b}, \\mathbf{A}^2\\vec{b}, \\ldots, \\mathbf{A}^{k-1}\\vec{b}\\}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-f94ee931-8af3-4b17-af58-e2614da08763"><script>var element = document.getElementById("moose-equation-f94ee931-8af3-4b17-af58-e2614da08763");katex.render("", element, {displayMode:false,throwOnError:false});</script></span></p><p></p></li><li><p>Different Krylov methods produce the <span class="moose-katex-inline-equation" id="moose-equation-01f5d679-bb8d-435c-a1d0-436d90e28eb5"><script>var element = document.getElementById("moose-equation-01f5d679-bb8d-435c-a1d0-436d90e28eb5");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-89779f86-e8ab-443d-af19-6a82245c67fb"><script>var element = document.getElementById("moose-equation-89779f86-e8ab-443d-af19-6a82245c67fb");katex.render("\\vec{x}_k", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-ada85d99-1e4b-4952-b54f-d92b0666ec98"><script>var element = document.getElementById("moose-equation-ada85d99-1e4b-4952-b54f-d92b0666ec98");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> iterates in different ways: </p></li><li><p>Conjugate Gradients: <span class="moose-katex-inline-equation" id="moose-equation-91dab51e-0b9e-4ea6-90bc-37acc4966ec2"><script>var element = document.getElementById("moose-equation-91dab51e-0b9e-4ea6-90bc-37acc4966ec2");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-dbb205fd-7338-478a-a15f-2b5c29cbd982"><script>var element = document.getElementById("moose-equation-dbb205fd-7338-478a-a15f-2b5c29cbd982");katex.render("\\vec{\\rho}_k", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-4478f35f-ccc1-4a6c-b03b-45d429d960f3"><script>var element = document.getElementById("moose-equation-4478f35f-ccc1-4a6c-b03b-45d429d960f3");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> orthogonal to <span class="moose-katex-inline-equation" id="moose-equation-b46c7eca-cf40-41e5-80fc-f220eb8f8120"><script>var element = document.getElementById("moose-equation-b46c7eca-cf40-41e5-80fc-f220eb8f8120");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-75d198f1-2bb5-407c-9b1a-7c968fceb50b"><script>var element = document.getElementById("moose-equation-75d198f1-2bb5-407c-9b1a-7c968fceb50b");katex.render("\\mathcal{K}_k", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-024c5c2c-706b-424c-a145-cb898b4ba085"><script>var element = document.getElementById("moose-equation-024c5c2c-706b-424c-a145-cb898b4ba085");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>. </p></li><li><p>GMRES/MINRES: <span class="moose-katex-inline-equation" id="moose-equation-b8a234d5-c3e5-4cd5-abd9-ef7f3a064c57"><script>var element = document.getElementById("moose-equation-b8a234d5-c3e5-4cd5-abd9-ef7f3a064c57");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-d10bb4cc-b8e3-4d98-8ac3-8f5acd0c4afc"><script>var element = document.getElementById("moose-equation-d10bb4cc-b8e3-4d98-8ac3-8f5acd0c4afc");katex.render("\\vec{\\rho}_k", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-e4cea5dd-5d0c-41a1-83ac-bbe90f6f6ac9"><script>var element = document.getElementById("moose-equation-e4cea5dd-5d0c-41a1-83ac-bbe90f6f6ac9");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> has minimum norm for <span class="moose-katex-inline-equation" id="moose-equation-4c46b800-720e-426d-8978-70dea50cfec5"><script>var element = document.getElementById("moose-equation-4c46b800-720e-426d-8978-70dea50cfec5");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-84d629f8-2821-4594-97a5-50bd94141a89"><script>var element = document.getElementById("moose-equation-84d629f8-2821-4594-97a5-50bd94141a89");katex.render("\\vec{x}_k", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-d6503c03-3ec1-4789-b081-1c3e845ff3c6"><script>var element = document.getElementById("moose-equation-d6503c03-3ec1-4789-b081-1c3e845ff3c6");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> in <span class="moose-katex-inline-equation" id="moose-equation-85628a46-a9fe-46cc-b6c3-a5d9542e8566"><script>var element = document.getElementById("moose-equation-85628a46-a9fe-46cc-b6c3-a5d9542e8566");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-81e53eb0-d44f-4996-a42c-36ac15a565aa"><script>var element = document.getElementById("moose-equation-81e53eb0-d44f-4996-a42c-36ac15a565aa");katex.render("\\mathcal{K}_k", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-806b6f40-09d6-4d52-b8d8-91ba8f1d92d5"><script>var element = document.getElementById("moose-equation-806b6f40-09d6-4d52-b8d8-91ba8f1d92d5");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>. </p></li><li><p>Biconjugate Gradients: <span class="moose-katex-inline-equation" id="moose-equation-91a8c01f-606c-4549-9c61-fa511007a3bc"><script>var element = document.getElementById("moose-equation-91a8c01f-606c-4549-9c61-fa511007a3bc");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-4c2cc1f1-4b16-42bd-b66e-e94a651e1875"><script>var element = document.getElementById("moose-equation-4c2cc1f1-4b16-42bd-b66e-e94a651e1875");katex.render("\\vec{\\rho}_k", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-9cc56992-17db-458f-a990-2720722d1e8d"><script>var element = document.getElementById("moose-equation-9cc56992-17db-458f-a990-2720722d1e8d");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> is orthogonal to <span class="moose-katex-inline-equation" id="moose-equation-6b9ae60f-6cb2-42b9-bf8b-38940386f9b4"><script>var element = document.getElementById("moose-equation-6b9ae60f-6cb2-42b9-bf8b-38940386f9b4");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-5e388933-80b4-44f9-861e-5637c0e5872d"><script>var element = document.getElementById("moose-equation-5e388933-80b4-44f9-861e-5637c0e5872d");katex.render("\\mathcal{K}_k(\\mathbf{A}^T)", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-b47267d9-8e91-41f7-b540-fb4ce77cc8db"><script>var element = document.getElementById("moose-equation-b47267d9-8e91-41f7-b540-fb4ce77cc8db");katex.render("", element, {displayMode:false,throwOnError:false});</script></span></p><p></p></li><li><p><span class="moose-katex-inline-equation" id="moose-equation-df0326a2-8569-4422-b471-6542d74f905f"><script>var element = document.getElementById("moose-equation-df0326a2-8569-4422-b471-6542d74f905f");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-9f257492-cbb2-4cf7-99ca-d0a6508b4c68"><script>var element = document.getElementById("moose-equation-9f257492-cbb2-4cf7-99ca-d0a6508b4c68");katex.render("\\mathbf{J}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-2c4a73fd-209d-4a80-b102-d0438c482346"><script>var element = document.getElementById("moose-equation-2c4a73fd-209d-4a80-b102-d0438c482346");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> is never explicitly needed to construct the subspace, only the action of <span class="moose-katex-inline-equation" id="moose-equation-717ee5e8-2833-4d4e-9b0f-ec3d1b47afb9"><script>var element = document.getElementById("moose-equation-717ee5e8-2833-4d4e-9b0f-ec3d1b47afb9");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-a8077109-94aa-44d3-aabd-f45605d3c777"><script>var element = document.getElementById("moose-equation-a8077109-94aa-44d3-aabd-f45605d3c777");katex.render("\\mathbf{J}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-d35345f9-11a8-4fd4-abae-cdd5ae6f59b9"><script>var element = document.getElementById("moose-equation-d35345f9-11a8-4fd4-abae-cdd5ae6f59b9");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> on a vector is required.</p></li></ul><ul class="browser-default"><li><p>This action can be approximated by:  <span class="moose-katex-inline-equation" id="moose-equation-d3b45632-73a2-42ba-9399-e47b89f8d25d"><script>var element = document.getElementById("moose-equation-d3b45632-73a2-42ba-9399-e47b89f8d25d");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-680ccb3f-0850-46c7-a304-243a71b79b17"><script>var element = document.getElementById("moose-equation-680ccb3f-0850-46c7-a304-243a71b79b17");katex.render("\\mathbf{J}\\vec{v} \\approx \\frac{\\vec{R}(\\vec{u} + \\epsilon\\vec{v}) - \\vec{R}(\\vec{u})}{\\epsilon}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-1c24899b-86d7-4204-8cf7-e922d7fdafc6"><script>var element = document.getElementById("moose-equation-1c24899b-86d7-4204-8cf7-e922d7fdafc6");katex.render("", element, {displayMode:false,throwOnError:false});</script></span></p><p></p></li><li><p>This form has many advantages:  - No need to do analytic derivatives to form <span class="moose-katex-inline-equation" id="moose-equation-6317bb8b-827f-4a70-a052-655c59e7f436"><script>var element = document.getElementById("moose-equation-6317bb8b-827f-4a70-a052-655c59e7f436");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-80da77cf-ab2b-4a09-afbc-ea629ad61401"><script>var element = document.getElementById("moose-equation-80da77cf-ab2b-4a09-afbc-ea629ad61401");katex.render("\\mathbf{J}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-595f6085-1dff-4b38-8d74-d2eaee722794"><script>var element = document.getElementById("moose-equation-595f6085-1dff-4b38-8d74-d2eaee722794");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>  - No time needed to compute <span class="moose-katex-inline-equation" id="moose-equation-a6d45f83-f5e0-41c2-bf8f-0c8873cd7cf0"><script>var element = document.getElementById("moose-equation-a6d45f83-f5e0-41c2-bf8f-0c8873cd7cf0");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-b29a2a31-e3fa-47f0-82dd-8caedde60762"><script>var element = document.getElementById("moose-equation-b29a2a31-e3fa-47f0-82dd-8caedde60762");katex.render("\\mathbf{J}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-caee253f-d3a0-4f28-8314-b9579c9a8582"><script>var element = document.getElementById("moose-equation-caee253f-d3a0-4f28-8314-b9579c9a8582");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> (just residual computations)  - No space needed to store <span class="moose-katex-inline-equation" id="moose-equation-eaee3456-6f58-450e-8527-7aa0aea5bb4c"><script>var element = document.getElementById("moose-equation-eaee3456-6f58-450e-8527-7aa0aea5bb4c");katex.render("", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-50e8934f-c747-46f6-8e85-f7d82c16daaf"><script>var element = document.getElementById("moose-equation-50e8934f-c747-46f6-8e85-f7d82c16daaf");katex.render("\\mathbf{J}", element, {displayMode:false,throwOnError:false});</script></span><span class="moose-katex-inline-equation" id="moose-equation-b8a36d68-e95e-45ea-ab94-efcbcbac3f31"><script>var element = document.getElementById("moose-equation-b8a36d68-e95e-45ea-ab94-efcbcbac3f31");katex.render("", element, {displayMode:false,throwOnError:false});</script></span></p></li></ul></section><section data-section-text="Wrap   Up" data-section-level="1" id="0150bf4c-4216-4675-9990-c43fc5371e5a"><h1>Wrap Up</h1><ul class="browser-default"><li><p>The Finite Element Method is a way of numerically approximating the solution of PDEs. </p></li><li><p>Just like polynomial fitting, FEM finds coefficients for basis functions. </p></li><li><p>The "solution" is the combination of the coefficients and the basis functions, and the solution can be sampled anywhere in the domain. </p></li><li><p>We compute integrals numerically using quadrature. </p></li><li><p>Newton's Method provides a mechanism for solving a system of nonlinear equations. </p></li><li><p>The Jacobian Free Newton Krylov (JFNK) method allows us to avoid explicitly forming the Jacobian matrix while still computing its "action".</p></li></ul></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"></ul></div></div></div></div></main></div></body></html>