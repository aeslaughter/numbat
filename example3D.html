<!DOCTYPE html><html><head><meta charset="UTF-8"><link media="screen,projection" href="contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet"></link><link href="contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="css/moose.css" type="text/css" rel="stylesheet"></link><script src="contrib/jquery/jquery.min.js" type="text/javascript"></script><script src="contrib/materialize/materialize.min.js" type="text/javascript"></script><script src="contrib/clipboard/clipboard.min.js" type="text/javascript"></script><script src="contrib/prism/prism.min.js" type="text/javascript"></script><script src="contrib/katex/katex.min.js" type="text/javascript"></script><script src="contrib/fuse/fuse.min.js" type="text/javascript"></script><script src="js/search_index.js" type="text/javascript"></script><script src="js/init.js" type="text/javascript"></script><title>Three - dimensional   examples|Numbat</title></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://github.com/cpgr/numbat" class="right"><img src="media/github-logo.png" class="github-mark"></img><img src="media/github-mark.png" class="github-logo"></img></a><a href="http://cpgr.github.io/numbat/" class="left moose-logo">Numbat</a><ul class="right hide-on-med-and-down" id="nav-mobile"><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="d16a859e-193c-497e-9637-fef65dcec73c">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="7132de03-4388-4e71-ac13-9e93fff91614">Theory<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="b3bae01b-8113-452c-abf6-7d2d07007a3b">Details<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="f118b50c-4e31-49a3-9bfd-8c9163666973">Examples<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="ac3c68ae-15fb-4fcd-a126-eccfe25220e8">Manual<i class="material-icons right">arrow_drop_down</i></a></li></ul><ul class="dropdown-content" id="d16a859e-193c-497e-9637-fef65dcec73c"><li><a href="getting_started.html">Installation</a></li></ul><ul class="dropdown-content" id="7132de03-4388-4e71-ac13-9e93fff91614"><li><a href="introduction.html">Introduction</a></li><li><a href="governing_equations.html">Governing equations</a></li></ul><ul class="dropdown-content" id="b3bae01b-8113-452c-abf6-7d2d07007a3b"><li><a href="implementation.html">Implementation</a></li><li><a href="input_file_syntax.html">Input file syntax</a></li><li><a href="running_numbat.html">Running Numbat</a></li><li><a href="systems.html">Available objects</a></li></ul><ul class="dropdown-content" id="f118b50c-4e31-49a3-9bfd-8c9163666973"><li><a href="example2D.html">2D</a></li><li><a href="example3D.html">3D</a></li></ul><ul class="dropdown-content" id="ac3c68ae-15fb-4fcd-a126-eccfe25220e8"><li><a href="download.html">User manual</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input autocomplete="off" onkeyup="mooseSearch()" type="text" id="moose-search-box"><label for="search">http://cpgr.github.io/numbat/</label></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-action modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href="example3D.html" class="breadcrumb">example3D</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section data-section-text="Three - dimensional   examples" data-section-level="1" id="0359007e-4c3e-40a5-8ed5-ddbb3f647aed"><h1>Three-dimensional examples</h1><p>Complete input files for 2D models using the dimensional and dimensionless streamfunction formulations are provided, for both isotropic and anisotropic porous media. These examples are provided in the Numbat <em>examples</em> folder.</p><section class="section scrollspy" data-section-text="Isotropic   models" data-section-level="2" id="9443e100-0694-4f1e-9492-678a6d0b932f"><h2>Isotropic models</h2><p>The first examples are for an isotropic porous medium (<span class="moose-katex-inline-equation" id="moose-equation-787814bd-d88a-4f67-87dd-f892bf6cc1ca"><script>var element = document.getElementById("moose-equation-787814bd-d88a-4f67-87dd-f892bf6cc1ca");katex.render("\\gamma = 1", element, {displayMode:false,throwOnError:false});</script></span>).</p><section data-section-text="Input   file" data-section-level="3" id="5dc1a6fc-548d-4e64-828b-6e7e8d79ac2c"><h3>Input file</h3><p>The complete input file for this problem is</p><div class="card"><div class="card-content"><pre style="max-height:350px;"><code class="language-text"># 3D density-driven convective mixing. Instability is seeded by small perturbation
# to porosity. Don't try this on a laptop!

[Mesh]
  type = NumbatBiasedMesh
  dim = 3
  zmax = 1.5
  nx = 20
  ny = 20
  nz = 500
  refined_edge = front
  refined_resolution = 0.001
[]

[Variables]
  [./concentration]
    initial_condition = 0
    scaling = 1e6
  [../]
  [./pressure]
    initial_condition = 1e6
  [../]
[]

[AuxVariables]
  [./noise]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[ICs]
  [./noise]
    type = RandomIC
    variable = noise
    max = 0.003
    min = -0.003
  [../]
[]

[Materials]
  [./porosity]
    type = NumbatPorosity
    porosity = 0.3
    noise = noise
  [../]
  [./permeability]
    type = NumbatPermeability
    permeability = '1e-11 0 0 0 1e-11 0 0 0 1e-11'
  [../]
  [./diffusivity]
    type = NumbatDiffusivity
    diffusivity = 2e-9
  [../]
  [./density]
    type = NumbatDensity
    concentration = concentration
    zero_density = 995
    delta_density = 10.5
    saturated_concentration = 0.049306
  [../]
  [./viscosity]
    type = NumbatViscosity
    viscosity = 6e-4
  [../]
[]

[Kernels]
  [./time]
    type = NumbatTimeDerivative
    variable = concentration
  [../]
  [./diffusion]
    type = NumbatDiffusion
    variable = concentration
  [../]
  [./convection]
    type = NumbatConvection
    variable = concentration
    pressure = pressure
  [../]
  [./darcy]
    type = NumbatDarcy
    variable = pressure
    concentration = concentration
  [../]
[]

[BCs]
  [./conctop]
    type = PresetBC
    variable = concentration
    boundary = front
    value = 0.049306
  [../]
  [./Periodic]
    [./x]
      variable = concentration
      auto_direction = 'x y'
    [../]
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  l_max_its = 200
  end_time = 3e5
  solve_type = NEWTON
  petsc_options = -ksp_snes_ew
  petsc_options_iname = '-pc_type -sub_pc_type -ksp_atol'
  petsc_options_value = 'bjacobi ilu 1e-12'
  nl_abs_tol = 1e-10
  nl_max_its = 25
  dtmax = 2e3
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1
  [../]
[]

[Postprocessors]
  [./boundaryfluxint]
    type = NumbatSideFlux
    variable = concentration
    boundary = top
  [../]
  [./mass]
    type = NumbatTotalMass
    variable = concentration
  [../]
[]

[Outputs]
  [./console]
    type = Console
    perf_log = true
    output_nonlinear = true
  [../]
  [./exodus]
    type = Exodus
    file_base = 3Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./csvoutput]
    type = CSV
    file_base = 3Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]</code></pre><a data-position="top" href="#4c96a92e-6607-4e92-923d-9fdb411b11d2" class="tooltipped modal-trigger" data-tooltip="/Users/gre462/Documents/MOOSE/projects/numbat/examples/3D/isotropic/3Dddc.i">(examples/3D/isotropic/3Dddc.i)</a></div></div></section><section data-section-text="Running   the   example" data-section-level="3" id="9537d5da-07ce-40d4-8d3e-28cc18ec226c"><h3>Running the example</h3><div class="card moose-alert moose-alert-note"><div class="card-content"><div class="moose-alert-title card-title"><span class="moose-alert-title-brand">note</span></div><div class="moose-alert-content"><p></p></div></div></div><p>Examples of the total run times for this problem on a cluster are over 27 hours for a single processor down to only 30 minutes using 100 processors in parallel.</p></section><section data-section-text="Results" data-section-level="3" id="5fa0360e-5124-4eec-92ad-eea68018895e"><h3>Results</h3><p>This 3D example should produce a concentration profile similar to that presented in <a class="tooltipped" href="#fig:3D" data-tooltip="#fig:3D" data-position="top">Figure 1</a>, where several downwelling plumes of high concentration can be observed:</p><div style="width:80%;margin-left:10px" id="fig:3D" class="card"><div class="card-image"><img src="media/3D.png" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-heading">Figure 1: </span><span class="moose-caption-text">3D concentration profile</span></p></div></div><p>Note that due to the random perturbation applied to the initial concentration profile, the geometry of the concentration profile obtained will differ from run to run.</p><p>The flux over the top surface is of particular interest in many cases (especially convective mixing of CO<span class="moose-katex-inline-equation" id="moose-equation-eb050b8b-bbaa-4e00-ba8a-f53d685abfbb"><script>var element = document.getElementById("moose-equation-eb050b8b-bbaa-4e00-ba8a-f53d685abfbb");katex.render("_2", element, {displayMode:false,throwOnError:false});</script></span>). This is calculated in this example file using the <a data-position="top" href="documentation/systems/Postprocessors/NumbatSideFlux.html" class="tooltipped" data-tooltip="documentation/systems/Postprocessors/NumbatSideFlux.html">NumbatSideFlux</a> in the input file, and presented in <a class="tooltipped" href="#fig:3Dflux" data-tooltip="#fig:3Dflux" data-position="top">Figure 2</a>.</p><div style="width:80%;margin-left:10px" id="fig:3Dflux" class="card"><div class="card-image"><img src="media/3Dflux.png" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-heading">Figure 2: </span><span class="moose-caption-text">3D flux across the top boundary</span></p></div></div><p>Initially, the flux is purely diffusive, and scales as <span class="moose-katex-inline-equation" id="moose-equation-d7a01d31-1478-43fd-8de7-2b9cac77d9e9"><script>var element = document.getElementById("moose-equation-d7a01d31-1478-43fd-8de7-2b9cac77d9e9");katex.render("1 / \\sqrt(\\pi t)", element, {displayMode:false,throwOnError:false});</script></span>, where <span class="moose-katex-inline-equation" id="moose-equation-553c6a8a-6a9e-42df-bfb7-63c9c0fc76fd"><script>var element = document.getElementById("moose-equation-553c6a8a-6a9e-42df-bfb7-63c9c0fc76fd");katex.render("t", element, {displayMode:false,throwOnError:false});</script></span> is time (shown as the dashed green line). After some time, the convective instability becomes sufficiently strong, at which point the flux across the top boundary rapidly increases (at a time of approximately 1,700 seconds). Also shown for comparison is the flux for the 2D example. It is apparent that the 3D model leads in a slower onset of convection (the time where the flux first increases from the diffusive rate).</p></section><section data-section-text="Large   model" data-section-level="3" id="86950761-cc78-4d62-a3c7-6ac765eb3125"><h3>Large model</h3><p>Increasing the size of the mesh enables more of the flow regimes to be modelled (at the cost of increased computational expense). Consider a dimensionless model with Rayleigh number <span class="moose-katex-inline-equation" id="moose-equation-b640fad3-0625-407c-9b91-516bf6fc59c2"><script>var element = document.getElementById("moose-equation-b640fad3-0625-407c-9b91-516bf6fc59c2");katex.render("Ra = 5000", element, {displayMode:false,throwOnError:false});</script></span>. Lateral model dimensions are chosen so that approximately twenty fingers in the lateral directions are present at the onset of convection. An example of the evolution of the convective fingers in this model are presented in <a class="tooltipped" href="#fig:3Da" data-tooltip="#fig:3Da" data-position="top">Figure 3</a> and <a class="tooltipped" href="#fig:3Db" data-tooltip="#fig:3Db" data-position="top">Figure 4</a> for an isotropic model. The concentration profile just after the onset of convection is shown in <a class="tooltipped" href="#fig:3Da" data-tooltip="#fig:3Da" data-position="top">Figure 3</a> for a dimensionless time <span class="moose-katex-inline-equation" id="moose-equation-3be87ea8-91cc-4014-b638-1136e30bf6a3"><script>var element = document.getElementById("moose-equation-3be87ea8-91cc-4014-b638-1136e30bf6a3");katex.render("t = 1400", element, {displayMode:false,throwOnError:false});</script></span>. As the isosurface shows, there are a large number of small fingers at this stage. As time increases, these small structures merge, forming larger fingers in a process that continues as time proceeds, until only a few large fingers are present, see <a class="tooltipped" href="#fig:3Db" data-tooltip="#fig:3Db" data-position="top">Figure 4</a>. This merging behaviour is very complicated and difficult to characterise in any quantitative manner</p><div style="width:80%;margin-left:10px" id="fig:3Da" class="card"><div class="card-image"><img src="media/3Da.png" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-heading">Figure 3: </span><span class="moose-caption-text">Evolution of convective mixing in 3D. Time is dimensionless.</span></p></div></div><div style="width:80%;margin-left:10px" id="fig:3Db" class="card"><div class="card-image"><img src="media/3Db.png" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-heading">Figure 4: </span><span class="moose-caption-text">Evolution of convective mixing in 3D (continued). Time is dimensionless.</span></p></div></div><p>Many interesting observations can be made from large-scale 3D models. For example, the temporal evolution of the fingers shown in <a class="tooltipped" href="#fig:3Da" data-tooltip="#fig:3Da" data-position="top">Figure 3</a> and <a class="tooltipped" href="#fig:3Db" data-tooltip="#fig:3Db" data-position="top">Figure 4</a> can also be examined through a horizontal slice through the model, see <a class="tooltipped" href="#fig:slices" data-tooltip="#fig:slices" data-position="top">Figure 5</a>. In this example, a horizontal slice is taken at a dimensionless distance of 100 from the top surface (where the CO<span class="moose-katex-inline-equation" id="moose-equation-8058f1ef-1cdc-4239-912f-bded0f792dd9"><script>var element = document.getElementById("moose-equation-8058f1ef-1cdc-4239-912f-bded0f792dd9");katex.render("_2", element, {displayMode:false,throwOnError:false});</script></span> concentration is 1). As the fingers approach this depth, they are initially observed as circular regions of higher concentration, cf <a class="tooltipped" href="#fig:slices" data-tooltip="#fig:slices" data-position="top">Figure 5</a> (a) and (b), where we can see that the fingers have just reached this depth at dimensionless time 1000. As time increases, the complexity of the fingering process can be observed, with merging of adjacent fingers and growth observed. Like <a href="#pau2010">Pau et al. (2010)</a> and <a href="#fu2013">Fu et al. (2013)</a>, we observe that the fingers arrange themselves into polygonal structures with thin profiles surrounded by large regions of unsaturated fluid, see <a class="tooltipped" href="#fig:slices" data-tooltip="#fig:slices" data-position="top">Figure 5</a> (d), (e) and (f).</p><div style="width:90%;margin-left:10px" id="fig:slices" class="card"><div class="card-image"><img src="media/slices.png" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-heading">Figure 5: </span><span class="moose-caption-text">Horizontal slice at dimensionless depth 10 showing the evolution of the convective fingers in 3D. Time increasing from (a) to (f).</span></p></div></div></section></section><section class="section scrollspy" data-section-text="References" data-section-level="2" id="fb56f4d7-d559-4fff-803f-a2ce8f4964bb"><h2>References</h2><ol class="moose-bibliogrpahy"><li id="fu2013">Xiaojing Fu, Luis Cueto-Felgueroso, and Ruben Juanes.
Pattern formation and coarsening dynamics in three-dimensional convective mixing in porous media.
<em>Phil. Trans. R. Soc. A</em>, 371:20120355, 2013.<a style="padding-left:10px;" href="#4a0f40d3-027f-453a-bfa5-c658a8555ec1" class="modal-trigger moose-bibtex-modal">[BibTeX]</a><div id="4a0f40d3-027f-453a-bfa5-c658a8555ec1" class="modal"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{fu2013,
    author = "Fu, Xiaojing and Cueto-Felgueroso, Luis and Juanes, Ruben",
    title = "Pattern formation and coarsening dynamics in three-dimensional convective mixing in porous media",
    journal = "Phil. Trans. R. Soc. A",
    volume = "371",
    pages = "20120355",
    year = "2013"
}
</code></pre></div></div></li><li id="pau2010">George&nbsp;SH Pau, John&nbsp;B Bell, Karsten Pruess, Ann&nbsp;S Almgren, Michael&nbsp;J Lijewski, and Keni Zhang.
<span class="bibtex-protected">High-resolution simulation and characterization of density-driven flow in CO$_2$ storage in saline aquifers</span>.
<em>Advances in Water Resources</em>, 33:443–455, 2010.<a style="padding-left:10px;" href="#2def3f3a-29c6-41a7-841e-c6691f06f675" class="modal-trigger moose-bibtex-modal">[BibTeX]</a><div id="2def3f3a-29c6-41a7-841e-c6691f06f675" class="modal"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{pau2010,
    author = "Pau, George SH and Bell, John B and Pruess, Karsten and Almgren, Ann S and Lijewski, Michael J and Zhang, Keni",
    title = "{High-resolution simulation and characterization of density-driven flow in CO$\_2$ storage in saline aquifers}",
    journal = "Advances in Water Resources",
    volume = "33",
    pages = "443--455",
    year = "2010"
}
</code></pre></div></div></li></ol></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a data-delay="1000" data-position="left" href="#9443e100-0694-4f1e-9492-678a6d0b932f" class="tooltipped" data-tooltip="Isotropic   models">Isotropic   models</a></li><li><a data-delay="1000" data-position="left" href="#fb56f4d7-d559-4fff-803f-a2ce8f4964bb" class="tooltipped" data-tooltip="References">References</a></li></ul></div></div></div></div></main></div><div id="4c96a92e-6607-4e92-923d-9fdb411b11d2" class="modal bottom-sheet"><div class="modal-content"><h4>/Users/gre462/Documents/MOOSE/projects/numbat/examples/3D/isotropic/3Dddc.i</h4><pre><code class="language-text"># 3D density-driven convective mixing. Instability is seeded by small perturbation
# to porosity. Don't try this on a laptop!

[Mesh]
  type = NumbatBiasedMesh
  dim = 3
  zmax = 1.5
  nx = 20
  ny = 20
  nz = 500
  refined_edge = front
  refined_resolution = 0.001
[]

[Variables]
  [./concentration]
    initial_condition = 0
    scaling = 1e6
  [../]
  [./pressure]
    initial_condition = 1e6
  [../]
[]

[AuxVariables]
  [./noise]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[ICs]
  [./noise]
    type = RandomIC
    variable = noise
    max = 0.003
    min = -0.003
  [../]
[]

[Materials]
  [./porosity]
    type = NumbatPorosity
    porosity = 0.3
    noise = noise
  [../]
  [./permeability]
    type = NumbatPermeability
    permeability = '1e-11 0 0 0 1e-11 0 0 0 1e-11'
  [../]
  [./diffusivity]
    type = NumbatDiffusivity
    diffusivity = 2e-9
  [../]
  [./density]
    type = NumbatDensity
    concentration = concentration
    zero_density = 995
    delta_density = 10.5
    saturated_concentration = 0.049306
  [../]
  [./viscosity]
    type = NumbatViscosity
    viscosity = 6e-4
  [../]
[]

[Kernels]
  [./time]
    type = NumbatTimeDerivative
    variable = concentration
  [../]
  [./diffusion]
    type = NumbatDiffusion
    variable = concentration
  [../]
  [./convection]
    type = NumbatConvection
    variable = concentration
    pressure = pressure
  [../]
  [./darcy]
    type = NumbatDarcy
    variable = pressure
    concentration = concentration
  [../]
[]

[BCs]
  [./conctop]
    type = PresetBC
    variable = concentration
    boundary = front
    value = 0.049306
  [../]
  [./Periodic]
    [./x]
      variable = concentration
      auto_direction = 'x y'
    [../]
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  l_max_its = 200
  end_time = 3e5
  solve_type = NEWTON
  petsc_options = -ksp_snes_ew
  petsc_options_iname = '-pc_type -sub_pc_type -ksp_atol'
  petsc_options_value = 'bjacobi ilu 1e-12'
  nl_abs_tol = 1e-10
  nl_max_its = 25
  dtmax = 2e3
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1
  [../]
[]

[Postprocessors]
  [./boundaryfluxint]
    type = NumbatSideFlux
    variable = concentration
    boundary = top
  [../]
  [./mass]
    type = NumbatTotalMass
    variable = concentration
  [../]
[]

[Outputs]
  [./console]
    type = Console
    perf_log = true
    output_nonlinear = true
  [../]
  [./exodus]
    type = Exodus
    file_base = 3Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./csvoutput]
    type = CSV
    file_base = 3Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]
</code></pre></div></div></body></html>